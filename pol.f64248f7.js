(function () {function Hj(a){return a&&a.__esModule?{d:a.default}:{d:a}}var eg={};var fg={};var _d={};function fa(e,t,n,$,r){if($&&$!==e&&(n=n.bind($)),r){var i=n;n=function(){e.removeEventListener(t,n),i.apply(this,arguments)}}var s={target:e,type:t,listener:n};return e.addEventListener(t,n),s}function Qc(e,t,n,$){return fa(e,t,n,$,!0)}function ra(e){e&&e.target&&(e.target.removeEventListener(e.type,e.listener),Sb(e))}var ha="function"==typeof Object.assign?Object.assign:function(e,r){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1,o=arguments.length;n<o;++n){var $=arguments[n];if(null!=$)for(var s in $)$.hasOwnProperty(s)&&(t[s]=$[s])}return t};function Sb(e){for(var r in e)delete e[r]}var gg="function"==typeof Object.values?Object.values:function(e){var r=[];for(var t in e)r.push(e[t]);return r};function be(e){var r;for(r in e)return!1;return!r}var ca={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};var od={};function ma(){return function(){throw new Error("Unimplemented abstract method.")}()}var Hn=0;function da(t){return t.ol_uid||(t.ol_uid=String(++Hn))}var hg="6.3.1";var Tb={PROPERTYCHANGE:"propertychange"};var ce={};var ig={};var fe=function(){function t(){this.disposed_=!1}return t.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},t.prototype.disposeInternal=function(){},t}();function Xa(){return!0}function oc(){return!1}function tb(){}function In($){var r,e,t,o=!1;return function(){var p=Array.prototype.slice.call(arguments);return o&&this===t&&Vb(p,e)||(o=!0,t=this,e=p,r=$.apply(this,arguments)),r}}function Jn(r,e,n){for(var t,$,u=n||Ub,o=0,l=r.length,i=!1;o<l;)($=+u(r[t=o+(l-o>>1)],e))<0?o=t+1:(l=t,i=!$);return i?o:~o}function Ub(r,e){return r>e?1:r<e?-1:0}function pc(r,e){return r.indexOf(e)>=0}function pd(r,e,n){var t=r.length;if(r[0]<=e)return 0;if(e<=r[t-1])return t-1;var $=void 0;if(n>0){for($=1;$<t;++$)if(r[$]<e)return $-1}else if(n<0){for($=1;$<t;++$)if(r[$]<=e)return $}else for($=1;$<t;++$){if(r[$]==e)return $;if(r[$]<e)return r[$-1]-e<e-r[$]?$-1:$}return t-1}function Kn(r,e,n){for(;e<n;){var t=r[e];r[e]=r[n],r[n]=t,++e,--n}}function bb(r,e){for(var n=Array.isArray(e)?e:[e],t=n.length,$=0;$<t;$++)r[r.length]=n[$]}function qd(r,e){for(var n,t=r.length>>>0,$=0;$<t;$++)if(e(n=r[$],$,r))return n;return null}function Vb(r,e){var n=r.length;if(n!==e.length)return!1;for(var t=0;t<n;t++)if(r[t]!==e[t])return!1;return!0}function jg(r,e){var n;return!r.every(function(t,$){return n=$,!e(t,$,r)})?n:-1}function Ln(r,e,n){var t=e||Ub;return r.every(function(e,$){if(0===$)return!0;var u=t(r[$-1],e);return!(u>0||n&&0===u)})}var Ka=function(){function t(t){this.propagationStopped,this.type=t,this.target=null}return t.prototype.preventDefault=function(){this.propagationStopped=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t}();function Mn(t){t.stopPropagation()}var Nn=ig&&ig.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),qc=function(t){function e(e){var n=t.call(this)||this;return n.eventTarget_=e,n.pendingRemovals_={},n.dispatching_={},n.listeners_={},n}return Nn(e,t),e.prototype.addEventListener=function(t,e){if(t&&e){var n=this.listeners_[t];n||(n=[],this.listeners_[t]=n),-1===n.indexOf(e)&&n.push(e)}},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new Ka(t):t,n=e.type;e.target||(e.target=this.eventTarget_||this);var i,r=this.listeners_[n];if(r){n in this.dispatching_||(this.dispatching_[n]=0,this.pendingRemovals_[n]=0),++this.dispatching_[n];for(var s=0,o=r.length;s<o;++s)if(!1===(i="handleEvent"in r[s]?r[s].handleEvent(e):r[s].call(this,e))||e.propagationStopped){i=!1;break}if(--this.dispatching_[n],0===this.dispatching_[n]){var p=this.pendingRemovals_[n];for(delete this.pendingRemovals_[n];p--;)this.removeEventListener(n,tb);delete this.dispatching_[n]}return i}},e.prototype.disposeInternal=function(){Sb(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var n=this.listeners_[t];if(n){var i=n.indexOf(e);-1!==i&&(t in this.pendingRemovals_?(n[i]=tb,++this.pendingRemovals_[t]):(n.splice(i,1),0===n.length&&delete this.listeners_[t]))}},e}(fe);ig.default=qc;var On=ce&&ce.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),kg=function(t){function e(){var e=t.call(this)||this;return e.revision_=0,e}return On(e,t),e.prototype.changed=function(){++this.revision_,this.dispatchEvent(ca.CHANGE)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var r=t.length,n=new Array(r),o=0;o<r;++o)n[o]=fa(this,t[o],e);return n}return fa(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var r=t.length,n=new Array(r),o=0;o<r;++o)n[o]=Qc(this,t[o],e);return n}return Qc(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var r=0,n=t.length;r<n;++r)this.removeEventListener(t[r],e);else this.removeEventListener(t,e)},e}(qc);function Pn(t){if(Array.isArray(t))for(var e=0,r=t.length;e<r;++e)ra(t[e]);else ra(t)}ce.unByKey=Pn,ce.default=kg;var Ij=od&&od.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function h(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(h.prototype=r.prototype,new h)}}(),lg=function(e){function t(t,r,h){var n=e.call(this,t)||this;return n.key=r,n.oldValue=h,n}return Ij(t,e),t}(Ka);od.ObjectEvent=lg;var Ta=function(e){function t(t){var r=e.call(this)||this;return da(r),r.values_={},void 0!==t&&r.setProperties(t),r}return Ij(t,e),t.prototype.get=function(e){var t;return this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t},t.prototype.getKeys=function(){return Object.keys(this.values_)},t.prototype.getProperties=function(){return ha({},this.values_)},t.prototype.notify=function(e,t){var r;r=xa(e),this.dispatchEvent(new lg(r,e,t)),r=Tb.PROPERTYCHANGE,this.dispatchEvent(new lg(r,e,t))},t.prototype.set=function(e,t,r){if(r)this.values_[e]=t;else{var h=this.values_[e];this.values_[e]=t,h!==t&&this.notify(e,h)}},t.prototype.setProperties=function(e,t){for(var r in e)this.set(r,e[r],t)},t.prototype.unset=function(e,t){if(e in this.values_){var r=this.values_[e];delete this.values_[e],t||this.notify(e,r)}},t}(kg),mg={};function xa(e){return mg.hasOwnProperty(e)?mg[e]:mg[e]="change:"+e}od.getChangeEventType=xa,od.default=Ta;var ng={};var sa={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source"};function ja(r,e,t){return Math.min(Math.max(r,e),t)}var Qn="cosh"in Math?Math.cosh:function(r){var e=Math.exp(r);return(e+1/e)/2};function Jj(r,e,t,$,o,a){var n=o-t,s=a-$;if(0!==n||0!==s){var p=((r-t)*n+(e-$)*s)/(n*n+s*s);p>1?(t=o,$=a):p>0&&(t+=n*p,$+=s*p)}return rc(r,e,t,$)}function rc(r,e,t,$){var o=t-r,a=$-e;return o*o+a*a}function Rn(r){for(var e=r.length,t=0;t<e;t++){for(var $=t,o=Math.abs(r[t][t]),a=t+1;a<e;a++){var n=Math.abs(r[a][t]);n>o&&(o=n,$=a)}if(0===o)return null;var s=r[$];r[$]=r[t],r[t]=s;for(var p=t+1;p<e;p++)for(var x=-r[p][t]/r[t][t],u=t;u<e+1;u++)t==u?r[p][u]=0:r[p][u]+=x*r[t][u]}for(var B=new Array(e),G=e-1;G>=0;G--){B[G]=r[G][e]/r[G][G];for(var i=G-1;i>=0;i--)r[i][e]-=r[i][G]*B[G]}return B}function Kj(r){return 180*r/Math.PI}function ub(r){return r*Math.PI/180}function cb(r,e){var t=r%e;return t*e<0?t+e:t}function Rc(r,e,t){return r+t*(e-r)}function ea(r,$){if(!r)throw new pg($)}var og={};var Sn=og&&og.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),pg=function(t){function r(r){var e=this,o="Assertion failed. See https://openlayers.org/en/"+("latest"===hg?hg:"v"+hg.split("-")[0])+"/doc/errors/#"+r+" for details.";return(e=t.call(this,o)||this).code=r,e.name="AssertionError",e.message=o,e}return Sn(r,t),r}(Error);og.default=pg;var Tn=ng&&ng.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),qg=function(t){function e(e){var r=t.call(this)||this,o=ha({},e);return o[sa.OPACITY]=void 0!==e.opacity?e.opacity:1,ea("number"==typeof o[sa.OPACITY],64),o[sa.VISIBLE]=void 0===e.visible||e.visible,o[sa.Z_INDEX]=e.zIndex,o[sa.MAX_RESOLUTION]=void 0!==e.maxResolution?e.maxResolution:1/0,o[sa.MIN_RESOLUTION]=void 0!==e.minResolution?e.minResolution:0,o[sa.MIN_ZOOM]=void 0!==e.minZoom?e.minZoom:-1/0,o[sa.MAX_ZOOM]=void 0!==e.maxZoom?e.maxZoom:1/0,r.className_=void 0!==o.className?e.className:"ol-layer",delete o.className,r.setProperties(o),r.state_=null,r}return Tn(e,t),e.prototype.getClassName=function(){return this.className_},e.prototype.getLayerState=function(t){var e=this.state_||{layer:this,managed:void 0===t||t},r=this.getZIndex();return e.opacity=ja(Math.round(100*this.getOpacity())/100,0,1),e.sourceState=this.getSourceState(),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==r?r:!1===e.managed?1/0:0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e},e.prototype.getLayersArray=function(t){return ma()},e.prototype.getLayerStatesArray=function(t){return ma()},e.prototype.getExtent=function(){return this.get(sa.EXTENT)},e.prototype.getMaxResolution=function(){return this.get(sa.MAX_RESOLUTION)},e.prototype.getMinResolution=function(){return this.get(sa.MIN_RESOLUTION)},e.prototype.getMinZoom=function(){return this.get(sa.MIN_ZOOM)},e.prototype.getMaxZoom=function(){return this.get(sa.MAX_ZOOM)},e.prototype.getOpacity=function(){return this.get(sa.OPACITY)},e.prototype.getSourceState=function(){return ma()},e.prototype.getVisible=function(){return this.get(sa.VISIBLE)},e.prototype.getZIndex=function(){return this.get(sa.Z_INDEX)},e.prototype.setExtent=function(t){this.set(sa.EXTENT,t)},e.prototype.setMaxResolution=function(t){this.set(sa.MAX_RESOLUTION,t)},e.prototype.setMinResolution=function(t){this.set(sa.MIN_RESOLUTION,t)},e.prototype.setMaxZoom=function(t){this.set(sa.MAX_ZOOM,t)},e.prototype.setMinZoom=function(t){this.set(sa.MIN_ZOOM,t)},e.prototype.setOpacity=function(t){ea("number"==typeof t,64),this.set(sa.OPACITY,t)},e.prototype.setVisible=function(t){this.set(sa.VISIBLE,t)},e.prototype.setZIndex=function(t){this.set(sa.Z_INDEX,t)},e.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),t.prototype.disposeInternal.call(this)},e}(Ta);ng.default=qg;var Wb={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};var Aa={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"};var Un=_d&&_d.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ge=function(e){function r(r){var t=this,n=ha({},r);delete n.source,(t=e.call(this,n)||this).mapPrecomposeKey_=null,t.mapRenderKey_=null,t.sourceChangeKey_=null,t.renderer_=null,r.render&&(t.render=r.render),r.map&&t.setMap(r.map),t.addEventListener(xa(sa.SOURCE),t.handleSourcePropertyChange_);var o=r.source?r.source:null;return t.setSource(o),t}return Un(r,e),r.prototype.getLayersArray=function(e){var r=e||[];return r.push(this),r},r.prototype.getLayerStatesArray=function(e){var r=e||[];return r.push(this.getLayerState()),r},r.prototype.getSource=function(){return this.get(sa.SOURCE)||null},r.prototype.getSourceState=function(){var e=this.getSource();return e?e.getState():Aa.UNDEFINED},r.prototype.handleSourceChange_=function(){this.changed()},r.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(ra(this.sourceChangeKey_),this.sourceChangeKey_=null);var e=this.getSource();e&&(this.sourceChangeKey_=fa(e,ca.CHANGE,this.handleSourceChange_,this)),this.changed()},r.prototype.getFeatures=function(e){return this.renderer_.getFeatures(e)},r.prototype.render=function(e,r){var t=this.getRenderer();if(t.prepareFrame(e))return t.renderFrame(e,r)},r.prototype.setMap=function(e){this.mapPrecomposeKey_&&(ra(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(ra(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=fa(e,Wb.PRECOMPOSE,function(e){var r=e.frameState.layerStatesArray,t=this.getLayerState(!1);ea(!r.some(function(e){return e.layer===t.layer}),67),r.push(t)},this),this.mapRenderKey_=fa(this,ca.CHANGE,e.render,e),this.changed())},r.prototype.setSource=function(e){this.set(sa.SOURCE,e)},r.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},r.prototype.hasRenderer=function(){return!!this.renderer_},r.prototype.createRenderer=function(){return null},r.prototype.disposeInternal=function(){this.setSource(null),e.prototype.disposeInternal.call(this)},r}(qg);function rd(e,r){if(!e.visible)return!1;var t=r.resolution;if(t<e.minResolution||t>=e.maxResolution)return!1;var n=r.zoom;return n>e.minZoom&&n<=e.maxZoom}_d.inView=rd,_d.default=ge;var Xb={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};var Vn=fg&&fg.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t])})(e,t)};return function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),rg=function(r){function e(e){var t=this,o=e||{},n=ha({},o);return delete n.preload,delete n.useInterimTilesOnError,(t=r.call(this,n)||this).setPreload(void 0!==o.preload?o.preload:0),t.setUseInterimTilesOnError(void 0===o.useInterimTilesOnError||o.useInterimTilesOnError),t}return Vn(e,r),e.prototype.getPreload=function(){return this.get(Xb.PRELOAD)},e.prototype.setPreload=function(r){this.set(Xb.PRELOAD,r)},e.prototype.getUseInterimTilesOnError=function(){return this.get(Xb.USE_INTERIM_TILES_ON_ERROR)},e.prototype.setUseInterimTilesOnError=function(r){this.set(Xb.USE_INTERIM_TILES_ON_ERROR,r)},e}(ge);fg.default=rg;var sg={};function tg(t,r,o){var $;if(void 0!==r){for(var e=0,i=t.length;e<i;++e)r[e]=t[e];$=r}else $=t.slice();return $}function ug(t,r,o){if(void 0!==r&&t!==r){for(var $=0,e=t.length;$<e;++$)r[$]=t[$];t=r}return t}function Wn(t){no(t.getCode(),t),ue(t,t,tg)}function Xn(t){t.forEach(Wn)}function pa(t){return"string"==typeof t?mo(t):t||null}function vg(t,r,o,$){var e,i=(t=pa(t)).getPointResolutionFunc();if(i)e=i(r,o),$&&$!==t.getUnits()&&(n=t.getMetersPerUnit())&&(e=e*n/ob[$]);else if(t.getUnits()==Qa.DEGREES&&!$||$==Qa.DEGREES)e=r;else{var n,s=mb(t,pa("EPSG:4326")),a=[o[0]-r/2,o[1],o[0]+r/2,o[1],o[0],o[1]-r/2,o[0],o[1]+r/2];a=s(a,a,2),e=(xg(a.slice(0,2),a.slice(2,4))+xg(a.slice(4,6),a.slice(6,8)))/2,void 0!==(n=$?ob[$]:t.getMetersPerUnit())&&(e/=n)}return e}function Lj(t){Xn(t),t.forEach(function(r){t.forEach(function(t){r!==t&&ue(r,t,tg)})})}function Yn(t,r,o,$){t.forEach(function(t){r.forEach(function(r){ue(t,r,o),ue(r,t,$)})})}function Sc(t,r){return t?"string"==typeof t?pa(t):t:pa(r)}function je(t,r){return Tc(t,"EPSG:4326",void 0!==r?r:"EPSG:3857")}function lb(t,r){if(t===r)return!0;var o=t.getUnits()===r.getUnits();return t.getCode()===r.getCode()?o:mb(t,r)===tg&&o}function mb(t,r){var o=t.getCode(),$=r.getCode(),e=lo(o,$);return e||(e=ug),e}function Cb(t,r){return mb(pa(t),pa(r))}function Tc(t,r,o){return Cb(r,o)(t,void 0,t.length)}function wg(t,r,o,$){var e=Cb(r,o);return Xc(t,e,void 0,$)}var aa={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};var ke=6371008.8;function xg(e,t,r){var $=r||ke,a=ub(e[1]),o=ub(t[1]),n=(o-a)/2,E=ub(t[0]-e[0])/2,R=Math.sin(n)*Math.sin(n)+Math.sin(E)*Math.sin(E)*Math.cos(a)*Math.cos(o);return 2*$*Math.atan2(Math.sqrt(R),Math.sqrt(1-R))}function yg(e,t){for(var r=0,$=0,a=e.length;$<a-1;++$)r+=xg(e[$],e[$+1],t);return r}function Zn(e,t){var r=t||{},$=r.radius||ke,a=r.projection||"EPSG:3857",o=e.getType();o!==aa.GEOMETRY_COLLECTION&&(e=e.clone().transform(a,"EPSG:4326"));var n,E,R,p,s,i,q=0;switch(o){case aa.POINT:case aa.MULTI_POINT:break;case aa.LINE_STRING:case aa.LINEAR_RING:q=yg(n=e.getCoordinates(),$);break;case aa.MULTI_LINE_STRING:case aa.POLYGON:for(R=0,p=(n=e.getCoordinates()).length;R<p;++R)q+=yg(n[R],$);break;case aa.MULTI_POLYGON:for(R=0,p=(n=e.getCoordinates()).length;R<p;++R)for(s=0,i=(E=n[R]).length;s<i;++s)q+=yg(E[s],$);break;case aa.GEOMETRY_COLLECTION:var m=e.getGeometries();for(R=0,p=m.length;R<p;++R)q+=Zn(m[R],t);break;default:throw new Error("Unsupported geometry type: "+o);}return q}function me(e,t){for(var r=0,$=e.length,a=e[$-1][0],o=e[$-1][1],n=0;n<$;n++){var E=e[n][0],R=e[n][1];r+=ub(E-a)*(2+Math.sin(ub(o))+Math.sin(ub(R))),a=E,o=R}return r*t*t/2}function $n(e,t){var r=t||{},$=r.radius||ke,a=r.projection||"EPSG:3857",o=e.getType();o!==aa.GEOMETRY_COLLECTION&&(e=e.clone().transform(a,"EPSG:4326"));var n,E,R,p,s,i,q=0;switch(o){case aa.POINT:case aa.MULTI_POINT:case aa.LINE_STRING:case aa.MULTI_LINE_STRING:case aa.LINEAR_RING:break;case aa.POLYGON:for(n=e.getCoordinates(),q=Math.abs(me(n[0],$)),R=1,p=n.length;R<p;++R)q-=Math.abs(me(n[R],$));break;case aa.MULTI_POLYGON:for(R=0,p=(n=e.getCoordinates()).length;R<p;++R)for(E=n[R],q+=Math.abs(me(E[0],$)),s=1,i=E.length;s<i;++s)q-=Math.abs(me(E[s],$));break;case aa.GEOMETRY_COLLECTION:var m=e.getGeometries();for(R=0,p=m.length;R<p;++R)q+=$n(m[R],t);break;default:throw new Error("Unsupported geometry type: "+o);}return q}function _n(e,t,r,$){var a=$||ke,o=ub(e[1]),n=ub(e[0]),E=t/a,R=Math.asin(Math.sin(o)*Math.cos(E)+Math.cos(o)*Math.sin(E)*Math.cos(r)),p=n+Math.atan2(Math.sin(r)*Math.sin(E)*Math.cos(o),Math.cos(E)-Math.sin(o)*Math.sin(R));return[Kj(p),Kj(R)]}function Da(r){for(var t=Ha(),e=0,$=r.length;e<$;++e)Vc(t,r[e]);return t}function ao(r,t,e){return nb(Math.min.apply(null,r),Math.min.apply(null,t),Math.max.apply(null,r),Math.max.apply(null,t),e)}function db(r,t,e){return e?(e[0]=r[0]-t,e[1]=r[1]-t,e[2]=r[2]+t,e[3]=r[3]+t,e):[r[0]-t,r[1]-t,r[2]+t,r[3]+t]}function Mj(r,t){return t?(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t):r.slice()}function sc(r,t,e){var $,i;return($=t<r[0]?r[0]-t:r[2]<t?t-r[2]:0)*$+(i=e<r[1]?r[1]-e:r[3]<e?e-r[3]:0)*i}function tc(r,t){return zg(r,t[0],t[1])}function La(r,t){return r[0]<=t[0]&&t[2]<=r[2]&&r[1]<=t[1]&&t[3]<=r[3]}function zg(r,t,e){return r[0]<=t&&t<=r[2]&&r[1]<=e&&e<=r[3]}function Ag(r,t){var e=r[0],$=r[1],i=r[2],o=r[3],n=t[0],p=t[1],a=Ia.UNKNOWN;return n<e?a|=Ia.LEFT:n>i&&(a|=Ia.RIGHT),p<$?a|=Ia.BELOW:p>o&&(a|=Ia.ABOVE),a===Ia.UNKNOWN&&(a=Ia.INTERSECTING),a}function Ha(){return[1/0,1/0,-1/0,-1/0]}function nb(r,t,e,$,i){return i?(i[0]=r,i[1]=t,i[2]=e,i[3]=$,i):[r,t,e,$]}function Uc(r){return nb(1/0,1/0,-1/0,-1/0,r)}function sd(r,t){var e=r[0],$=r[1];return nb(e,$,e,$,t)}function bo(r,t){return eo(Uc(t),r)}function Nj(r,t,e,$,i){return Oj(Uc(i),r,t,e,$)}function eb(r,t){return r[0]==t[0]&&r[2]==t[2]&&r[1]==t[1]&&r[3]==t[3]}function co(r,t,e){return Math.abs(r[0]-t[0])<e&&Math.abs(r[2]-t[2])<e&&Math.abs(r[1]-t[1])<e&&Math.abs(r[3]-t[3])<e}function Bg(r,t){return t[0]<r[0]&&(r[0]=t[0]),t[2]>r[2]&&(r[2]=t[2]),t[1]<r[1]&&(r[1]=t[1]),t[3]>r[3]&&(r[3]=t[3]),r}function Vc(r,t){t[0]<r[0]&&(r[0]=t[0]),t[0]>r[2]&&(r[2]=t[0]),t[1]<r[1]&&(r[1]=t[1]),t[1]>r[3]&&(r[3]=t[1])}function eo(r,t){for(var e=0,$=t.length;e<$;++e)Vc(r,t[e]);return r}function Oj(r,t,e,$,i){for(;e<$;e+=i)fo(r,t[e],t[e+1]);return r}function fo(r,t,e){r[0]=Math.min(r[0],t),r[1]=Math.min(r[1],e),r[2]=Math.max(r[2],t),r[3]=Math.max(r[3],e)}function Pj(r,t){var e;return(e=t(Yb(r)))?e:(e=t(uc(r)))?e:(e=t(vc(r)))?e:(e=t(fb(r)))||!1}function qe(r){var t=0;return wc(r)||(t=la(r)*va(r)),t}function Yb(r){return[r[0],r[1]]}function uc(r){return[r[2],r[1]]}function Ma(r){return[(r[0]+r[2])/2,(r[1]+r[3])/2]}function go(r,t){var e;return t===ud.BOTTOM_LEFT?e=Yb(r):t===ud.BOTTOM_RIGHT?e=uc(r):t===ud.TOP_LEFT?e=fb(r):t===ud.TOP_RIGHT?e=vc(r):ea(!1,13),e}function Wc(r,t,e,$,i){var o=t*$[0]/2,n=t*$[1]/2,p=Math.cos(e),a=Math.sin(e),x=o*p,D=o*a,Q=n*p,s=n*a,c=r[0],u=r[1],d=c-x+s,g=c-x-s,m=c+x-s,f=c+x+s,h=u-D-Q,l=u-D+Q,E=u+D+Q,R=u+D-Q;return nb(Math.min(d,g,m,f),Math.min(h,l,E,R),Math.max(d,g,m,f),Math.max(h,l,E,R),i)}function va(r){return r[3]-r[1]}function vb(r,t,e){var $=e||Ha();return ya(r,t)?(r[0]>t[0]?$[0]=r[0]:$[0]=t[0],r[1]>t[1]?$[1]=r[1]:$[1]=t[1],r[2]<t[2]?$[2]=r[2]:$[2]=t[2],r[3]<t[3]?$[3]=r[3]:$[3]=t[3]):Uc($),$}function fb(r){return[r[0],r[3]]}function vc(r){return[r[2],r[3]]}function la(r){return r[2]-r[0]}function ya(r,t){return r[0]<=t[2]&&r[2]>=t[0]&&r[1]<=t[3]&&r[3]>=t[1]}function wc(r){return r[2]<r[0]||r[3]<r[1]}function ho(r,t){return t?(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t):r}function td(r,t){var e=(r[2]-r[0])/2*(t-1),$=(r[3]-r[1])/2*(t-1);r[0]-=e,r[2]+=e,r[1]-=$,r[3]+=$}function io(r,t,e){var $=!1,i=Ag(r,t),o=Ag(r,e);if(i===Ia.INTERSECTING||o===Ia.INTERSECTING)$=!0;else{var n=r[0],p=r[1],a=r[2],x=r[3],D=t[0],Q=t[1],s=e[0],c=e[1],u=(c-Q)/(s-D),d=void 0,g=void 0;o&Ia.ABOVE&&!(i&Ia.ABOVE)&&($=(d=s-(c-x)/u)>=n&&d<=a),$||!(o&Ia.RIGHT)||i&Ia.RIGHT||($=(g=c-(s-a)*u)>=p&&g<=x),$||!(o&Ia.BELOW)||i&Ia.BELOW||($=(d=s-(c-p)/u)>=n&&d<=a),$||!(o&Ia.LEFT)||i&Ia.LEFT||($=(g=c-(s-n)*u)>=p&&g<=x)}return $}function Xc(r,t,e,$){var i=[];if($>1)for(var o=r[2]-r[0],n=r[3]-r[1],p=0;p<$;++p)i.push(r[0]+o*p/$,r[1],r[2],r[1]+n*p/$,r[2]-o*p/$,r[3],r[0],r[3]-n*p/$);else i=[r[0],r[1],r[2],r[1],r[2],r[3],r[0],r[3]];t(i,i,2);for(var a=[],x=[],D=(p=0,i.length);p<D;p+=2)a.push(i[p]),x.push(i[p+1]);return ao(a,x,e)}function Qj(r,t){var e=t.getExtent(),$=Ma(r);if(t.canWrapX()&&($[0]<e[0]||$[0]>=e[2])){var i=la(e),o=Math.floor(($[0]-e[0])/i)*i;r[0]-=o,r[2]-=o}return r}var ud={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};var Ia={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};var Db={};var a=arguments[0];var Qa={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},ob={};ob[Qa.DEGREES]=2*Math.PI*6370997/360,ob[Qa.FEET]=.3048,ob[Qa.METERS]=1,ob[Qa.USFEET]=1200/3937;var Rj=function(){function t(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}return t.prototype.canWrapX=function(){return this.canWrapX_},t.prototype.getCode=function(){return this.code_},t.prototype.getExtent=function(){return this.extent_},t.prototype.getUnits=function(){return this.units_},t.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||ob[this.units_]},t.prototype.getWorldExtent=function(){return this.worldExtent_},t.prototype.getAxisOrientation=function(){return this.axisOrientation_},t.prototype.isGlobal=function(){return this.global_},t.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},t.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},t.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},t.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},t.prototype.setWorldExtent=function(t){this.worldExtent_=t},t.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},t.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},t}();var jo=Db&&Db.__extends||function(){var o=function($,r){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,$){o.__proto__=$}||function(o,$){for(var r in $)$.hasOwnProperty(r)&&(o[r]=$[r])})($,r)};return function($,r){function t(){this.constructor=$}o($,r),$.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}(),vd=6378137;Db.RADIUS=vd;var xc=Math.PI*vd;Db.HALF_SIZE=xc;var Sj=[-xc,-xc,xc,xc];Db.EXTENT=Sj;var Tj=[-180,-85,180,85];Db.WORLD_EXTENT=Tj;var yc=function(o){function $($){return o.call(this,{code:$,units:Qa.METERS,extent:Sj,global:!0,worldExtent:Tj,getPointResolution:function(o,$){return o/Qn($[1]/vd)}})||this}return jo($,o),$}(Rj),Cg=[new yc("EPSG:3857"),new yc("EPSG:102100"),new yc("EPSG:102113"),new yc("EPSG:900913"),new yc("urn:ogc:def:crs:EPSG:6.18:3:3857"),new yc("urn:ogc:def:crs:EPSG::3857"),new yc("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Uj(o,$,r){var t=o.length,e=r>1?r:2,s=$;void 0===s&&(s=e>2?o.slice():new Array(t));for(var n=xc,l=0;l<t;l+=e){s[l]=n*o[l]/180;var h=vd*Math.log(Math.tan(Math.PI*(+o[l+1]+90)/360));h>n?h=n:h<-n&&(h=-n),s[l+1]=h}return s}function Vj(o,$,r){var t=o.length,e=r>1?r:2,s=$;void 0===s&&(s=e>2?o.slice():new Array(t));for(var n=0;n<t;n+=e)s[n]=180*o[n]/xc,s[n+1]=360*Math.atan(Math.exp(o[n+1]/vd))/Math.PI-90;return s}Db.PROJECTIONS=Cg,Db.fromEPSG4326=Uj,Db.toEPSG4326=Vj;var Yc={};var ko=Yc&&Yc.__extends||function(){var n=function(r,$){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var $ in r)r.hasOwnProperty($)&&(n[$]=r[$])})(r,$)};return function(r,$){function e(){this.constructor=r}n(r,$),r.prototype=null===$?Object.create($):(e.prototype=$.prototype,new e)}}(),Wj=6378137;Yc.RADIUS=Wj;var Dg=[-180,-90,180,90];Yc.EXTENT=Dg;var Xj=Math.PI*Wj/180;Yc.METERS_PER_UNIT=Xj;var Zb=function(n){function r(r,$){return n.call(this,{code:r,units:Qa.DEGREES,extent:Dg,axisOrientation:$,global:!0,metersPerUnit:Xj,worldExtent:Dg})||this}return ko(r,n),r}(Rj),Eg=[new Zb("CRS:84"),new Zb("EPSG:4326","neu"),new Zb("urn:ogc:def:crs:EPSG::4326","neu"),new Zb("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new Zb("urn:ogc:def:crs:OGC:1.3:CRS84"),new Zb("urn:ogc:def:crs:OGC:2:84"),new Zb("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Zb("urn:x-ogc:def:crs:EPSG:4326","neu")];Yc.PROJECTIONS=Eg;var Zc={};function ue($,r,e){var t=$.getCode(),o=r.getCode();t in Zc||(Zc[t]={}),Zc[t][o]=e}function lo($,r){var e;return $ in Zc&&r in Zc[$]&&(e=Zc[$][r]),e}var Yj={};function mo($){return Yj[$]||null}function no($,t){Yj[$]=t}var Eb=null;function Ra(){return Eb}function Fb(t,r){return Eb?Tc(t,r,Eb):t}function oa(t,r){return Eb?Tc(t,Eb,r):t}function $c(t,r){return Eb?wg(t,r,Eb):t}function Ua(t,r){return Eb?wg(t,Eb,r):t}function oo(){Lj(Cg),Lj(Eg),Yn(Eg,Cg,Uj,Vj)}oo();var Fg=function(){function t(t,i,n,e){this.minX=t,this.maxX=i,this.minY=n,this.maxY=e}return t.prototype.contains=function(t){return this.containsXY(t[1],t[2])},t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},t.prototype.containsXY=function(t,i){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY},t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},t.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},t.prototype.getHeight=function(){return this.maxY-this.minY+1},t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},t.prototype.getWidth=function(){return this.maxX-this.minX+1},t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},t}();function Gg(t,i,n,e,m){return void 0!==m?(m.minX=t,m.maxX=i,m.minY=n,m.maxY=e,m):new Fg(t,i,n,e)}var ba={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};var Hg={};function Ea(e,o,r){var t=r&&r.length?r.shift():xe?new OffscreenCanvas(e||300,o||300):document.createElement("canvas");return e&&(t.width=e),o&&(t.height=o),t.getContext("2d")}function po(e){var o=e.offsetWidth,r=getComputedStyle(e);return o+=parseInt(r.marginLeft,10)+parseInt(r.marginRight,10)}function qo(e){var o=e.offsetHeight,r=getComputedStyle(e);return o+=parseInt(r.marginTop,10)+parseInt(r.marginBottom,10)}function _c(e,o){var r=o.parentNode;r&&r.replaceChild(e,o)}function ve(e){return e&&e.parentNode?e.parentNode.removeChild(e):null}function Zj(e){for(;e.lastChild;)e.removeChild(e.lastChild)}function ro(e,o){for(var r=e.childNodes,t=0;;++t){var n=r[t],$=o[t];if(!n&&!$)break;n!==$&&(n?$?e.insertBefore($,n):(e.removeChild(n),--t):e.appendChild($))}}var ad="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",so=-1!==ad.indexOf("firefox");var b=-1!==ad.indexOf("safari")&&-1==ad.indexOf("chrom");var to=-1!==ad.indexOf("webkit")&&-1==ad.indexOf("edge");var uo=-1!==ad.indexOf("macintosh");var we="undefined"!=typeof devicePixelRatio?devicePixelRatio:1;var xe="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope;var $j="undefined"!=typeof Image&&Image.prototype.decode;var _j=function(){var e=!1;try{var $=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("_",null,$),window.removeEventListener("_",null,$)}catch(r){}return e}();var Ig={};var vo=Ig&&Ig.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Jg=function(t){function e(e,r,n,o){var $=t.call(this,e)||this;return $.inversePixelTransform=r,$.frameState=n,$.context=o,$}return vo(e,t),e}(Ka);Ig.default=Jg;var ye="ol-hidden";var wo="ol-selectable";var wb="ol-unselectable";var xo="ol-unsupported";var zc="ol-control";var ze="ol-collapsed";var yo=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),ak=["style","variant","weight","size","lineHeight","family"],bk=function(e){var $=e.match(yo);if(!$)return null;for(var r={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},t=0,a=ak.length;t<a;++t){var o=$[t+1];void 0!==o&&(r[ak[t]]=o)}return r.families=r.family.split(/,\s?/),r};var Kg=new Array(6);function Fa(){return[1,0,0,1,0,0]}function wd(e){return xd(e,1,0,0,1,0,0)}function bd(e,$){var t=e[0],r=e[1],o=e[2],p=e[3],n=e[4],A=e[5],P=$[0],s=$[1],x=$[2],a=$[3],i=$[4],u=$[5];return e[0]=t*P+o*s,e[1]=r*P+p*s,e[2]=t*x+o*a,e[3]=r*x+p*a,e[4]=t*i+o*u+n,e[5]=r*i+p*u+A,e}function xd(e,$,t,r,o,p,n){return e[0]=$,e[1]=t,e[2]=r,e[3]=o,e[4]=p,e[5]=n,e}function zo(e,$){return e[0]=$[0],e[1]=$[1],e[2]=$[2],e[3]=$[3],e[4]=$[4],e[5]=$[5],e}function ta(e,$){var t=$[0],r=$[1];return $[0]=e[0]*t+e[2]*r+e[4],$[1]=e[1]*t+e[3]*r+e[5],$}function Ao(e,$){var t=Math.cos($),r=Math.sin($);return bd(e,xd(Kg,t,r,-r,t,0,0))}function Ae(e,$,t){return bd(e,xd(Kg,$,0,0,t,0,0))}function Bo(e,$,t){return xd(e,$,0,0,t,0,0)}function Co(e,$,t){return bd(e,xd(Kg,1,0,0,1,$,t))}function Ya(e,$,t,r,o,p,n,A){var P=Math.sin(p),s=Math.cos(p);return e[0]=r*s,e[1]=o*P,e[2]=-r*P,e[3]=o*s,e[4]=n*r*s-A*r*P+$,e[5]=n*o*P+A*o*s+t,e}function yd(e,$){var t=Do($);ea(0!==t,32);var r=$[0],o=$[1],p=$[2],n=$[3],A=$[4],P=$[5];return e[0]=n/t,e[1]=-o/t,e[2]=-p/t,e[3]=r/t,e[4]=(p*P-n*A)/t,e[5]=-(r*P-o*A)/t,e}function Do(e){return e[0]*e[3]-e[1]*e[2]}function Lg(e){return"matrix("+e.join(", ")+")"}var ck="10px sans-serif";var Gb="#000";var cd="round";var Be=[];var Ce=0;var dd="round";var zd=10;var Ad="#000";var Bd="center";var De="middle";var ed=[0,0,0,0];var Cd=1;var Hb=new Ta;var Eo=new qc;Eo.setSize=function(){console.warn("labelCache is deprecated.")};var Fo,Ee=null,Mg={};var Go=function(){var e,t,$=100,r="32px ",i=["monospace","serif"],a=i.length,o="wmytzilWMYTZIL@#/&?$%10\uF013";function n(e,$,n){for(var s=!0,A=0;A<a;++A){var x=i[A];if(t=Fe(e+" "+$+" "+r+x,o),n!=x){var p=Fe(e+" "+$+" "+r+n+","+x,o);s=s&&p!=t}}return!!s}function s(){for(var t=!0,r=Hb.getKeys(),i=0,a=r.length;i<a;++i){var o=r[i];Hb.get(o)<$&&(n.apply(this,o.split("\n"))?(Sb(Mg),Ee=null,Fo=void 0,Hb.set(o,$)):(Hb.set(o,Hb.get(o)+1,!0),t=!1))}t&&(clearInterval(e),e=void 0)}return function(t){var r=bk(t);if(r)for(var i=r.families,a=0,o=i.length;a<o;++a){var A=i[a],x=r.style+"\n"+r.weight+"\n"+A;void 0===Hb.get(x)&&(Hb.set(x,$,!0),n(r.style,r.weight,A)||(Hb.set(x,0,!0),void 0===e&&(e=setInterval(s,32))))}}}();var Ho=function(){var e,t=Mg;return function($){var r=t[$];if(null==r)if(xe){var i=bk($),a=dk($,"\u017Dg"),o=isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight);Mg[$]=o*(a.actualBoundingBoxAscent+a.actualBoundingBoxDescent)}else e||((e=document.createElement("div")).innerHTML="M",e.style.margin="0 !important",e.style.padding="0 !important",e.style.position="absolute !important",e.style.left="-99999px !important"),e.style.font=$,document.body.appendChild(e),r=e.offsetHeight,t[$]=r,document.body.removeChild(e);return r}}();function dk(e,t){return Ee||(Ee=Ea(1,1)),e!=Fo&&(Ee.font=e,Fo=Ee.font),Ee.measureText(t)}function Fe(e,t){return dk(e,t).width}function ek(e,t,$){if(t in $)return $[t];var r=Fe(e,t);return $[t]=r,r}function Io(e,t,$){for(var r=t.length,i=0,a=0;a<r;++a){var o=Fe(e,t[a]);i=Math.max(i,o),$.push(o)}return i}function fk(e,t,$,r){0!==t&&(e.translate($,r),e.rotate(t),e.translate(-$,-r))}function gk(e,t,$,r,i,a,o,n,s,A,x){e.save(),1!==$&&(e.globalAlpha*=$),t&&e.setTransform.apply(e,t),r.contextInstructions?(e.translate(s,A),e.scale(x,x),Jo(r,e)):e.drawImage(r,i,a,o,n,s,A,o*x,n*x),e.restore()}function Jo(e,t){for(var $=e.contextInstructions,r=0,i=$.length;r<i;r+=2)Array.isArray($[r+1])?t[$[r]].apply(t,$[r+1]):t[$[r]]=$[r+1]}var Ng=null;function hk(e){return xe?Lg(e):(Ng||(Ng=Ea(1,1).canvas),Ng.style.transform=Lg(e),Ng.style.transform)}var Og={};var ia={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};var Ko=Og&&Og.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Pg=function(t){function e(e){var r=t.call(this)||this;return r.boundHandleImageChange_=r.handleImageChange_.bind(r),r.layer_=e,r}return Ko(e,t),e.prototype.getFeatures=function(t){return ma()},e.prototype.prepareFrame=function(t){return ma()},e.prototype.renderFrame=function(t,e){return ma()},e.prototype.loadedTileCallback=function(t,e,r){t[e]||(t[e]={}),t[e][r.tileCoord.toString()]=r},e.prototype.createLoadedTileFinder=function(t,e,r){return function(o,a){var n=this.loadedTileCallback.bind(this,r,o);return t.forEachLoadedTile(e,o,a,n)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,e,r,o,a){},e.prototype.getDataAtPixel=function(t,e,r){return ma()},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){t.target.getState()===ia.LOADED&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var e=t.getState();return e!=ia.LOADED&&e!=ia.ERROR&&t.addEventListener(ca.CHANGE,this.boundHandleImageChange_),e==ia.IDLE&&(t.load(),e=t.getState()),e==ia.LOADED},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==Aa.READY&&t.changed()},e}(kg);Og.default=Pg;var Lo=Hg&&Hg.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),Ge=function(t){function r(r){var e=t.call(this,r)||this;return e.container=null,e.renderedResolution,e.tempTransform_=Fa(),e.pixelTransform=Fa(),e.inversePixelTransform=Fa(),e.context=null,e.containerReused=!1,e}return Lo(r,t),r.prototype.useContainer=function(t,r,e){var o,n,a=this.getLayer().getClassName();t&&""===t.style.opacity&&t.className===a&&($=t.firstElementChild)instanceof HTMLCanvasElement&&(n=$.getContext("2d"));if(n&&n.canvas.style.transform===r?(this.container=t,this.context=n,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(o=document.createElement("div")).className=a;var i=o.style;i.position="absolute",i.width="100%",i.height="100%";var $=(n=Ea()).canvas;o.appendChild($),(i=$.style).position="absolute",i.left="0",i.transformOrigin="top left",this.container=o,this.context=n}},r.prototype.clip=function(t,r,e){var o=r.pixelRatio,n=r.size[0]*o/2,a=r.size[1]*o/2,i=r.viewState.rotation,$=fb(e),p=vc(e),s=uc(e),f=Yb(e);ta(r.coordinateToPixelTransform,$),ta(r.coordinateToPixelTransform,p),ta(r.coordinateToPixelTransform,s),ta(r.coordinateToPixelTransform,f),t.save(),fk(t,-i,n,a),t.beginPath(),t.moveTo($[0]*o,$[1]*o),t.lineTo(p[0]*o,p[1]*o),t.lineTo(s[0]*o,s[1]*o),t.lineTo(f[0]*o,f[1]*o),t.clip(),fk(t,i,n,a)},r.prototype.clipUnrotated=function(t,r,e){var o=fb(e),n=vc(e),a=uc(e),i=Yb(e);ta(r.coordinateToPixelTransform,o),ta(r.coordinateToPixelTransform,n),ta(r.coordinateToPixelTransform,a),ta(r.coordinateToPixelTransform,i);var $=this.inversePixelTransform;ta($,o),ta($,n),ta($,a),ta($,i),t.save(),t.beginPath(),t.moveTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(i[0]),Math.round(i[1])),t.clip()},r.prototype.dispatchRenderEvent_=function(t,r,e){var o=this.getLayer();if(o.hasListener(t)){var n=new Jg(t,this.inversePixelTransform,e,r);o.dispatchEvent(n)}},r.prototype.preRender=function(t,r){this.dispatchRenderEvent_(Wb.PRERENDER,t,r)},r.prototype.postRender=function(t,r){this.dispatchRenderEvent_(Wb.POSTRENDER,t,r)},r.prototype.getRenderTransform=function(t,r,e,o,n,a,i){var $=n/2,p=a/2,s=o/r,f=-s,v=-t[0]+i,m=-t[1];return Ya(this.tempTransform_,$,p,s,f,-e,v,m)},r.prototype.getDataAtPixel=function(t,r,e){var o,n=ta(this.inversePixelTransform,t.slice()),a=this.context;try{o=a.getImageData(Math.round(n[0]),Math.round(n[1]),1,1).data}catch(i){return"SecurityError"===i.name?new Uint8Array:o}return 0===o[3]?null:o},r}(Pg);Hg.default=Ge;var Mo=sg&&sg.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Dd=function(e){function t(t){var r=e.call(this,t)||this;return r.extentChanged=!0,r.renderedExtent_=null,r.renderedPixelRatio,r.renderedProjection=null,r.renderedRevision,r.renderedTiles=[],r.newTiles_=!1,r.tmpExtent=Ha(),r.tmpTileRange_=new Fg(0,0,0,0),r}return Mo(t,e),t.prototype.isDrawableTile=function(e){var t=this.getLayer(),r=e.getState(),i=t.getUseInterimTilesOnError();return r==ba.LOADED||r==ba.EMPTY||r==ba.ERROR&&!i},t.prototype.getTile=function(e,t,r,i){var o=i.pixelRatio,n=i.viewState.projection,a=this.getLayer(),s=a.getSource().getTile(e,t,r,o,n);return s.getState()==ba.ERROR&&(a.getUseInterimTilesOnError()?a.getPreload()>0&&(this.newTiles_=!0):s.setState(ba.LOADED)),this.isDrawableTile(s)||(s=s.getInterimTile()),s},t.prototype.loadedTileCallback=function(t,r,i){return!!this.isDrawableTile(i)&&e.prototype.loadedTileCallback.call(this,t,r,i)},t.prototype.prepareFrame=function(e){return!!this.getLayer().getSource()},t.prototype.renderFrame=function(e,t){var r=e.layerStatesArray[e.layerIndex],i=e.viewState,o=i.projection,n=i.resolution,a=i.center,s=i.rotation,l=e.pixelRatio,h=this.getLayer(),p=h.getSource(),$=p.getRevision(),d=p.getTileGridForProjection(o),u=d.getZForResolution(n,p.zDirection),c=d.getResolution(u),m=e.extent,g=r.extent&&Ua(r.extent,o);g&&(m=vb(m,Ua(r.extent,o)));var T=p.getTilePixelRatio(l),f=Math.round(e.size[0]*T),v=Math.round(e.size[1]*T);if(s){var x=Math.round(Math.sqrt(f*f+v*v));f=x,v=x}var M=c*f/2/T,k=c*v/2/T,y=[a[0]-M,a[1]-k,a[0]+M,a[1]+k],R=d.getTileRangeForExtentAndZ(m,u),_={};_[u]={};var w=this.createLoadedTileFinder(p,o,_),E=this.tmpExtent,S=this.tmpTileRange_;this.newTiles_=!1;for(var C=R.minX;C<=R.maxX;++C)for(var j=R.minY;j<=R.maxY;++j){var P=this.getTile(u,C,j,e);if(this.isDrawableTile(P)){var b=da(this);if(P.getState()==ba.LOADED){_[u][P.tileCoord.toString()]=P;var I=P.inTransition(b);this.newTiles_||!I&&-1!==this.renderedTiles.indexOf(P)||(this.newTiles_=!0)}if(1===P.getAlpha(b,e.time))continue}var O=d.getTileCoordChildTileRange(P.tileCoord,S,E),q=!1;O&&(q=w(u+1,O)),q||d.forEachTileCoordParentTileRange(P.tileCoord,w,S,E)}var A=c/n;Ya(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/T,1/T,s,-f/2,-v/2);var L=hk(this.pixelTransform);this.useContainer(t,L,r.opacity);var U=this.context,D=U.canvas;yd(this.inversePixelTransform,this.pixelTransform),Ya(this.tempTransform_,f/2,v/2,A,A,0,-f/2,-v/2),D.width!=f||D.height!=v?(D.width=f,D.height=v):this.containerReused||U.clearRect(0,0,f,v),g&&this.clipUnrotated(U,e,g),this.preRender(U,e),this.renderedTiles.length=0;var F,z,Y,Z=Object.keys(_).map(Number);Z.sort(Ub),1!==r.opacity||this.containerReused&&!p.getOpaque(e.viewState.projection)?(F=[],z=[]):Z=Z.reverse();for(var K=Z.length-1;K>=0;--K){var X=Z[K],G=p.getTilePixelSize(X,l,o),Q=d.getResolution(X)/c,N=G[0]*Q*A,B=G[1]*Q*A,H=d.getTileCoordForCoordAndZ(fb(y),X),J=d.getTileCoordExtent(H),V=ta(this.tempTransform_,[T*(J[0]-y[0])/c,T*(y[3]-J[3])/c]),W=T*p.getGutterForProjection(o),ee=_[X];for(var te in ee){var re=(P=ee[te]).tileCoord,ie=V[0]-(H[1]-re[1])*N,oe=Math.round(ie+N),ne=V[1]-(H[2]-re[2])*B,ae=Math.round(ne+B),se=oe-(C=Math.round(ie)),le=ae-(j=Math.round(ne)),he=u===X;if(!(I=he&&1!==P.getAlpha(da(this),e.time)))if(F){U.save(),Y=[C,j,C+se,j,C+se,j+le,C,j+le];for(var pe=0,$e=F.length;pe<$e;++pe)if(u!==X&&X<z[pe]){var de=F[pe];U.beginPath(),U.moveTo(Y[0],Y[1]),U.lineTo(Y[2],Y[3]),U.lineTo(Y[4],Y[5]),U.lineTo(Y[6],Y[7]),U.moveTo(de[6],de[7]),U.lineTo(de[4],de[5]),U.lineTo(de[2],de[3]),U.lineTo(de[0],de[1]),U.clip()}F.push(Y),z.push(X)}else U.clearRect(C,j,se,le);this.drawTileImage(P,e,C,j,se,le,W,he,r.opacity),F&&!I&&U.restore(),this.renderedTiles.push(P),this.updateUsedTiles(e.usedTiles,p,P)}}return this.renderedRevision=$,this.renderedResolution=c,this.extentChanged=!this.renderedExtent_||!eb(this.renderedExtent_,y),this.renderedExtent_=y,this.renderedPixelRatio=l,this.renderedProjection=o,this.manageTilePyramid(e,p,d,l,o,m,u,h.getPreload()),this.scheduleExpireCache(e,p),this.postRender(U,e),r.extent&&U.restore(),L!==D.style.transform&&(D.style.transform=L),this.container},t.prototype.drawTileImage=function(e,t,r,i,o,n,a,s,l){var h=this.getTileImage(e);if(h){var p=da(this),$=s?e.getAlpha(p,t.time):1,d=l*$,u=d!==this.context.globalAlpha;u&&(this.context.save(),this.context.globalAlpha=d),this.context.drawImage(h,a,a,h.width-2*a,h.height-2*a,r,i,o,n),u&&this.context.restore(),1!==$?t.animate=!0:s&&e.endTransition(p)}},t.prototype.getImage=function(){var e=this.context;return e?e.canvas:null},t.prototype.getTileImage=function(e){return e.getImage()},t.prototype.scheduleExpireCache=function(e,t){if(t.canExpireCache()){var r=function(e,t,r){var i=da(e);i in r.usedTiles&&e.expireCache(r.viewState.projection,r.usedTiles[i])}.bind(null,t);e.postRenderFunctions.push(r)}},t.prototype.updateUsedTiles=function(e,t,r){var i=da(t);i in e||(e[i]={}),e[i][r.getKey()]=!0},t.prototype.manageTilePyramid=function(e,t,r,i,o,n,a,s,l){var h=da(t);h in e.wantedTiles||(e.wantedTiles[h]={});var p,$,d,u,c,m,g=e.wantedTiles[h],T=e.tileQueue;for(m=r.getMinZoom();m<=a;++m)for($=r.getTileRangeForExtentAndZ(n,m,$),d=r.getResolution(m),u=$.minX;u<=$.maxX;++u)for(c=$.minY;c<=$.maxY;++c)a-m<=s?((p=t.getTile(m,u,c,i,o)).getState()==ba.IDLE&&(g[p.getKey()]=!0,T.isKeyQueued(p.getKey())||T.enqueue([p,h,r.getTileCoordCenter(p.tileCoord),d])),void 0!==l&&l(p)):t.useTile(m,u,c,o)},t}(Ge);Dd.prototype.getLayer,sg.default=Dd;var No=eg&&eg.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ik=function(e){function r(r){return e.call(this,r)||this}return No(r,e),r.prototype.createRenderer=function(){return new Dd(this)},r}(rg);eg.default=ik;var Qg={};var Rg={};var He={};var Ba={ADD:"add",REMOVE:"remove"};var jk=He&&He.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),kk={LENGTH:"length"},Ed=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.element=r,o.index=n,o}return jk(e,t),e}(Ka);He.CollectionEvent=Ed;var Ja=function(t){function e(e,r){var n=t.call(this)||this,o=r||{};if(n.unique_=!!o.unique,n.array_=e||[],n.unique_)for(var i=0,a=n.array_.length;i<a;++i)n.assertUnique_(n.array_[i],i);return n.updateLength_(),n}return jk(e,t),e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,r=t.length;e<r;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,r=0,n=e.length;r<n;++r)t(e[r],r,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(kk.LENGTH)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Ed(Ba.ADD,e,t))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,r=0,n=e.length;r<n;++r)if(e[r]===t)return this.removeAt(r)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Ed(Ba.REMOVE,e,t)),e},e.prototype.setAt=function(t,e){var r=this.getLength();if(t<r){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Ed(Ba.REMOVE,n,t)),this.dispatchEvent(new Ed(Ba.ADD,e,t))}else{for(var o=r;o<t;++o)this.insertAt(o,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(kk.LENGTH,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var r=0,n=this.array_.length;r<n;++r)if(this.array_[r]===t&&r!==e)throw new pg(58)},e}(Ta);He.default=Ja;var Sg={};var Tg={};var Oo=Tg&&Tg.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Fd=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.map=r,o.frameState=void 0!==n?n:null,o}return Oo(e,t),e}(Ka);Tg.default=Fd;var Po=Sg&&Sg.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ug=function(t){function e(e,o,n,r,i){var p=t.call(this,e,o,i)||this;return p.originalEvent=n,p.pixel_=null,p.coordinate_=null,p.dragging=void 0!==r&&r,p}return Po(e,t),Object.defineProperty(e.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!0,configurable:!0}),e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},e}(Fd);Sg.default=Ug;var Vg={};var lk=null,mk=null;function Qo(){Element.prototype.setPointerCapture=Element.prototype.setCapture,Element.prototype.releasePointerCapture=Element.prototype.releaseCapture}function Wg(e,t,r){e.addEventListener(t,function(e){var n=new MouseEvent(r,e);n.pointerId=1,n.isPrimary=!0,n.pointerType="mouse",n.width=1,n.height=1,n.tiltX=0,n.tiltY=0,"buttons"in e&&0!==e.buttons?n.pressure=.5:n.pressure=0;var o=e.target;null!==mk&&(o=mk,"mouseup"===t&&(mk=null)),o.dispatchEvent(n),n.defaultPrevented&&e.preventDefault()})}function Xg(e,t,r){e.addEventListener(t,function(e){for(var n=e.changedTouches,o=n.length,i=0;i<o;i++){var a=new CustomEvent(r,{bubbles:!0,cancelable:!0});a.ctrlKey=e.ctrlKey,a.shiftKey=e.shiftKey,a.altKey=e.altKey,a.metaKey=e.metaKey;var u=n.item(i);a.clientX=u.clientX,a.clientY=u.clientY,a.screenX=u.screenX,a.screenY=u.screenY,a.pageX=u.pageX,a.pageY=u.pageY;var $=u.target.getBoundingClientRect();a.offsetX=u.clientX-$.left,a.offsetY=u.clientY-$.top,a.pointerId=1+u.identifier,a.button=0,a.buttons=1,a.movementX=0,a.movementY=0,a.region=null,a.relatedTarget=null,a.x=a.clientX,a.y=a.clientY,a.pointerType="touch",a.width=1,a.height=1,a.tiltX=0,a.tiltY=0,a.pressure=1,"touchstart"===t&&null===lk&&(lk=u.identifier),a.isPrimary=u.identifier===lk,"touchend"===t&&a.isPrimary&&(lk=null),e.target.dispatchEvent(a),a.defaultPrevented&&e.preventDefault()}})}"PointerEvent"in window||(Qo(),"TouchEvent"in window||(Wg(document,"mousedown","pointerdown"),Wg(document,"mousemove","pointermove"),Wg(document,"mouseup","pointerup")),Xg(document,"touchstart","pointerdown"),Xg(document,"touchmove","pointermove"),Xg(document,"touchend","pointerup"));var na={SINGLECLICK:"singleclick",CLICK:ca.CLICK,DBLCLICK:ca.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var Yg={};var Ro=Yg&&Yg.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),Ib=function(t){function r(r,e,o,n,$){var p=t.call(this,r,e,o,n,$)||this;return p.pointerEvent=o,p}return Ro(r,t),r}(Ug);Yg.default=Ib;var Jb={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var So=Vg&&Vg.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),nk=function(e){function t(t,o){var i=e.call(this,t)||this;i.map_=t,i.clickTimeoutId_,i.dragging_=!1,i.dragListenerKeys_=[],i.moveTolerance_=o?o*we:we,i.down_=null;var r=i.map_.getViewport();return i.activePointers_=0,i.trackedTouches_={},i.element_=r,i.pointerdownListenerKey_=fa(r,Jb.POINTERDOWN,i.handlePointerDown_,i),i.originalPointerMoveEvent_,i.relayedListenerKey_=fa(r,Jb.POINTERMOVE,i.relayEvent_,i),i.boundHandleTouchMove_=i.handleTouchMove_.bind(i),i.element_.addEventListener(ca.TOUCHMOVE,i.boundHandleTouchMove_,!!_j&&{passive:!1}),i}return So(t,e),t.prototype.emulateClick_=function(e){var t=new Ib(na.CLICK,this.map_,e);this.dispatchEvent(t),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Ib(na.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var t=new Ib(na.SINGLECLICK,this.map_,e);this.dispatchEvent(t)}.bind(this),250)},t.prototype.updateActivePointers_=function(e){var t=e;t.type==na.POINTERUP||t.type==na.POINTERCANCEL?delete this.trackedTouches_[t.pointerId]:t.type==na.POINTERDOWN&&(this.trackedTouches_[t.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},t.prototype.handlePointerUp_=function(e){this.updateActivePointers_(e);var t=new Ib(na.POINTERUP,this.map_,e);this.dispatchEvent(t),t.propagationStopped||this.dragging_||!this.isMouseActionButton_(e)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(ra),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},t.prototype.isMouseActionButton_=function(e){return 0===e.button},t.prototype.handlePointerDown_=function(e){this.updateActivePointers_(e);var t=new Ib(na.POINTERDOWN,this.map_,e);this.dispatchEvent(t),this.down_=e,0===this.dragListenerKeys_.length&&this.dragListenerKeys_.push(fa(document,na.POINTERMOVE,this.handlePointerMove_,this),fa(document,na.POINTERUP,this.handlePointerUp_,this),fa(this.element_,na.POINTERCANCEL,this.handlePointerUp_,this))},t.prototype.handlePointerMove_=function(e){if(this.isMoving_(e)){this.dragging_=!0;var t=new Ib(na.POINTERDRAG,this.map_,e,this.dragging_);this.dispatchEvent(t)}},t.prototype.relayEvent_=function(e){this.originalPointerMoveEvent_=e;var t=!(!this.down_||!this.isMoving_(e));this.dispatchEvent(new Ib(e.type,this.map_,e,t))},t.prototype.handleTouchMove_=function(e){this.originalPointerMoveEvent_&&!this.originalPointerMoveEvent_.defaultPrevented||e.preventDefault()},t.prototype.isMoving_=function(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_},t.prototype.disposeInternal=function(){this.relayedListenerKey_&&(ra(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(ca.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(ra(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(ra),this.dragListenerKeys_.length=0,this.element_=null,e.prototype.disposeInternal.call(this)},t}(qc);Vg.default=nk;var fd={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"};var Na={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};var Ie={};var Je=1/0;var To=function(){function t(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return t.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,Sb(this.queuedElements_)},t.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var n=this.keyFunction_(i);return delete this.queuedElements_[n],i},t.prototype.enqueue=function(t){ea(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=Je&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},t.prototype.getCount=function(){return this.elements_.length},t.prototype.getLeftChildIndex_=function(t){return 2*t+1},t.prototype.getRightChildIndex_=function(t){return 2*t+2},t.prototype.getParentIndex_=function(t){return t-1>>1},t.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},t.prototype.isEmpty=function(){return 0===this.elements_.length},t.prototype.isKeyQueued=function(t){return t in this.queuedElements_},t.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},t.prototype.siftUp_=function(t){for(var e=this.elements_,i=this.priorities_,n=e.length,r=e[t],s=i[t],o=t;t<n>>1;){var u=this.getLeftChildIndex_(t),h=this.getRightChildIndex_(t),p=h<n&&i[h]<i[u]?h:u;e[t]=e[p],i[t]=i[p],t=p}e[t]=r,i[t]=s,this.siftDown_(o,t)},t.prototype.siftDown_=function(t,e){for(var i=this.elements_,n=this.priorities_,r=i[e],s=n[e];e>t;){var o=this.getParentIndex_(e);if(!(n[o]>s))break;i[e]=i[o],n[e]=n[o],e=o}i[e]=r,n[e]=s},t.prototype.reprioritize=function(){var t,e,i,n=this.priorityFunction_,r=this.elements_,s=this.priorities_,o=0,u=r.length;for(e=0;e<u;++e)(i=n(t=r[e]))==Je?delete this.queuedElements_[this.keyFunction_(t)]:(s[o]=i,r[o++]=t);r.length=o,s.length=o,this.heapify_()},t}();var Uo=Ie&&Ie.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Zg=function(t){function e(e,i){var r=t.call(this,function(t){return e.apply(null,t)},function(t){return t[0].getKey()})||this;return r.boundHandleTileChange_=r.handleTileChange.bind(r),r.tileChangeCallback_=i,r.tilesLoading_=0,r.tilesLoadingKeys_={},r}return Uo(e,t),e.prototype.enqueue=function(e){var i=t.prototype.enqueue.call(this,e);i&&e[0].addEventListener(ca.CHANGE,this.boundHandleTileChange_);return i},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var e=t.target,i=e.getState();if(e.hifi&&i===ba.LOADED||i===ba.ERROR||i===ba.EMPTY){e.removeEventListener(ca.CHANGE,this.boundHandleTileChange_);var r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,e){for(var i,r,n=0;this.tilesLoading_<t&&n<e&&this.getCount()>0;)r=(i=this.dequeue()[0]).getKey(),i.getState()!==ba.IDLE||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++n,i.load())},e}(To);function ok(t,e,i,r,n){if(!(t&&i in t.wantedTiles))return Je;if(!t.wantedTiles[i][e.getKey()])return Je;var o=t.viewState.center,a=r[0]-o[0],$=r[1]-o[1];return 65536*Math.log(n)+Math.sqrt(a*a+$*$)/n}Ie.default=Zg,Ie.getTilePriority=ok;var Ac={};var Vo=42;var Bc=256;function Ke(t,$,e){return function(r,a,c,o){if(r){var n=$?0:c[0]*a,x=$?0:c[1]*a,p=t[0]+n/2,z=t[2]-n/2,R=t[1]+x/2,h=t[3]-x/2;p>z&&(z=p=(z+p)/2),R>h&&(h=R=(h+R)/2);var m=ja(r[0],p,z),M=ja(r[1],R,h),i=30*a;return o&&e&&(m+=-i*Math.log(1+Math.max(0,p-r[0])/i)+i*Math.log(1+Math.max(0,r[0]-z)/i),M+=-i*Math.log(1+Math.max(0,R-r[1])/i)+i*Math.log(1+Math.max(0,r[1]-h)/i)),[m,M]}}}function pk(t){return t}function $g(o,t,e,n){var r=la(t)/e[0],a=va(t)/e[1];return n?Math.min(o,Math.max(r,a)):Math.min(o,Math.min(r,a))}function _g(o,t,e){var n=Math.min(o,t);return n*=Math.log(1+50*Math.max(0,o/t-1))/50+1,e&&(n=Math.max(n,e),n/=Math.log(1+50*Math.max(0,e/o-1))/50+1),ja(n,e/2,2*t)}function qk(o,t,e,n){return function(r,a,$,l){if(void 0!==r){var i=o[0],p=o[o.length-1],m=e?$g(i,e,$,n):i;if(l)return void 0===t||t?_g(r,m,p):ja(r,p,m);var u=Math.min(m,r),h=Math.floor(pd(o,u,a));return o[h]>m&&h<o.length-1?o[h+1]:o[h]}}}function rk(o,t,e,n,r,a){return function($,l,i,p){if(void 0!==$){var m=r?$g(t,r,i,a):t,u=void 0!==e?e:0;if(p)return void 0===n||n?_g($,m,u):ja($,u,m);var h=Math.ceil(Math.log(t/m)/Math.log(o)-1e-9),M=-l*(.5-1e-9)+.5,c=Math.min(m,$),s=Math.floor(Math.log(t/c)/Math.log(o)+M),v=Math.max(h,s),g=t/Math.pow(o,v);return ja(g,u,m)}}}function Le(o,t,e,n,r){return function(a,$,l,i){if(void 0!==a){var p=n?$g(o,n,l,r):o;return(void 0===e||e)&&i?_g(a,p,t):ja(a,t,p)}}}function Me(e){return void 0!==e?0:void 0}function Ne(e){return void 0!==e?e:void 0}function sk(e){var o=2*Math.PI/e;return function(e,r){return r?e:void 0!==e?e=Math.floor(e/o+.5)*o:void 0}}function tk(e){var o=e||ub(5);return function(e,r){return r?e:void 0!==e?Math.abs(e)<=o?0:e:void 0}}var qa={ANIMATING:0,INTERACTING:1};var Ca={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function ah(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}function Wo(t,e){var r=e.getRadius(),$=e.getCenter(),n=$[0],s=$[1],o=t[0]-n,a=t[1]-s;0===o&&0===a&&(o=1);var p=Math.sqrt(o*o+a*a);return[n+r*o/p,s+r*a/p]}function Oe(t,e){var r,$,n=t[0],s=t[1],o=e[0],a=e[1],p=o[0],j=o[1],i=a[0],G=a[1],x=i-p,c=G-j,u=0===x&&0===c?0:(x*(n-p)+c*(s-j))/(x*x+c*c||0);return u<=0?(r=p,$=j):u>=1?(r=i,$=G):(r=p+u*x,$=j+u*c),[r,$]}function uk(t,e,r){var $=cb(e+180,360)-180,n=Math.abs(3600*$),s=r||0,o=Math.pow(10,s),a=Math.floor(n/3600),p=Math.floor((n-3600*a)/60),j=n-3600*a-60*p;return(j=Math.ceil(j*o)/o)>=60&&(j=0,p+=1),p>=60&&(p=0,a+=1),a+"\xB0 "+wk(p,2)+"\u2032 "+wk(j,2,s)+"\u2033"+(0==$?"":" "+t.charAt($<0?1:0))}function Za(t,e){for(var r=!0,$=t.length-1;$>=0;--$)if(t[$]!=e[$]){r=!1;break}return r}function Pe(t,e){var r=Math.cos(e),$=Math.sin(e),n=t[0]*r-t[1]*$,s=t[1]*r+t[0]*$;return t[0]=n,t[1]=s,t}function vk(t,e){return t[0]*=e,t[1]*=e,t}function $a(t,e){var r=t[0]-e[0],$=t[1]-e[1];return r*r+$*$}function Qe(t,e){return Math.sqrt($a(t,e))}function Re(t,e){return $a(t,Oe(t,e))}function bh(t,e){var r=e.getExtent();if(e.canWrapX()&&(t[0]<r[0]||t[0]>=r[2])){var $=la(r),n=Math.floor((t[0]-r[0])/$);t[0]-=n*$}return t}function wk(r,e,t){var i=void 0!==t?r.toFixed(t):""+r,n=i.indexOf(".");return(n=-1===n?i.length:n)>e?i:new Array(1+e-n).join("0")+i}function xk(r,e){for(var t=(""+r).split("."),i=(""+e).split("."),n=0;n<Math.max(t.length,i.length);n++){var o=parseInt(t[n]||"0",10),$=parseInt(i[n]||"0",10);if(o>$)return 1;if($>o)return-1}return 0}function yk(e){return Math.pow(e,3)}function $b(e){return 1-yk(1-e)}function zk(e){return 3*e*e-2*e*e*e}function Xo(e){return e}var Cc={};var wa={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};var ch={};var Gd={};var dh={};function Dc(r,t,e,$,o,a){for(var n=a||[],s=0,f=t;f<e;f+=$){var l=r[f],p=r[f+1];n[s++]=o[0]*l+o[2]*p+o[4],n[s++]=o[1]*l+o[3]*p+o[5]}return a&&n.length!=s&&(n.length=s),n}function Ak(r,t,e,$,o,a,n){for(var s=n||[],f=Math.cos(o),l=Math.sin(o),p=a[0],w=a[1],x=0,G=t;G<e;G+=$){var L=r[G]-p,v=r[G+1]-w;s[x++]=p+L*f-v*l,s[x++]=w+L*l+v*f;for(var h=G+2;h<G+$;++h)s[x++]=r[h]}return n&&s.length!=x&&(s.length=x),s}function Yo(r,t,e,$,o,a,n,s){for(var f=s||[],l=n[0],p=n[1],w=0,x=t;x<e;x+=$){var G=r[x]-l,L=r[x+1]-p;f[w++]=l+o*G,f[w++]=p+a*L;for(var v=x+2;v<x+$;++v)f[w++]=r[v]}return s&&f.length!=w&&(f.length=w),f}function Bk(r,t,e,$,o,a,n){for(var s=n||[],f=0,l=t;l<e;l+=$){s[f++]=r[l]+o,s[f++]=r[l+1]+a;for(var p=l+2;p<l+$;++p)s[f++]=r[p]}return n&&s.length!=f&&(s.length=f),s}var Zo=dh&&dh.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),Ck=Fa(),Se=function(t){function r(){var r=t.call(this)||this;return r.extent_=Ha(),r.extentRevision_=-1,r.simplifiedGeometryMaxMinSquaredTolerance=0,r.simplifiedGeometryRevision=0,r.simplifyTransformedInternal=In(function(t,r,e){if(!e)return this.getSimplifiedGeometry(r);var o=this.clone();return o.applyTransform(e),o.getSimplifiedGeometry(r)}),r}return Zo(r,t),r.prototype.simplifyTransformed=function(t,r){return this.simplifyTransformedInternal(this.getRevision(),t,r)},r.prototype.clone=function(){return ma()},r.prototype.closestPointXY=function(t,r,e,o){return ma()},r.prototype.containsXY=function(t,r){var e=this.getClosestPoint([t,r]);return e[0]===t&&e[1]===r},r.prototype.getClosestPoint=function(t,r){var e=r||[NaN,NaN];return this.closestPointXY(t[0],t[1],e,1/0),e},r.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},r.prototype.computeExtent=function(t){return ma()},r.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),ho(this.extent_,t)},r.prototype.rotate=function(t,r){ma()},r.prototype.scale=function(t,r,e){ma()},r.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},r.prototype.getSimplifiedGeometry=function(t){return ma()},r.prototype.getType=function(){return ma()},r.prototype.applyTransform=function(t){ma()},r.prototype.intersectsExtent=function(t){return ma()},r.prototype.translate=function(t,r){ma()},r.prototype.transform=function(t,r){var e=pa(t),o=e.getUnits()==Qa.TILE_PIXELS?function(t,o,n){var s=e.getExtent(),i=e.getWorldExtent(),$=va(i)/va(s);return Ya(Ck,i[0],i[3],$,-$,0,0,0),Dc(t,0,t.length,n,Ck,o),Cb(e,r)(t,o,n)}:Cb(e,r);return this.applyTransform(o),this},r}(Ta);dh.default=Se;var $o=Gd&&Gd.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),Kb=function(t){function r(){var r=t.call(this)||this;return r.layout=wa.XY,r.stride=2,r.flatCoordinates=null,r}return $o(r,t),r.prototype.computeExtent=function(t){return Nj(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},r.prototype.getCoordinates=function(){return ma()},r.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},r.prototype.getFlatCoordinates=function(){return this.flatCoordinates},r.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},r.prototype.getLayout=function(){return this.layout},r.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var r=this.getSimplifiedGeometryInternal(t);return r.getFlatCoordinates().length<this.flatCoordinates.length?r:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},r.prototype.getSimplifiedGeometryInternal=function(t){return this},r.prototype.getStride=function(){return this.stride},r.prototype.setFlatCoordinates=function(t,r){this.stride=eh(t),this.layout=t,this.flatCoordinates=r},r.prototype.setCoordinates=function(t,r){ma()},r.prototype.setLayout=function(t,r,e){var o;if(t)o=eh(t);else{for(var i=0;i<e;++i){if(0===r.length)return this.layout=wa.XY,void(this.stride=2);r=r[0]}t=_o(o=r.length)}this.layout=t,this.stride=o},r.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},r.prototype.rotate=function(t,r){var e=this.getFlatCoordinates();if(e){var o=this.getStride();Ak(e,0,e.length,o,t,r,e),this.changed()}},r.prototype.scale=function(t,r,e){var o=r;void 0===o&&(o=t);var i=e;i||(i=Ma(this.getExtent()));var n=this.getFlatCoordinates();if(n){var a=this.getStride();Yo(n,0,n.length,a,t,o,i,n),this.changed()}},r.prototype.translate=function(t,r){var e=this.getFlatCoordinates();if(e){var o=this.getStride();Bk(e,0,e.length,o,t,r,e),this.changed()}},r}(Se);function _o(t){var r;return 2==t?r=wa.XY:3==t?r=wa.XYZ:4==t&&(r=wa.XYZM),r}function eh(t){var r;return t==wa.XY?r=2:t==wa.XYZ||t==wa.XYM?r=3:t==wa.XYZM&&(r=4),r}function Dk(t,r,e){var o=t.getFlatCoordinates();if(o){var i=t.getStride();return Dc(o,0,o.length,i,r,e)}return null}Gd.getStrideForLayout=eh,Gd.transformGeom2D=Dk,Gd.default=Kb;function Ek(r,n,$,e){for(var i=0,t=r[$-e],a=r[$-e+1];n<$;n+=e){var o=r[n],g=r[n+1];i+=a*o-t*g,t=o,a=g}return i/2}function Fk(r,n,$,e){for(var i=0,t=0,a=$.length;t<a;++t){var o=$[t];i+=Ek(r,n,o,e),n=o}return i}function ap(r,n,$,e){for(var i=0,t=0,a=$.length;t<a;++t){var o=$[t];i+=Fk(r,n,o,e),n=o[o.length-1]}return i}function Gk(r,a,t,e,$,s,o){var n,i=r[a],l=r[a+1],M=r[t]-i,u=r[t+1]-l;if(0===M&&0===u)n=a;else{var x=(($-i)*M+(s-l)*u)/(M*M+u*u);if(x>1)n=t;else{if(x>0){for(var p=0;p<e;++p)o[p]=Rc(r[a+p],r[t+p],x);return void(o.length=e)}n=a}}for(p=0;p<e;++p)o[p]=r[n+p];o.length=e}function fh(r,a,t,e,$){var s=r[a],o=r[a+1];for(a+=e;a<t;a+=e){var n=r[a],i=r[a+1],l=rc(s,o,n,i);l>$&&($=l),s=n,o=i}return $}function gh(r,a,t,e,$){for(var s=0,o=t.length;s<o;++s){var n=t[s];$=fh(r,a,n,e,$),a=n}return $}function bp(r,a,t,e,$){for(var s=0,o=t.length;s<o;++s){var n=t[s];$=gh(r,a,n,e,$),a=n[n.length-1]}return $}function hh(r,a,t,e,$,s,o,n,i,l,M){if(a==t)return l;var u,x;if(0===$){if((x=rc(o,n,r[a],r[a+1]))<l){for(u=0;u<e;++u)i[u]=r[a+u];return i.length=e,x}return l}for(var p=M||[NaN,NaN],f=a+e;f<t;)if(Gk(r,f-e,f,e,o,n,p),(x=rc(o,n,p[0],p[1]))<l){for(l=x,u=0;u<e;++u)i[u]=p[u];i.length=e,f+=e}else f+=e*Math.max((Math.sqrt(x)-Math.sqrt(l))/$|0,1);if(s&&(Gk(r,t-e,a,e,o,n,p),(x=rc(o,n,p[0],p[1]))<l)){for(l=x,u=0;u<e;++u)i[u]=p[u];i.length=e}return l}function ih(r,a,t,e,$,s,o,n,i,l,M){for(var u=M||[NaN,NaN],x=0,p=t.length;x<p;++x){var f=t[x];l=hh(r,a,f,e,$,s,o,n,i,l,u),a=f}return l}function cp(r,a,t,e,$,s,o,n,i,l,M){for(var u=M||[NaN,NaN],x=0,p=t.length;x<p;++x){var f=t[x];l=ih(r,a,f,e,$,s,o,n,i,l,u),a=f[f.length-1]}return l}function Hk(e,r,t,o){for(var a=0,$=t.length;a<$;++a)e[r++]=t[a];return r}function Te(e,r,t,o){for(var a=0,$=t.length;a<$;++a)for(var n=t[a],d=0;d<o;++d)e[r++]=n[d];return r}function jh(e,r,t,o,a){for(var $=a||[],n=0,d=0,l=t.length;d<l;++d){var f=Te(e,r,t[d],o);$[n++]=f,r=f}return $.length=n,$}function dp(e,r,t,o,a){for(var $=a||[],n=0,d=0,l=t.length;d<l;++d){var f=jh(e,r,t[d],o,$[n]);$[n++]=f,r=f[f.length-1]}return $.length=n,$}function Hd(r,n,t,e,o){for(var a=void 0!==o?o:[],l=0,i=n;i<t;i+=e)a[l++]=r.slice(i,i+e);return a.length=l,a}function Ue(r,n,t,e,o){for(var a=void 0!==o?o:[],l=0,i=0,$=t.length;i<$;++i){var f=t[i];a[l++]=Hd(r,n,f,e,a[l]),n=f}return a.length=l,a}function Ik(r,n,t,e,o){for(var a=void 0!==o?o:[],l=0,i=0,$=t.length;i<$;++i){var f=t[i];a[l++]=Ue(r,n,f,e,a[l]),n=f[f.length-1]}return a.length=l,a}function kh(r,t,$,e,p,a,o){var n=($-t)/e;if(n<3){for(;t<$;t+=e)a[o++]=r[t],a[o++]=r[t+1];return o}var u=new Array(n);u[0]=1,u[n-1]=1;for(var i=[t,$-e],s=0;i.length>0;){for(var E=i.pop(),I=i.pop(),x=0,l=r[I],c=r[I+1],f=r[E],g=r[E+1],d=I+e;d<E;d+=e){var v=r[d],y=r[d+1],h=Jj(v,y,l,c,f,g);h>x&&(s=d,x=h)}x>p&&(u[(s-t)/e]=1,I+e<s&&i.push(I,s),s+e<E&&i.push(s,E))}for(d=0;d<n;++d)u[d]&&(a[o++]=r[t+d*e],a[o++]=r[t+d*e+1]);return o}function ep(r,t,$,e,p,a,o,n){for(var u=0,i=$.length;u<i;++u){var s=$[u];o=kh(r,t,s,e,p,a,o),n.push(o),t=s}return o}function Ec(r,t){return t*Math.round(r/t)}function fp(r,t,$,e,p,a,o){if(t==$)return o;var n,u,i=Ec(r[t],p),s=Ec(r[t+1],p);t+=e,a[o++]=i,a[o++]=s;do{if(n=Ec(r[t],p),u=Ec(r[t+1],p),(t+=e)==$)return a[o++]=n,a[o++]=u,o}while(n==i&&u==s);for(;t<$;){var E=Ec(r[t],p),I=Ec(r[t+1],p);if(t+=e,E!=n||I!=u){var x=n-i,l=u-s,c=E-i,f=I-s;x*f==l*c&&(x<0&&c<x||x==c||x>0&&c>x)&&(l<0&&f<l||l==f||l>0&&f>l)?(n=E,u=I):(a[o++]=n,a[o++]=u,i=n,s=u,n=E,u=I)}}return a[o++]=n,a[o++]=u,o}function Jk(r,t,$,e,p,a,o,n){for(var u=0,i=$.length;u<i;++u){var s=$[u];o=fp(r,t,s,e,p,a,o),n.push(o),t=s}return o}function gp(r,t,$,e,p,a,o,n){for(var u=0,i=$.length;u<i;++u){var s=$[u],E=[];o=Jk(r,t,s,e,p,a,o,E),n.push(E),t=s[s.length-1]}return o}var hp=ch&&ch.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Ve=function(t){function e(e,r){var o=t.call(this)||this;return o.maxDelta_=-1,o.maxDeltaRevision_=-1,void 0===r||Array.isArray(e[0])?o.setCoordinates(e,r):o.setFlatCoordinates(r,e),o}return hp(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,r,o){return o<sc(this.getExtent(),t,e)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(fh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),hh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,r,o))},e.prototype.getArea=function(){return Ek(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return Hd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[];return r.length=kh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,r,0),new e(r,wa.XY)},e.prototype.getType=function(){return aa.LINEAR_RING},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Te(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Kb);ch.default=Ve;var lh={};var ip=lh&&lh.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),gb=function(t){function e(e,r){var o=t.call(this)||this;return o.setCoordinates(e,r),o}return ip(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,r,o){var n=this.flatCoordinates,i=rc(t,e,n[0],n[1]);if(i<o){for(var s=this.stride,a=0;a<s;++a)r[a]=n[a];return r.length=s,i}return o},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return sd(this.flatCoordinates,t)},e.prototype.getType=function(){return aa.POINT},e.prototype.intersectsExtent=function(t){return zg(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Hk(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Kb);lh.default=gb;function jp(n,r,t,i,e){return!Pj(e,function(e){return!Fc(n,r,t,i,e[0],e[1])})}function Fc(n,r,t,i,e,$){for(var o=0,a=n[t-i],d=n[t-i+1];r<t;r+=i){var s=n[r],l=n[r+1];d<=$?l>$&&(s-a)*($-d)-(e-a)*(l-d)>0&&o++:l<=$&&(s-a)*($-d)-(e-a)*(l-d)<0&&o--,a=s,d=l}return 0!==o}function mh(n,r,t,i,e,$){if(0===t.length)return!1;if(!Fc(n,r,t[0],i,e,$))return!1;for(var o=1,a=t.length;o<a;++o)if(Fc(n,t[o-1],t[o],i,e,$))return!1;return!0}function kp(n,r,t,i,e,$){if(0===t.length)return!1;for(var o=0,a=t.length;o<a;++o){var d=t[o];if(mh(n,r,d,i,e,$))return!0;r=d[d.length-1]}return!1}function Kk(r,t,e,o,n,$,i){for(var a,v,s,N,p,f,u,g=n[$+1],D=[],U=0,l=e.length;U<l;++U){var x=e[U];for(N=r[x-o],f=r[x-o+1],a=t;a<x;a+=o)p=r[a],u=r[a+1],(g<=f&&u<=g||f<=g&&g<=u)&&(s=(g-f)/(u-f)*(p-N)+N,D.push(s)),N=p,f=u}var y=NaN,h=-1/0;for(D.sort(Ub),N=D[0],a=1,v=D.length;a<v;++a){p=D[a];var A=Math.abs(p-N);A>h&&(s=(N+p)/2,mh(r,t,e,o,s,g)&&(y=s,h=A)),N=p}return isNaN(y)&&(y=n[$]),i?(i.push(y,g,h),i):[y,g,h]}function lp(r,t,e,o,n){for(var $=[],i=0,a=e.length;i<a;++i){var v=e[i];$=Kk(r,t,v,o,n,2*i,$),t=v[v.length-1]}return $}function We(r,i,t,e,n){var $=Oj(Ha(),r,i,t,e);return!!ya(n,$)&&(!!La(n,$)||$[0]>=n[0]&&$[2]<=n[2]||$[1]>=n[1]&&$[3]<=n[3]||Mk(r,i,t,e,function(r,i){return io(n,r,i)}))}function mp(r,i,t,e,n){for(var $=0,s=t.length;$<s;++$){if(We(r,i,t[$],e,n))return!0;i=t[$]}return!1}function np(r,i,t,e,n){return!!We(r,i,t,e,n)||!!Fc(r,i,t,e,n[0],n[1])||!!Fc(r,i,t,e,n[0],n[3])||!!Fc(r,i,t,e,n[2],n[1])||!!Fc(r,i,t,e,n[2],n[3])}function Lk(r,i,t,e,n){if(!np(r,i,t[0],e,n))return!1;if(1===t.length)return!0;for(var $=1,s=t.length;$<s;++$)if(jp(r,t[$-1],t[$],e,n)&&!We(r,t[$-1],t[$],e,n))return!1;return!0}function op(r,i,t,e,n){for(var $=0,s=t.length;$<s;++$){var o=t[$];if(Lk(r,i,o,e,n))return!0;i=o[o.length-1]}return!1}function Mk(r,$,o,t,e){for(var f,i=[r[$],r[$+1]],a=[];$+t<o;$+=t){if(a[0]=r[$+t],a[1]=r[$+t+1],f=e(i,a))return f;i[0]=a[0],i[1]=a[1]}return!1}function Nk(r,e,n,i){for(var $=0,t=r[n-i],o=r[n-i+1];e<n;e+=i){var s=r[e],a=r[e+1];$+=(s-t)*(a+o),t=s,o=a}return $>0}function Ok(r,e,n,i,$){for(var t=void 0!==$&&$,o=0,s=n.length;o<s;++o){var a=n[o],c=Nk(r,e,a,i);if(0===o){if(t&&c||!t&&!c)return!1}else if(t&&!c||!t&&c)return!1;e=a}return!0}function pp(r,e,n,i,$){for(var t=0,o=n.length;t<o;++t){var s=n[t];if(!Ok(r,e,s,i,$))return!1;s.length&&(e=s[s.length-1])}return!0}function nh(r,e,n,i,$){for(var t=void 0!==$&&$,o=0,s=n.length;o<s;++o){var a=n[o],c=Nk(r,e,a,i);(0===o?t&&c||!t&&!c:t&&!c||!t&&c)&&qp(r,e,a,i),e=a}return e}function Pk(r,e,n,i,$){for(var t=0,o=n.length;t<o;++t)e=nh(r,e,n[t],i,$);return e}function qp(o,r,e,$){for(;r<e-$;){for(var t=0;t<$;++t){var a=o[r+t];o[r+t]=o[e-$+t],o[e-$+t]=a}r+=$,e-=$}}var rp=Cc&&Cc.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),xb=function(t){function e(e,r,i){var o=t.call(this)||this;return o.ends_=[],o.flatInteriorPointRevision_=-1,o.flatInteriorPoint_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,void 0!==r&&i?(o.setFlatCoordinates(r,e),o.ends_=i):o.setCoordinates(e,r),o}return rp(e,t),e.prototype.appendLinearRing=function(t){this.flatCoordinates?bb(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,r,i){return i<sc(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(gh(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ih(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,r,i))},e.prototype.containsXY=function(t,e){return mh(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return Fk(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),nh(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Ue(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Ma(this.getExtent());this.flatInteriorPoint_=Kk(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new gb(this.getFlatInteriorPoint(),wa.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new Ve(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,r=this.ends_,i=[],o=0,n=0,s=r.length;n<s;++n){var a=r[n],$=new Ve(e.slice(o,a),t);i.push($),o=a}return i},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Ok(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=nh(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[],i=[];return r.length=Jk(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),r,0,i),new e(r,wa.XY,i)},e.prototype.getType=function(){return aa.POLYGON},e.prototype.intersectsExtent=function(t){return Lk(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=jh(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===r.length?0:r[r.length-1],this.changed()},e}(Kb);function Qk(t,e,r,i){for(var o=r||32,n=[],s=0;s<o;++s)bb(n,_n(t,e,2*Math.PI*s/o,i));return n.push(n[0],n[1]),new xb(n,wa.XY,[n.length])}function Lb(t){var e=t[0],r=t[1],i=t[2],o=t[3],n=[e,r,e,o,i,o,i,r,e,r];return new xb(n,wa.XY,[n.length])}function Id(t,e,r){for(var i=e||32,o=t.getStride(),n=t.getLayout(),s=t.getCenter(),a=o*(i+1),$=new Array(a),w=0;w<a;w+=o){$[w]=0,$[w+1]=0;for(var l=2;l<o;l++)$[w+l]=s[l]}var p=[$.length],h=new xb($,n,p);return oh(h,s,t.getRadius(),r),h}function oh(t,e,r,i){for(var o=t.getFlatCoordinates(),n=t.getStride(),s=o.length/n-1,a=i||0,$=0;$<=s;++$){var w=$*n,l=a+2*cb($,s)*Math.PI/s;o[w]=e[0]+r*Math.cos(l),o[w+1]=e[1]+r*Math.sin(l)}t.changed()}Cc.default=xb,Cc.circular=Qk,Cc.fromExtent=Lb,Cc.fromCircle=Id,Cc.makeRegular=oh;var sp=Ac&&Ac.__extends||function(){var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(o,e)};return function(o,e){function i(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),ph=0,qh=function(t){function o(o){var e=t.call(this)||this,i=ha({},o);return e.hints_=[0,0],e.animations_=[],e.updateAnimationKey_,e.projection_=Sc(i.projection,"EPSG:3857"),e.viewportSize_=[100,100],e.targetCenter_=null,e.targetResolution_,e.targetRotation_,e.cancelAnchor_=void 0,i.center&&(i.center=oa(i.center,e.projection_)),i.extent&&(i.extent=Ua(i.extent,e.projection_)),e.applyOptions_(i),e}return sp(o,t),o.prototype.applyOptions_=function(t){var o=Sk(t);this.maxResolution_=o.maxResolution,this.minResolution_=o.minResolution,this.zoomFactor_=o.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=o.minZoom;var e=Rk(t),i=o.constraint,n=Tk(t);this.constraints_={center:e,resolution:i,rotation:n},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom),this.setProperties({}),this.options_=t},o.prototype.getUpdatedOptions_=function(t){var o=ha({},this.options_);return void 0!==o.resolution?o.resolution=this.getResolution():o.zoom=this.getZoom(),o.center=this.getCenterInternal(),o.rotation=this.getRotation(),ha({},o,t)},o.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var o=new Array(arguments.length),e=0;e<o.length;++e){var i=arguments[e];i.center&&((i=ha({},i)).center=oa(i.center,this.getProjection())),i.anchor&&((i=ha({},i)).anchor=oa(i.anchor,this.getProjection())),o[e]=i}this.animateInternal.apply(this,o)},o.prototype.animateInternal=function(t){var o,e=arguments.length;if(e>1&&"function"==typeof arguments[e-1]&&(o=arguments[e-1],--e),!this.isDef()){var i=arguments[e-1];return i.center&&this.setCenterInternal(i.center),void 0!==i.zoom&&this.setZoom(i.zoom),void 0!==i.rotation&&this.setRotation(i.rotation),void(o&&Xe(o,!0))}for(var n=Date.now(),r=this.targetCenter_.slice(),s=this.targetResolution_,a=this.targetRotation_,h=[],p=0;p<e;++p){var $=arguments[p],u={start:n,complete:!1,anchor:$.anchor,duration:void 0!==$.duration?$.duration:1e3,easing:$.easing||zk,callback:o};if($.center&&(u.sourceCenter=r,u.targetCenter=$.center.slice(),r=u.targetCenter),void 0!==$.zoom?(u.sourceResolution=s,u.targetResolution=this.getResolutionForZoom($.zoom),s=u.targetResolution):$.resolution&&(u.sourceResolution=s,u.targetResolution=$.resolution,s=u.targetResolution),void 0!==$.rotation){u.sourceRotation=a;var l=cb($.rotation-a+Math.PI,2*Math.PI)-Math.PI;u.targetRotation=a+l,a=u.targetRotation}Uk(u)?u.complete=!0:n+=u.duration,h.push(u)}this.animations_.push(h),this.setHint(qa.ANIMATING,1),this.updateAnimations_()},o.prototype.getAnimating=function(){return this.hints_[qa.ANIMATING]>0},o.prototype.getInteracting=function(){return this.hints_[qa.INTERACTING]>0},o.prototype.cancelAnimations=function(){var t;this.setHint(qa.ANIMATING,-this.hints_[qa.ANIMATING]);for(var o=0,e=this.animations_.length;o<e;++o){var i=this.animations_[o];if(i[0].callback&&Xe(i[0].callback,!1),!t)for(var n=0,r=i.length;n<r;++n){var s=i[n];if(!s.complete){t=s.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t},o.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),o=!1,e=this.animations_.length-1;e>=0;--e){for(var i=this.animations_[e],n=!0,r=0,s=i.length;r<s;++r){var a=i[r];if(!a.complete){var h=t-a.start,p=a.duration>0?h/a.duration:1;p>=1?(a.complete=!0,p=1):n=!1;var $=a.easing(p);if(a.sourceCenter){var u=a.sourceCenter[0],l=a.sourceCenter[1],c=u+$*(a.targetCenter[0]-u),m=l+$*(a.targetCenter[1]-l);this.targetCenter_=[c,m]}if(a.sourceResolution&&a.targetResolution){var g=1===$?a.targetResolution:a.sourceResolution+$*(a.targetResolution-a.sourceResolution);if(a.anchor){var E=this.getViewportSize_(this.getRotation()),N=this.constraints_.resolution(g,0,E,!0);this.targetCenter_=this.calculateCenterZoom(N,a.anchor)}this.targetResolution_=g,this.applyTargetState_(!0)}if(void 0!==a.sourceRotation&&void 0!==a.targetRotation){var _=1===$?cb(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+$*(a.targetRotation-a.sourceRotation);if(a.anchor){var q=this.constraints_.rotation(_,!0);this.targetCenter_=this.calculateCenterRotate(q,a.anchor)}this.targetRotation_=_}if(this.applyTargetState_(!0),o=!0,!a.complete)break}}if(n){this.animations_[e]=null,this.setHint(qa.ANIMATING,-1);var R=i[0].callback;R&&Xe(R,!0)}}this.animations_=this.animations_.filter(Boolean),o&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},o.prototype.calculateCenterRotate=function(t,o){var e,i=this.getCenterInternal();return void 0!==i&&(e=[i[0]-o[0],i[1]-o[1]],Pe(e,t-this.getRotation()),ah(e,o)),e},o.prototype.calculateCenterZoom=function(t,o){var e,i=this.getCenterInternal(),n=this.getResolution();void 0!==i&&void 0!==n&&(e=[o[0]-t*(o[0]-i[0])/n,o[1]-t*(o[1]-i[1])/n]);return e},o.prototype.getViewportSize_=function(t){var o=this.viewportSize_;if(t){var e=o[0],i=o[1];return[Math.abs(e*Math.cos(t))+Math.abs(i*Math.sin(t)),Math.abs(e*Math.sin(t))+Math.abs(i*Math.cos(t))]}return o},o.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.resolveConstraints(0)},o.prototype.getCenter=function(){var t=this.getCenterInternal();return t?Fb(t,this.getProjection()):t},o.prototype.getCenterInternal=function(){return this.get(Ca.CENTER)},o.prototype.getConstraints=function(){return this.constraints_},o.prototype.getConstrainResolution=function(){return this.options_.constrainResolution},o.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},o.prototype.calculateExtent=function(t){var o=this.calculateExtentInternal(t);return $c(o,this.getProjection())},o.prototype.calculateExtentInternal=function(t){var o=t||this.getViewportSize_(),e=this.getCenterInternal();ea(e,1);var i=this.getResolution();ea(void 0!==i,2);var n=this.getRotation();return ea(void 0!==n,3),Wc(e,i,n,o)},o.prototype.getMaxResolution=function(){return this.maxResolution_},o.prototype.getMinResolution=function(){return this.minResolution_},o.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},o.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},o.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},o.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},o.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},o.prototype.getProjection=function(){return this.projection_},o.prototype.getResolution=function(){return this.get(Ca.RESOLUTION)},o.prototype.getResolutions=function(){return this.resolutions_},o.prototype.getResolutionForExtent=function(t,o){return this.getResolutionForExtentInternal(Ua(t,this.getProjection()),o)},o.prototype.getResolutionForExtentInternal=function(t,o){var e=o||this.getViewportSize_(),i=la(t)/e[0],n=va(t)/e[1];return Math.max(i,n)},o.prototype.getResolutionForValueFunction=function(t){var o=t||2,e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(e/i)/Math.log(o);return function(t){return e/Math.pow(o,t*n)}},o.prototype.getRotation=function(){return this.get(Ca.ROTATION)},o.prototype.getValueForResolutionFunction=function(t){var o=Math.log(t||2),e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(e/i)/o;return function(t){return Math.log(e/t)/o/n}},o.prototype.getState=function(){var t=this.getCenterInternal(),o=this.getProjection(),e=this.getResolution(),i=this.getRotation();return{center:t.slice(0),projection:void 0!==o?o:null,resolution:e,rotation:i,zoom:this.getZoom()}},o.prototype.getZoom=function(){var t,o=this.getResolution();return void 0!==o&&(t=this.getZoomForResolution(o)),t},o.prototype.getZoomForResolution=function(t){var o,e,i=this.minZoom_||0;if(this.resolutions_){var n=pd(this.resolutions_,t,1);i=n,o=this.resolutions_[n],e=n==this.resolutions_.length-1?2:o/this.resolutions_[n+1]}else o=this.maxResolution_,e=this.zoomFactor_;return i+Math.log(o/t)/Math.log(e)},o.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var o=ja(Math.floor(t),0,this.resolutions_.length-2),e=this.resolutions_[o]/this.resolutions_[o+1];return this.resolutions_[o]/Math.pow(e,ja(t-o,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},o.prototype.fit=function(t,o){var e,i=ha({size:this.getViewportSize_()},o||{});if(ea(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t)){ea(!wc(t),25);var n=Ua(t,this.getProjection());e=Lb(n)}else if(t.getType()===aa.CIRCLE){n=Ua(t.getExtent(),this.getProjection());(e=Lb(n)).rotate(this.getRotation(),Ma(n))}else{var r=Ra();e=r?t.clone().transform(r,this.getProjection()):t}this.fitInternal(e,i)},o.prototype.fitInternal=function(t,o){var e=o||{},i=e.size;i||(i=this.getViewportSize_());var n,r=void 0!==e.padding?e.padding:[0,0,0,0],s=void 0!==e.nearest&&e.nearest;n=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;for(var a=t.getFlatCoordinates(),h=this.getRotation(),p=Math.cos(-h),$=Math.sin(-h),u=1/0,l=1/0,c=-1/0,m=-1/0,g=t.getStride(),E=0,N=a.length;E<N;E+=g){var _=a[E]*p-a[E+1]*$,q=a[E]*$+a[E+1]*p;u=Math.min(u,_),l=Math.min(l,q),c=Math.max(c,_),m=Math.max(m,q)}var R=this.getResolutionForExtentInternal([u,l,c,m],[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);R=isNaN(R)?n:Math.max(R,n),R=this.getConstrainedResolution(R,s?0:1),$=-$;var v=(u+c)/2,f=(l+m)/2,d=[(v+=(r[1]-r[3])/2*R)*p-(f+=(r[0]-r[2])/2*R)*$,f*p+v*$],y=e.callback?e.callback:tb;void 0!==e.duration?this.animateInternal({resolution:R,center:this.getConstrainedCenter(d,R),duration:e.duration,easing:e.easing},y):(this.targetResolution_=R,this.targetCenter_=d,this.applyTargetState_(!1,!0),Xe(y,!0))},o.prototype.centerOn=function(t,o,e){this.centerOnInternal(oa(t,this.getProjection()),o,e)},o.prototype.centerOnInternal=function(t,o,e){var i=this.getRotation(),n=Math.cos(-i),r=Math.sin(-i),s=t[0]*n-t[1]*r,a=t[1]*n+t[0]*r,h=this.getResolution(),p=(s+=(o[0]/2-e[0])*h)*n-(a+=(e[1]-o[1]/2)*h)*(r=-r),$=a*n+s*r;this.setCenterInternal([p,$])},o.prototype.isDef=function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()},o.prototype.adjustCenter=function(t){var o=Fb(this.targetCenter_,this.getProjection());this.setCenter([o[0]+t[0],o[1]+t[1]])},o.prototype.adjustCenterInternal=function(t){var o=this.targetCenter_;this.setCenterInternal([o[0]+t[0],o[1]+t[1]])},o.prototype.adjustResolution=function(t,o){var e=o&&oa(o,this.getProjection());this.adjustResolutionInternal(t,e)},o.prototype.adjustResolutionInternal=function(t,o){var e=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),n=this.constraints_.resolution(this.targetResolution_*t,0,i,e);o&&(this.targetCenter_=this.calculateCenterZoom(n,o)),this.targetResolution_*=t,this.applyTargetState_()},o.prototype.adjustZoom=function(t,o){this.adjustResolution(Math.pow(this.zoomFactor_,-t),o)},o.prototype.adjustRotation=function(t,o){o&&(o=oa(o,this.getProjection())),this.adjustRotationInternal(t,o)},o.prototype.adjustRotationInternal=function(t,o){var e=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+t,e);o&&(this.targetCenter_=this.calculateCenterRotate(i,o)),this.targetRotation_+=t,this.applyTargetState_()},o.prototype.setCenter=function(t){this.setCenterInternal(oa(t,this.getProjection()))},o.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},o.prototype.setHint=function(t,o){return this.hints_[t]+=o,this.changed(),this.hints_[t]},o.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},o.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},o.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},o.prototype.applyTargetState_=function(t,o){var e=this.getAnimating()||this.getInteracting()||o,i=this.constraints_.rotation(this.targetRotation_,e),n=this.getViewportSize_(i),r=this.constraints_.resolution(this.targetResolution_,0,n,e),s=this.constraints_.center(this.targetCenter_,r,n,e);this.get(Ca.ROTATION)!==i&&this.set(Ca.ROTATION,i),this.get(Ca.RESOLUTION)!==r&&this.set(Ca.RESOLUTION,r),this.get(Ca.CENTER)&&Za(this.get(Ca.CENTER),s)||this.set(Ca.CENTER,s),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0},o.prototype.resolveConstraints=function(t,o,e){var i=void 0!==t?t:200,n=o||0,r=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(r),a=this.constraints_.resolution(this.targetResolution_,n,s),h=this.constraints_.center(this.targetCenter_,a,s);if(0===i&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=r,this.targetCenter_=h,void this.applyTargetState_();var p=e||(0===i?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,this.getResolution()===a&&this.getRotation()===r&&this.getCenterInternal()&&Za(this.getCenterInternal(),h)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:h,resolution:a,duration:i,easing:$b,anchor:p}))},o.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(qa.INTERACTING,1)},o.prototype.endInteraction=function(t,o,e){var i=e&&oa(e,this.getProjection());this.endInteractionInternal(t,o,i)},o.prototype.endInteractionInternal=function(t,o,e){this.setHint(qa.INTERACTING,-1),this.resolveConstraints(t,o,e)},o.prototype.getConstrainedCenter=function(t,o){var e=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,o||this.getResolution(),e)},o.prototype.getConstrainedZoom=function(t,o){var e=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(e,o))},o.prototype.getConstrainedResolution=function(t,o){var e=o||0,i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)},o}(Ta);function Xe(t,o){setTimeout(function(){t(o)},0)}function Rk(t){if(void 0!==t.extent){var o=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return Ke(t.extent,t.constrainOnlyCenter,o)}var e=Sc(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){var i=e.getExtent().slice();return i[0]=-1/0,i[2]=1/0,Ke(i,!1,!1)}return pk}function Sk(t){var o,e,i,n=void 0!==t.minZoom?t.minZoom:ph,r=void 0!==t.maxZoom?t.maxZoom:28,s=void 0!==t.zoomFactor?t.zoomFactor:2,a=void 0!==t.multiWorld&&t.multiWorld,h=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,p=void 0!==t.showFullExtent&&t.showFullExtent,$=Sc(t.projection,"EPSG:3857"),u=$.getExtent(),l=t.constrainOnlyCenter,c=t.extent;if(a||c||!$.isGlobal()||(l=!1,c=u),void 0!==t.resolutions){var m=t.resolutions;e=m[n],i=void 0!==m[r]?m[r]:m[m.length-1],o=t.constrainResolution?qk(m,h,!l&&c,p):Le(e,i,h,!l&&c,p)}else{var g=(u?Math.max(la(u),va(u)):360*ob[Qa.DEGREES]/$.getMetersPerUnit())/Bc/Math.pow(2,ph),E=g/Math.pow(2,28-ph);void 0!==(e=t.maxResolution)?n=0:e=g/Math.pow(s,n),void 0===(i=t.minResolution)&&(i=void 0!==t.maxZoom?void 0!==t.maxResolution?e/Math.pow(s,r):g/Math.pow(s,r):E),r=n+Math.floor(Math.log(e/i)/Math.log(s)),i=e/Math.pow(s,r-n),o=t.constrainResolution?rk(s,e,i,h,!l&&c,p):Le(e,i,h,!l&&c,p)}return{constraint:o,maxResolution:e,minResolution:i,minZoom:n,zoomFactor:s}}function Tk(t){if(void 0===t.enableRotation||t.enableRotation){var o=t.constrainRotation;return void 0===o||!0===o?tk():!1===o?Ne:"number"==typeof o?sk(o):Ne}return Me}function Uk(t){return!(t.sourceCenter&&t.targetCenter&&!Za(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}Ac.createCenterConstraint=Rk,Ac.createResolutionConstraint=Sk,Ac.createRotationConstraint=Tk,Ac.isNoopAnimation=Uk,Ac.default=qh;var rh={};var tp=rh&&rh.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),sh={LAYERS:"layers"},Vk=function(e){function t(t){var n=this,r=t||{},i=ha({},r);delete i.layers;var o=r.layers;return(n=e.call(this,i)||this).layersListenerKeys_=[],n.listenerKeys_={},n.addEventListener(xa(sh.LAYERS),n.handleLayersChanged_),o?Array.isArray(o)?o=new Ja(o.slice(),{unique:!0}):ea("function"==typeof o.getArray,43):o=new Ja(void 0,{unique:!0}),n.setLayers(o),n}return tp(t,e),t.prototype.handleLayerChange_=function(){this.changed()},t.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(ra),this.layersListenerKeys_.length=0;var e=this.getLayers();for(var t in this.layersListenerKeys_.push(fa(e,Ba.ADD,this.handleLayersAdd_,this),fa(e,Ba.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[t].forEach(ra);Sb(this.listenerKeys_);for(var n=e.getArray(),r=0,i=n.length;r<i;r++){var o=n[r];this.listenerKeys_[da(o)]=[fa(o,Tb.PROPERTYCHANGE,this.handleLayerChange_,this),fa(o,ca.CHANGE,this.handleLayerChange_,this)]}this.changed()},t.prototype.handleLayersAdd_=function(e){var t=e.element;this.listenerKeys_[da(t)]=[fa(t,Tb.PROPERTYCHANGE,this.handleLayerChange_,this),fa(t,ca.CHANGE,this.handleLayerChange_,this)],this.changed()},t.prototype.handleLayersRemove_=function(e){var t=e.element,n=da(t);this.listenerKeys_[n].forEach(ra),delete this.listenerKeys_[n],this.changed()},t.prototype.getLayers=function(){return this.get(sh.LAYERS)},t.prototype.setLayers=function(e){this.set(sh.LAYERS,e)},t.prototype.getLayersArray=function(e){var t=void 0!==e?e:[];return this.getLayers().forEach(function(e){e.getLayersArray(t)}),t},t.prototype.getLayerStatesArray=function(e){var t=void 0!==e?e:[],n=t.length;this.getLayers().forEach(function(e){e.getLayerStatesArray(t)});for(var r=this.getLayerState(),i=n,o=t.length;i<o;i++){var s=t[i];s.opacity*=r.opacity,s.visible=s.visible&&r.visible,s.maxResolution=Math.min(s.maxResolution,r.maxResolution),s.minResolution=Math.max(s.minResolution,r.minResolution),s.minZoom=Math.max(s.minZoom,r.minZoom),s.maxZoom=Math.min(s.maxZoom,r.maxZoom),void 0!==r.extent&&(void 0!==s.extent?s.extent=vb(s.extent,r.extent):s.extent=r.extent)}return t},t.prototype.getSourceState=function(){return Aa.READY},t}(qg);rh.default=Vk;function Wk($,r,e){return void 0===e&&(e=[0,0]),e[0]=$[0]+2*r,e[1]=$[1]+2*r,e}function up($){return $[0]>0&&$[1]>0}function th($,r,e){return void 0===e&&(e=[0,0]),e[0]=$[0]*r+.5|0,e[1]=$[1]*r+.5|0,e}function Oa($,r){return Array.isArray($)?$:(void 0===r?r=[$,$]:(r[0]=$,r[1]=$),r)}var vp=Rg&&Rg.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ye=function(e){function t(t){var r=e.call(this)||this,i=wp(t);r.boundHandleBrowserEvent_=r.handleBrowserEvent.bind(r),r.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,r.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:we,r.postRenderTimeoutHandle_,r.animationDelayKey_,r.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(r),r.coordinateToPixelTransform_=Fa(),r.pixelToCoordinateTransform_=Fa(),r.frameIndex_=0,r.frameState_=null,r.previousExtent_=null,r.viewPropertyListenerKey_=null,r.viewChangeListenerKey_=null,r.layerGroupPropertyListenerKeys_=null,r.viewport_=document.createElement("div"),r.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),r.viewport_.style.position="relative",r.viewport_.style.overflow="hidden",r.viewport_.style.width="100%",r.viewport_.style.height="100%",r.overlayContainer_=document.createElement("div"),r.overlayContainer_.style.position="absolute",r.overlayContainer_.style.zIndex="0",r.overlayContainer_.style.width="100%",r.overlayContainer_.style.height="100%",r.overlayContainer_.className="ol-overlaycontainer",r.viewport_.appendChild(r.overlayContainer_),r.overlayContainerStopEvent_=document.createElement("div"),r.overlayContainerStopEvent_.style.position="absolute",r.overlayContainerStopEvent_.style.zIndex="0",r.overlayContainerStopEvent_.style.width="100%",r.overlayContainerStopEvent_.style.height="100%",r.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",r.viewport_.appendChild(r.overlayContainerStopEvent_),r.mapBrowserEventHandler_=new nk(r,t.moveTolerance);var n=r.handleMapBrowserEvent.bind(r);for(var o in na)r.mapBrowserEventHandler_.addEventListener(na[o],n);r.keyboardEventTarget_=i.keyboardEventTarget,r.keyHandlerKeys_=null;var a=r.handleBrowserEvent.bind(r);return r.viewport_.addEventListener(ca.CONTEXTMENU,a,!1),r.viewport_.addEventListener(ca.WHEEL,a,!!_j&&{passive:!1}),r.controls=i.controls||new Ja,r.interactions=i.interactions||new Ja,r.overlays_=i.overlays,r.overlayIdIndex_={},r.renderer_=null,r.handleResize_,r.postRenderFunctions_=[],r.tileQueue_=new Zg(r.getTilePriority.bind(r),r.handleTileChange_.bind(r)),r.addEventListener(xa(Na.LAYERGROUP),r.handleLayerGroupChanged_),r.addEventListener(xa(Na.VIEW),r.handleViewChanged_),r.addEventListener(xa(Na.SIZE),r.handleSizeChanged_),r.addEventListener(xa(Na.TARGET),r.handleTargetChanged_),r.setProperties(i.values),r.controls.forEach(function(e){e.setMap(this)}.bind(r)),r.controls.addEventListener(Ba.ADD,function(e){e.element.setMap(this)}.bind(r)),r.controls.addEventListener(Ba.REMOVE,function(e){e.element.setMap(null)}.bind(r)),r.interactions.forEach(function(e){e.setMap(this)}.bind(r)),r.interactions.addEventListener(Ba.ADD,function(e){e.element.setMap(this)}.bind(r)),r.interactions.addEventListener(Ba.REMOVE,function(e){e.element.setMap(null)}.bind(r)),r.overlays_.forEach(r.addOverlayInternal_.bind(r)),r.overlays_.addEventListener(Ba.ADD,function(e){this.addOverlayInternal_(e.element)}.bind(r)),r.overlays_.addEventListener(Ba.REMOVE,function(e){var t=e.element.getId();void 0!==t&&delete this.overlayIdIndex_[t.toString()],e.element.setMap(null)}.bind(r)),r}return vp(t,e),t.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},t.prototype.addControl=function(e){this.getControls().push(e)},t.prototype.addInteraction=function(e){this.getInteractions().push(e)},t.prototype.addLayer=function(e){this.getLayerGroup().getLayers().push(e)},t.prototype.addOverlay=function(e){this.getOverlays().push(e)},t.prototype.addOverlayInternal_=function(e){var t=e.getId();void 0!==t&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)},t.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),this.viewport_.removeEventListener(ca.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(ca.WHEEL,this.boundHandleBrowserEvent_),void 0!==this.handleResize_&&(removeEventListener(ca.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.setTarget(null),e.prototype.disposeInternal.call(this)},t.prototype.forEachFeatureAtPixel=function(e,t,r){if(this.frameState_){var i=this.getCoordinateFromPixelInternal(e),n=void 0!==(r=void 0!==r?r:{}).hitTolerance?r.hitTolerance*this.frameState_.pixelRatio:0,o=void 0!==r.layerFilter?r.layerFilter:Xa,a=!1!==r.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,n,a,t,null,o,null)}},t.prototype.getFeaturesAtPixel=function(e,t){var r=[];return this.forEachFeatureAtPixel(e,function(e){r.push(e)},t),r},t.prototype.forEachLayerAtPixel=function(e,t,r){if(this.frameState_){var i=r||{},n=void 0!==i.hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=i.layerFilter||Xa;return this.renderer_.forEachLayerAtPixel(e,this.frameState_,n,t,o)}},t.prototype.hasFeatureAtPixel=function(e,t){if(!this.frameState_)return!1;var r=this.getCoordinateFromPixelInternal(e),i=void 0!==(t=void 0!==t?t:{}).layerFilter?t.layerFilter:Xa,n=void 0!==t.hitTolerance?t.hitTolerance*this.frameState_.pixelRatio:0,o=!1!==t.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,n,o,i,null)},t.prototype.getEventCoordinate=function(e){return this.getCoordinateFromPixel(this.getEventPixel(e))},t.prototype.getEventCoordinateInternal=function(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))},t.prototype.getEventPixel=function(e){var t=this.viewport_.getBoundingClientRect(),r="changedTouches"in e?e.changedTouches[0]:e;return[r.clientX-t.left,r.clientY-t.top]},t.prototype.getTarget=function(){return this.get(Na.TARGET)},t.prototype.getTargetElement=function(){var e=this.getTarget();return void 0!==e?"string"==typeof e?document.getElementById(e):e:null},t.prototype.getCoordinateFromPixel=function(e){return Fb(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())},t.prototype.getCoordinateFromPixelInternal=function(e){var t=this.frameState_;return t?ta(t.pixelToCoordinateTransform,e.slice()):null},t.prototype.getControls=function(){return this.controls},t.prototype.getOverlays=function(){return this.overlays_},t.prototype.getOverlayById=function(e){var t=this.overlayIdIndex_[e.toString()];return void 0!==t?t:null},t.prototype.getInteractions=function(){return this.interactions},t.prototype.getLayerGroup=function(){return this.get(Na.LAYERGROUP)},t.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},t.prototype.getLoading=function(){for(var e=this.getLayerGroup().getLayerStatesArray(),t=0,r=e.length;t<r;++t){var i=e[t].layer.getSource();if(i&&i.loading)return!0}return!1},t.prototype.getPixelFromCoordinate=function(e){var t=oa(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)},t.prototype.getPixelFromCoordinateInternal=function(e){var t=this.frameState_;return t?ta(t.coordinateToPixelTransform,e.slice(0,2)):null},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.getSize=function(){return this.get(Na.SIZE)},t.prototype.getView=function(){return this.get(Na.VIEW)},t.prototype.getViewport=function(){return this.viewport_},t.prototype.getOverlayContainer=function(){return this.overlayContainer_},t.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},t.prototype.getTilePriority=function(e,t,r,i){return ok(this.frameState_,e,t,r,i)},t.prototype.handleBrowserEvent=function(e,t){var r=t||e.type,i=new Ug(r,this,e);this.handleMapBrowserEvent(i)},t.prototype.handleMapBrowserEvent=function(e){if(this.frameState_){var t=e.originalEvent.target;if(e.dragging||!this.overlayContainerStopEvent_.contains(t)&&(document.body.contains(t)||this.viewport_.getRootNode&&this.viewport_.getRootNode().contains(t))){e.frameState=this.frameState_;var r=this.getInteractions().getArray();if(!1!==this.dispatchEvent(e))for(var i=r.length-1;i>=0;i--){var n=r[i];if(n.getActive())if(!n.handleEvent(e))break}}}},t.prototype.handlePostRender=function(){var e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){var r=this.maxTilesLoading_,i=r;if(e){var n=e.viewHints;if(n[qa.ANIMATING]||n[qa.INTERACTING]){var o=!$j&&Date.now()-e.time>8;r=o?0:8,i=o?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,i))}!e||!this.hasListener(Wb.RENDERCOMPLETE)||e.animate||this.tileQueue_.getTilesLoading()||this.getLoading()||this.renderer_.dispatchRenderEvent(Wb.RENDERCOMPLETE,e);for(var a=this.postRenderFunctions_,s=0,p=a.length;s<p;++s)a[s](this,e);a.length=0},t.prototype.handleSizeChanged_=function(){this.getView()&&this.getView().resolveConstraints(0),this.render()},t.prototype.handleTargetChanged_=function(){var e;if(this.getTarget()&&(e=this.getTargetElement()),this.keyHandlerKeys_){for(var t=0,r=this.keyHandlerKeys_.length;t<r;++t)ra(this.keyHandlerKeys_[t]);this.keyHandlerKeys_=null}if(e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer());var i=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.keyHandlerKeys_=[fa(i,ca.KEYDOWN,this.handleBrowserEvent,this),fa(i,ca.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(ca.RESIZE,this.handleResize_,!1))}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),ve(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(ca.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},t.prototype.handleTileChange_=function(){this.render()},t.prototype.handleViewPropertyChanged_=function(){this.render()},t.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(ra(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(ra(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var e=this.getView();e&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=fa(e,Tb.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=fa(e,ca.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()},t.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(ra),this.layerGroupPropertyListenerKeys_=null);var e=this.getLayerGroup();e&&(this.layerGroupPropertyListenerKeys_=[fa(e,Tb.PROPERTYCHANGE,this.render,this),fa(e,ca.CHANGE,this.render,this)]),this.render()},t.prototype.isRendered=function(){return!!this.frameState_},t.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},t.prototype.redrawText=function(){for(var e=this.getLayerGroup().getLayerStatesArray(),t=0,r=e.length;t<r;++t){var i=e[t].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}},t.prototype.render=function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},t.prototype.removeControl=function(e){return this.getControls().remove(e)},t.prototype.removeInteraction=function(e){return this.getInteractions().remove(e)},t.prototype.removeLayer=function(e){return this.getLayerGroup().getLayers().remove(e)},t.prototype.removeOverlay=function(e){return this.getOverlays().remove(e)},t.prototype.renderFrame_=function(e){var t=this.getSize(),r=this.getView(),i=this.frameState_,n=null;if(void 0!==t&&up(t)&&r&&r.isDef()){var o=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=r.getState();n={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterItems:i?i.declutterItems:[],extent:Wc(a.center,a.resolution,a.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{}}}if(this.frameState_=n,this.renderer_.renderFrame(n),n){if(n.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,n.postRenderFunctions),i)(!this.previousExtent_||!wc(this.previousExtent_)&&!eb(n.extent,this.previousExtent_))&&(this.dispatchEvent(new Fd(fd.MOVESTART,this,i)),this.previousExtent_=Uc(this.previousExtent_));this.previousExtent_&&!n.viewHints[qa.ANIMATING]&&!n.viewHints[qa.INTERACTING]&&!eb(n.extent,this.previousExtent_)&&(this.dispatchEvent(new Fd(fd.MOVEEND,this,n)),Mj(n.extent,this.previousExtent_))}this.dispatchEvent(new Fd(fd.POSTRENDER,this,n)),this.postRenderTimeoutHandle_=setTimeout(this.handlePostRender.bind(this),0)},t.prototype.setLayerGroup=function(e){this.set(Na.LAYERGROUP,e)},t.prototype.setSize=function(e){this.set(Na.SIZE,e)},t.prototype.setTarget=function(e){this.set(Na.TARGET,e)},t.prototype.setView=function(e){this.set(Na.VIEW,e)},t.prototype.updateSize=function(){var e=this.getTargetElement();if(e){var t=getComputedStyle(e);this.setSize([e.offsetWidth-parseFloat(t.borderLeftWidth)-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)-parseFloat(t.borderRightWidth),e.offsetHeight-parseFloat(t.borderTopWidth)-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom)-parseFloat(t.borderBottomWidth)])}else this.setSize(void 0);this.updateViewportSize_()},t.prototype.updateViewportSize_=function(){var e=this.getView();if(e){var t=void 0,r=getComputedStyle(this.viewport_);r.width&&r.height&&(t=[parseInt(r.width,10),parseInt(r.height,10)]),e.setViewportSize(t)}},t}(Ta);function wp(e){var t=null;void 0!==e.keyboardEventTarget&&(t="string"==typeof e.keyboardEventTarget?document.getElementById(e.keyboardEventTarget):e.keyboardEventTarget);var r,i,n,o={},a=e.layers&&"function"==typeof e.layers.getLayers?e.layers:new Vk({layers:e.layers});return o[Na.LAYERGROUP]=a,o[Na.TARGET]=e.target,o[Na.VIEW]=void 0!==e.view?e.view:new qh,void 0!==e.controls&&(Array.isArray(e.controls)?r=new Ja(e.controls.slice()):(ea("function"==typeof e.controls.getArray,47),r=e.controls)),void 0!==e.interactions&&(Array.isArray(e.interactions)?i=new Ja(e.interactions.slice()):(ea("function"==typeof e.interactions.getArray,48),i=e.interactions)),void 0!==e.overlays?Array.isArray(e.overlays)?n=new Ja(e.overlays.slice()):(ea("function"==typeof e.overlays.getArray,49),n=e.overlays):n=new Ja,{controls:r,interactions:i,keyboardEventTarget:t,overlays:n,values:o}}Rg.default=Ye;function Xk(o){var r=o||{},t=new Ja;return(void 0===r.zoom||r.zoom)&&t.push(new al(r.zoomOptions)),(void 0===r.rotate||r.rotate)&&t.push(new $k(r.rotateOptions)),(void 0===r.attribution||r.attribution)&&t.push(new Yk(r.attributionOptions)),t}var Ze={};var uh={};var xp=uh&&uh.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),_a=function(e){function t(t){var r=e.call(this)||this;return r.element=t.element?t.element:null,r.target_=null,r.map_=null,r.listenerKeys=[],r.render_=t.render?t.render:tb,t.target&&r.setTarget(t.target),r}return xp(t,e),t.prototype.disposeInternal=function(){ve(this.element),e.prototype.disposeInternal.call(this)},t.prototype.getMap=function(){return this.map_},t.prototype.setMap=function(e){this.map_&&ve(this.element);for(var t=0,r=this.listenerKeys.length;t<r;++t)ra(this.listenerKeys[t]);(this.listenerKeys.length=0,this.map_=e,this.map_)&&((this.target_?this.target_:e.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==tb&&this.listenerKeys.push(fa(e,fd.POSTRENDER,this.render,this)),e.render())},t.prototype.render=function(e){this.render_.call(this,e)},t.prototype.setTarget=function(e){this.target_="string"==typeof e?document.getElementById(e):e},t}(Ta);uh.default=_a;var yp=Ze&&Ze.__extends||function(){var e=function(t,l){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var l in t)t.hasOwnProperty(l)&&(e[l]=t[l])})(t,l)};return function(t,l){function r(){this.constructor=t}e(t,l),t.prototype=null===l?Object.create(l):(r.prototype=l.prototype,new r)}}(),Yk=function(e){function t(t){var l=this,r=t||{};(l=e.call(this,{element:document.createElement("div"),render:r.render||Zk,target:r.target})||this).ulElement_=document.createElement("ul"),l.collapsed_=void 0===r.collapsed||r.collapsed,l.overrideCollapsible_=void 0!==r.collapsible,l.collapsible_=void 0===r.collapsible||r.collapsible,l.collapsible_||(l.collapsed_=!1);var o=void 0!==r.className?r.className:"ol-attribution",i=void 0!==r.tipLabel?r.tipLabel:"Attributions",a=void 0!==r.collapseLabel?r.collapseLabel:"\xBB";"string"==typeof a?(l.collapseLabel_=document.createElement("span"),l.collapseLabel_.textContent=a):l.collapseLabel_=a;var s=void 0!==r.label?r.label:"i";"string"==typeof s?(l.label_=document.createElement("span"),l.label_.textContent=s):l.label_=s;var n=l.collapsible_&&!l.collapsed_?l.collapseLabel_:l.label_,p=document.createElement("button");p.setAttribute("type","button"),p.title=i,p.appendChild(n),p.addEventListener(ca.CLICK,l.handleClick_.bind(l),!1);var c=o+" "+wb+" "+zc+(l.collapsed_&&l.collapsible_?" "+ze:"")+(l.collapsible_?"":" ol-uncollapsible"),d=l.element;return d.className=c,d.appendChild(l.ulElement_),d.appendChild(p),l.renderedAttributions_=[],l.renderedVisible_=!0,l}return yp(t,e),t.prototype.collectSourceAttributions_=function(e){for(var t={},l=[],r=e.layerStatesArray,o=0,i=r.length;o<i;++o){var a=r[o];if(rd(a,e.viewState)){var s=a.layer.getSource();if(s){var n=s.getAttributions();if(n){var p=n(e);if(p)if(this.overrideCollapsible_||!1!==s.getAttributionsCollapsible()||this.setCollapsible(!1),Array.isArray(p))for(var c=0,d=p.length;c<d;++c)p[c]in t||(l.push(p[c]),t[p[c]]=!0);else p in t||(l.push(p),t[p]=!0)}}}}return l},t.prototype.updateElement_=function(e){if(e){var t=this.collectSourceAttributions_(e),l=t.length>0;if(this.renderedVisible_!=l&&(this.element.style.display=l?"":"none",this.renderedVisible_=l),!Vb(t,this.renderedAttributions_)){Zj(this.ulElement_);for(var r=0,o=t.length;r<o;++r){var i=document.createElement("li");i.innerHTML=t[r],this.ulElement_.appendChild(i)}this.renderedAttributions_=t}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},t.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_()},t.prototype.handleToggle_=function(){this.element.classList.toggle(ze),this.collapsed_?_c(this.collapseLabel_,this.label_):_c(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},t.prototype.getCollapsible=function(){return this.collapsible_},t.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())},t.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()},t.prototype.getCollapsed=function(){return this.collapsed_},t}(_a);function Zk(e){this.updateElement_(e.frameState)}Ze.render=Zk,Ze.default=Yk;var _e={};var zp=_e&&_e.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),$k=function(t){function e(e){var r=this,o=e||{};r=t.call(this,{element:document.createElement("div"),render:o.render||_k,target:o.target})||this;var s=void 0!==o.className?o.className:"ol-rotate",a=void 0!==o.label?o.label:"\u21E7";r.label_=null,"string"==typeof a?(r.label_=document.createElement("span"),r.label_.className="ol-compass",r.label_.textContent=a):(r.label_=a,r.label_.classList.add("ol-compass"));var i=o.tipLabel?o.tipLabel:"Reset rotation",n=document.createElement("button");n.className=s+"-reset",n.setAttribute("type","button"),n.title=i,n.appendChild(r.label_),n.addEventListener(ca.CLICK,r.handleClick_.bind(r),!1);var l=s+" "+wb+" "+zc,$=r.element;return $.className=l,$.appendChild(n),r.callResetNorth_=o.resetNorth?o.resetNorth:void 0,r.duration_=void 0!==o.duration?o.duration:250,r.autoHide_=void 0===o.autoHide||o.autoHide,r.rotation_=void 0,r.autoHide_&&r.element.classList.add(ye),r}return zp(e,t),e.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap().getView();if(t){var e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:$b}):t.setRotation(0))}},e}(_a);function _k(t){var e=t.frameState;if(e){var r=e.viewState.rotation;if(r!=this.rotation_){var o="rotate("+r+"rad)";if(this.autoHide_){var s=this.element.classList.contains(ye);s||0!==r?s&&0!==r&&this.element.classList.remove(ye):this.element.classList.add(ye)}this.label_.style.transform=o}this.rotation_=r}}_e.render=_k,_e.default=$k;var vh={};var Ap=vh&&vh.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),al=function(t){function e(e){var o=this,n=e||{};o=t.call(this,{element:document.createElement("div"),target:n.target})||this;var r=void 0!==n.className?n.className:"ol-zoom",a=void 0!==n.delta?n.delta:1,i=void 0!==n.zoomInLabel?n.zoomInLabel:"+",p=void 0!==n.zoomOutLabel?n.zoomOutLabel:"\u2212",l=void 0!==n.zoomInTipLabel?n.zoomInTipLabel:"Zoom in",d=void 0!==n.zoomOutTipLabel?n.zoomOutTipLabel:"Zoom out",s=document.createElement("button");s.className=r+"-in",s.setAttribute("type","button"),s.title=l,s.appendChild("string"==typeof i?document.createTextNode(i):i),s.addEventListener(ca.CLICK,o.handleClick_.bind(o,a),!1);var u=document.createElement("button");u.className=r+"-out",u.setAttribute("type","button"),u.title=d,u.appendChild("string"==typeof p?document.createTextNode(p):p),u.addEventListener(ca.CLICK,o.handleClick_.bind(o,-a),!1);var c=r+" "+wb+" "+zc,$=o.element;return $.className=c,$.appendChild(s),$.appendChild(u),o.duration_=void 0!==n.duration?n.duration:250,o}return Ap(e,t),e.prototype.handleClick_=function(t,e){e.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var e=this.getMap().getView();if(e){var o=e.getZoom();if(void 0!==o){var n=e.getConstrainedZoom(o+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:n,duration:this.duration_,easing:$b})):e.setZoom(n)}}},e}(_a);vh.default=al;var wh={};var Bp=wh&&wh.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function l(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(l.prototype=r.prototype,new l)}}(),bl=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"],cl={ENTERFULLSCREEN:"enterfullscreen",LEAVEFULLSCREEN:"leavefullscreen"},dl=function(e){function t(t){var r=this,l=t||{};(r=e.call(this,{element:document.createElement("div"),target:l.target})||this).cssClassName_=void 0!==l.className?l.className:"ol-full-screen";var s=void 0!==l.label?l.label:"\u2922";r.labelNode_="string"==typeof s?document.createTextNode(s):s;var n=void 0!==l.labelActive?l.labelActive:"\xD7";r.labelActiveNode_="string"==typeof n?document.createTextNode(n):n,r.button_=document.createElement("button");var o=l.tipLabel?l.tipLabel:"Toggle full-screen";r.setClassName_(r.button_,xh()),r.button_.setAttribute("type","button"),r.button_.title=o,r.button_.appendChild(r.labelNode_),r.button_.addEventListener(ca.CLICK,r.handleClick_.bind(r),!1);var u=r.cssClassName_+" "+wb+" "+zc+" "+(el()?"":xo),c=r.element;return c.className=u,c.appendChild(r.button_),r.keys_=void 0!==l.keys&&l.keys,r.source_=l.source,r}return Bp(t,e),t.prototype.handleClick_=function(e){e.preventDefault(),this.handleFullScreen_()},t.prototype.handleFullScreen_=function(){if(el()){var e=this.getMap();if(e)if(xh())Dp();else{var t=void 0;t=this.source_?"string"==typeof this.source_?document.getElementById(this.source_):this.source_:e.getTargetElement(),this.keys_?Cp(t):fl(t)}}},t.prototype.handleFullScreenChange_=function(){var e=this.getMap();xh()?(this.setClassName_(this.button_,!0),_c(this.labelActiveNode_,this.labelNode_),this.dispatchEvent(cl.ENTERFULLSCREEN)):(this.setClassName_(this.button_,!1),_c(this.labelNode_,this.labelActiveNode_),this.dispatchEvent(cl.LEAVEFULLSCREEN)),e&&e.updateSize()},t.prototype.setClassName_=function(e,t){var r=this.cssClassName_+"-true",l=this.cssClassName_+"-false",s=t?r:l;e.classList.remove(r),e.classList.remove(l),e.classList.add(s)},t.prototype.setMap=function(t){if(e.prototype.setMap.call(this,t),t)for(var r=0,l=bl.length;r<l;++r)this.listenerKeys.push(fa(document,bl[r],this.handleFullScreenChange_,this))},t}(_a);function el(){var e=document.body;return!!(e.webkitRequestFullscreen||e.msRequestFullscreen&&document.msFullscreenEnabled||e.requestFullscreen&&document.fullscreenEnabled)}function xh(){return!!(document.webkitIsFullScreen||document.msFullscreenElement||document.fullscreenElement)}function fl(e){e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}function Cp(e){e.webkitRequestFullscreen?e.webkitRequestFullscreen():fl(e)}function Dp(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}wh.default=dl;var af={};var Ep=af&&af.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),yh="projection",gl="coordinateFormat",Fp=function(t){function e(e){var r=this,o=e||{},n=document.createElement("div");return n.className=void 0!==o.className?o.className:"ol-mouse-position",(r=t.call(this,{element:n,render:o.render||hl,target:o.target})||this).addEventListener(xa(yh),r.handleProjectionChanged_),o.coordinateFormat&&r.setCoordinateFormat(o.coordinateFormat),o.projection&&r.setProjection(o.projection),r.undefinedHTML_=void 0!==o.undefinedHTML?o.undefinedHTML:"&#160;",r.renderOnMouseOut_=!!r.undefinedHTML_,r.renderedHTML_=n.innerHTML,r.mapProjection_=null,r.transform_=null,r}return Ep(e,t),e.prototype.handleProjectionChanged_=function(){this.transform_=null},e.prototype.getCoordinateFormat=function(){return this.get(gl)},e.prototype.getProjection=function(){return this.get(yh)},e.prototype.handleMouseMove=function(t){var e=this.getMap();this.updateHTML_(e.getEventPixel(t))},e.prototype.handleMouseOut=function(t){this.updateHTML_(null)},e.prototype.setMap=function(e){if(t.prototype.setMap.call(this,e),e){var r=e.getViewport();this.listenerKeys.push(fa(r,Jb.POINTERMOVE,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push(fa(r,Jb.POINTEROUT,this.handleMouseOut,this))}},e.prototype.setCoordinateFormat=function(t){this.set(gl,t)},e.prototype.setProjection=function(t){this.set(yh,pa(t))},e.prototype.updateHTML_=function(t){var e=this.undefinedHTML_;if(t&&this.mapProjection_){if(!this.transform_){var r=this.getProjection();this.transform_=r?mb(this.mapProjection_,r):ug}var o=this.getMap().getCoordinateFromPixelInternal(t);if(o){var n=Ra();n&&(this.transform_=mb(this.mapProjection_,n)),this.transform_(o,o);var i=this.getCoordinateFormat();e=i?i(o):o.toString()}}this.renderedHTML_&&e===this.renderedHTML_||(this.element.innerHTML=e,this.renderedHTML_=e)},e}(_a);function hl(t){var e=t.frameState;e?this.mapProjection_!=e.viewState.projection&&(this.mapProjection_=e.viewState.projection,this.transform_=null):this.mapProjection_=null}af.render=hl,af.default=Fp;var bf={};var zh={};var Ah={};var Gp=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,Hp=/^([a-z]*)$|^hsla?\(.*\)$/i;function Ip(r){return"string"==typeof r?r:kl(r)}function Jp(r){var e=document.createElement("div");if(e.style.color=r,""!==e.style.color){document.body.appendChild(e);var $=getComputedStyle(e).color;return document.body.removeChild(e),$}return""}var Kp=function(){var r={},e=0;return function($){var t;if(r.hasOwnProperty($))t=r[$];else{if(e>=1024){var o=0;for(var a in r)0==(3&o++)&&(delete r[a],--e)}t=Lp($),r[$]=t,++e}return t}}();function il(r){return Array.isArray(r)?r:Kp(r)}function Lp(r){var e,$,t,o,a;if(Hp.exec(r)&&(r=Jp(r)),Gp.exec(r)){var u=r.length-1,n=void 0;n=u<=4?1:2;var c=4===u||8===u;e=parseInt(r.substr(1+0*n,n),16),$=parseInt(r.substr(1+1*n,n),16),t=parseInt(r.substr(1+2*n,n),16),o=c?parseInt(r.substr(1+3*n,n),16):255,1==n&&(e=(e<<4)+e,$=($<<4)+$,t=(t<<4)+t,c&&(o=(o<<4)+o)),a=[e,$,t,o/255]}else 0==r.indexOf("rgba(")?jl(a=r.slice(5,-1).split(",").map(Number)):0==r.indexOf("rgb(")?((a=r.slice(4,-1).split(",").map(Number)).push(1),jl(a)):ea(!1,14);return a}function jl(r){return r[0]=ja(r[0]+.5|0,0,255),r[1]=ja(r[1]+.5|0,0,255),r[2]=ja(r[2]+.5|0,0,255),r[3]=ja(r[3],0,1),r}function kl(r){var e=r[0];e!=(0|e)&&(e=e+.5|0);var $=r[1];$!=(0|$)&&($=$+.5|0);var t=r[2];return t!=(0|t)&&(t=t+.5|0),"rgba("+e+","+$+","+t+","+(void 0===r[3]?1:r[3])+")"}var Mp=function(){function e(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return e.prototype.clear=function(){this.cache_={},this.cacheSize_=0},e.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},e.prototype.expire=function(){if(this.canExpireCache()){var e=0;for(var t in this.cache_){var r=this.cache_[t];0!=(3&e++)||r.hasListener()||(delete this.cache_[t],--this.cacheSize_)}}},e.prototype.get=function(e,t,r){var i=ll(e,t,r);return i in this.cache_?this.cache_[i]:null},e.prototype.set=function(e,t,r,i){var o=ll(e,t,r);this.cache_[o]=i,++this.cacheSize_},e.prototype.setSize=function(e){this.maxCacheSize_=e,this.expire()},e}();function ll(e,t,r){return t+":"+e+":"+(r?Ip(r):"null")}var cf=new Mp;function Np(e){var r,t=e.frameState,$=bd(e.inversePixelTransform.slice(),t.coordinateToPixelTransform),o=Dh(t.viewState.resolution,t.pixelRatio),i=Ra();return i&&(r=mb(i,t.viewState.projection)),new Ch(e.context,t.pixelRatio,t.extent,$,t.viewState.rotation,o,r)}function ml(e,r){r&&r.clear();for(var t=e.declutterItems,$=t.length-1;$>=0;--$)for(var o=t[$],i=o.items,n=0,a=i.length;n<a;n+=3)r=i[n].renderDeclutter(i[n+1],i[n+2],o.opacity,r);return t.length=0,r}var Bh={};function yb(r){return Array.isArray(r)?kl(r):r}var nl=function(){function t(){}return t.prototype.drawCustom=function(t,o,e){},t.prototype.drawGeometry=function(t){},t.prototype.setStyle=function(t){},t.prototype.drawCircle=function(t,o){},t.prototype.drawFeature=function(t,o){},t.prototype.drawGeometryCollection=function(t,o){},t.prototype.drawLineString=function(t,o){},t.prototype.drawMultiLineString=function(t,o){},t.prototype.drawMultiPoint=function(t,o){},t.prototype.drawMultiPolygon=function(t,o){},t.prototype.drawPoint=function(t,o){},t.prototype.drawPolygon=function(t,o){},t.prototype.drawText=function(t,o){},t.prototype.setFillStrokeStyle=function(t,o){},t.prototype.setImageStyle=function(t,o){},t.prototype.setTextStyle=function(t,o){},t}();var Op=Bh&&Bh.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),Ch=function(t){function e(e,i,o,r,s,a,n){var l=t.call(this)||this;return l.context_=e,l.pixelRatio_=i,l.extent_=o,l.transform_=r,l.viewRotation_=s,l.squaredTolerance_=a,l.userTransform_=n,l.contextFillState_=null,l.contextStrokeState_=null,l.contextTextState_=null,l.fillState_=null,l.strokeState_=null,l.image_=null,l.imageAnchorX_=0,l.imageAnchorY_=0,l.imageHeight_=0,l.imageOpacity_=0,l.imageOriginX_=0,l.imageOriginY_=0,l.imageRotateWithView_=!1,l.imageRotation_=0,l.imageScale_=0,l.imageWidth_=0,l.text_="",l.textOffsetX_=0,l.textOffsetY_=0,l.textRotateWithView_=!1,l.textRotation_=0,l.textScale_=0,l.textFillState_=null,l.textStrokeState_=null,l.textState_=null,l.pixelCoordinates_=[],l.tmpLocalTransform_=Fa(),l}return Op(e,t),e.prototype.drawImages_=function(t,e,i,o){if(this.image_){var r=Dc(t,e,i,2,this.transform_,this.pixelCoordinates_),s=this.context_,a=this.tmpLocalTransform_,n=s.globalAlpha;1!=this.imageOpacity_&&(s.globalAlpha=n*this.imageOpacity_);var l=this.imageRotation_;this.imageRotateWithView_&&(l+=this.viewRotation_);for(var h=0,f=r.length;h<f;h+=2){var _=r[h]-this.imageAnchorX_,m=r[h+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_){var p=_+this.imageAnchorX_,g=m+this.imageAnchorY_;Ya(a,p,g,this.imageScale_,this.imageScale_,l,-p,-g),s.setTransform.apply(s,a)}s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,_,m,this.imageWidth_,this.imageHeight_)}0===l&&1==this.imageScale_||s.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(s.globalAlpha=n)}},e.prototype.drawText_=function(t,e,i,o){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var r=Dc(t,e,i,o,this.transform_,this.pixelCoordinates_),s=this.context_,a=this.textRotation_;for(this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=o){var n=r[e]+this.textOffsetX_,l=r[e+1]+this.textOffsetY_;if(0!==a||1!=this.textScale_){var h=Ya(this.tmpLocalTransform_,n,l,this.textScale_,this.textScale_,a,-n,-l);s.setTransform.apply(s,h)}this.textStrokeState_&&s.strokeText(this.text_,n,l),this.textFillState_&&s.fillText(this.text_,n,l)}0===a&&1==this.textScale_||s.setTransform(1,0,0,1,0,0)}},e.prototype.moveToLineTo_=function(t,e,i,o,r){var s=this.context_,a=Dc(t,e,i,o,this.transform_,this.pixelCoordinates_);s.moveTo(a[0],a[1]);var n=a.length;r&&(n-=2);for(var l=2;l<n;l+=2)s.lineTo(a[l],a[l+1]);return r&&s.closePath(),i},e.prototype.drawRings_=function(t,e,i,o){for(var r=0,s=i.length;r<s;++r)e=this.moveToLineTo_(t,e,i[r],o,!0);return e},e.prototype.drawCircle=function(t){if(ya(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=Dk(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],o=e[3]-e[1],r=Math.sqrt(i*i+o*o),s=this.context_;s.beginPath(),s.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&s.fill(),this.strokeState_&&s.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.setTransform=function(t){this.transform_=t},e.prototype.drawGeometry=function(t){switch(t.getType()){case aa.POINT:this.drawPoint(t);break;case aa.LINE_STRING:this.drawLineString(t);break;case aa.POLYGON:this.drawPolygon(t);break;case aa.MULTI_POINT:this.drawMultiPoint(t);break;case aa.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case aa.MULTI_POLYGON:this.drawMultiPolygon(t);break;case aa.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case aa.CIRCLE:this.drawCircle(t);}},e.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&ya(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t){for(var e=t.getGeometriesArray(),i=0,o=e.length;i<o;++i)this.drawGeometry(e[i])},e.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawLineString=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),ya(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var o=t.getFlatMidpoint();this.drawText_(o,0,2,2)}}},e.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getExtent();if(ya(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,o=t.getFlatCoordinates(),r=0,s=t.getEnds(),a=t.getStride();i.beginPath();for(var n=0,l=s.length;n<l;++n)r=this.moveToLineTo_(o,r,s[n],a,!1);i.stroke()}if(""!==this.text_){var h=t.getFlatMidpoints();this.drawText_(h,0,h.length,2)}}},e.prototype.drawPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),ya(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),ya(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getOrientedFlatCoordinates(),o=0,r=t.getEndss(),s=t.getStride();e.beginPath();for(var a=0,n=r.length;a<n;++a){var l=r[a];o=this.drawRings_(i,o,l,s)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var h=t.getFlatInteriorPoints();this.drawText_(h,0,h.length,2)}}},e.prototype.setContextFillState_=function(t){var e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),e.setLineDash&&(Vb(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var e=this.context_,i=this.contextTextState_,o=t.textAlign?t.textAlign:Bd;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=o&&(i.textAlign=o,e.textAlign=o),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=o,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:o,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,e){if(t){var i=t.getColor();this.fillState_={fillStyle:yb(i||Gb)}}else this.fillState_=null;if(e){var o=e.getColor(),r=e.getLineCap(),s=e.getLineDash(),a=e.getLineDashOffset(),n=e.getLineJoin(),l=e.getWidth(),h=e.getMiterLimit();this.strokeState_={lineCap:void 0!==r?r:cd,lineDash:s||Be,lineDashOffset:a||Ce,lineJoin:void 0!==n?n:dd,lineWidth:this.pixelRatio_*(void 0!==l?l:Cd),miterLimit:void 0!==h?h:zd,strokeStyle:yb(o||Ad)}}else this.strokeState_=null},e.prototype.setImageStyle=function(t){if(t){var e=t.getAnchor(),i=t.getImage(1),o=t.getOrigin(),r=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=r[1],this.image_=i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=o[0],this.imageOriginY_=o[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageWidth_=r[0]}else this.image_=null},e.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var i=e.getColor();this.textFillState_={fillStyle:yb(i||Gb)}}else this.textFillState_=null;var o=t.getStroke();if(o){var r=o.getColor(),s=o.getLineCap(),a=o.getLineDash(),n=o.getLineDashOffset(),l=o.getLineJoin(),h=o.getWidth(),f=o.getMiterLimit();this.textStrokeState_={lineCap:void 0!==s?s:cd,lineDash:a||Be,lineDashOffset:n||Ce,lineJoin:void 0!==l?l:dd,lineWidth:void 0!==h?h:Cd,miterLimit:void 0!==f?f:zd,strokeStyle:yb(r||Ad)}}else this.textStrokeState_=null;var _=t.getFont(),m=t.getOffsetX(),p=t.getOffsetY(),g=t.getRotateWithView(),$=t.getRotation(),x=t.getScale(),S=t.getText(),c=t.getTextAlign(),d=t.getTextBaseline();this.textState_={font:void 0!==_?_:ck,textAlign:void 0!==c?c:Bd,textBaseline:void 0!==d?d:De},this.text_=void 0!==S?S:"",this.textOffsetX_=void 0!==m?this.pixelRatio_*m:0,this.textOffsetY_=void 0!==p?this.pixelRatio_*p:0,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0!==$?$:0,this.textScale_=this.pixelRatio_*(void 0!==x?x:1)}else this.text_=""},e}(nl);Bh.default=Ch;var ka={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};var Pp=.5,ol={Point:Xp,LineString:Up,Polygon:Zp,MultiPoint:Yp,MultiLineString:Vp,MultiPolygon:Wp,GeometryCollection:Tp,Circle:Rp};function Qp(e,r){return parseInt(da(e),10)-parseInt(da(r),10)}function Dh(e,r){var t=pl(e,r);return t*t}function pl(e,r){return Pp*e/r}function Rp(e,r,t,a){var $=t.getFill(),i=t.getStroke();if($||i){var n=e.getBuilder(t.getZIndex(),ka.CIRCLE);n.setFillStrokeStyle($,i),n.drawCircle(r,a)}var o=t.getText();if(o){var l=e.getBuilder(t.getZIndex(),ka.TEXT);l.setTextStyle(o,e.addDeclutter(!1)),l.drawText(r,a)}}function df(e,r,t,a,$,i){var n=!1,o=t.getImage();if(o){var l=o.getImageState();l==ia.LOADED||l==ia.ERROR?o.unlistenImageChange($):(l==ia.IDLE&&o.load(),l=o.getImageState(),o.listenImageChange($),n=!0)}return Sp(e,r,t,a,i),n}function Sp(e,r,t,a,$){var i=t.getGeometryFunction()(r);if(i){var n=i.simplifyTransformed(a,$);if(t.getRenderer())ql(e,n,t,r);else(0,ol[n.getType()])(e,n,t,r)}}function ql(e,r,t,a){if(r.getType()!=aa.GEOMETRY_COLLECTION)e.getBuilder(t.getZIndex(),ka.DEFAULT).drawCustom(r,a,t.getRenderer());else for(var $=r.getGeometries(),i=0,n=$.length;i<n;++i)ql(e,$[i],t,a)}function Tp(e,r,t,a){var $,i,n=r.getGeometriesArray();for($=0,i=n.length;$<i;++$){(0,ol[n[$].getType()])(e,n[$],t,a)}}function Up(e,r,t,a){var $=t.getStroke();if($){var i=e.getBuilder(t.getZIndex(),ka.LINE_STRING);i.setFillStrokeStyle(null,$),i.drawLineString(r,a)}var n=t.getText();if(n){var o=e.getBuilder(t.getZIndex(),ka.TEXT);o.setTextStyle(n,e.addDeclutter(!1)),o.drawText(r,a)}}function Vp(e,r,t,a){var $=t.getStroke();if($){var i=e.getBuilder(t.getZIndex(),ka.LINE_STRING);i.setFillStrokeStyle(null,$),i.drawMultiLineString(r,a)}var n=t.getText();if(n){var o=e.getBuilder(t.getZIndex(),ka.TEXT);o.setTextStyle(n,e.addDeclutter(!1)),o.drawText(r,a)}}function Wp(e,r,t,a){var $=t.getFill(),i=t.getStroke();if(i||$){var n=e.getBuilder(t.getZIndex(),ka.POLYGON);n.setFillStrokeStyle($,i),n.drawMultiPolygon(r,a)}var o=t.getText();if(o){var l=e.getBuilder(t.getZIndex(),ka.TEXT);l.setTextStyle(o,e.addDeclutter(!1)),l.drawText(r,a)}}function Xp(e,r,t,a){var $=t.getImage();if($){if($.getImageState()!=ia.LOADED)return;var i=e.getBuilder(t.getZIndex(),ka.IMAGE);i.setImageStyle($,e.addDeclutter(!1)),i.drawPoint(r,a)}var n=t.getText();if(n){var o=e.getBuilder(t.getZIndex(),ka.TEXT);o.setTextStyle(n,e.addDeclutter(!!$)),o.drawText(r,a)}}function Yp(e,r,t,a){var $=t.getImage();if($){if($.getImageState()!=ia.LOADED)return;var i=e.getBuilder(t.getZIndex(),ka.IMAGE);i.setImageStyle($,e.addDeclutter(!1)),i.drawMultiPoint(r,a)}var n=t.getText();if(n){var o=e.getBuilder(t.getZIndex(),ka.TEXT);o.setTextStyle(n,e.addDeclutter(!!$)),o.drawText(r,a)}}function Zp(e,r,t,a){var $=t.getFill(),i=t.getStroke();if($||i){var n=e.getBuilder(t.getZIndex(),ka.POLYGON);n.setFillStrokeStyle($,i),n.drawPolygon(r,a)}var o=t.getText();if(o){var l=e.getBuilder(t.getZIndex(),ka.TEXT);l.setTextStyle(o,e.addDeclutter(!1)),l.drawText(r,a)}}var $p=Ah&&Ah.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function o(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),rl=function(e){function r(r){var t=e.call(this)||this;return t.map_=r,t.declutterTree_=null,t}return $p(r,e),r.prototype.dispatchRenderEvent=function(e,r){ma()},r.prototype.calculateMatrices2D=function(e){var r=e.viewState,t=e.coordinateToPixelTransform,o=e.pixelToCoordinateTransform;Ya(t,e.size[0]/2,e.size[1]/2,1/r.resolution,-1/r.resolution,-r.rotation,-r.center[0],-r.center[1]),yd(o,t)},r.prototype.forEachFeatureAtCoordinate=function(e,r,t,o,n,a,i,$){var c,p=r.viewState;function u(e,r,t){return n.call(a,r,e?t:null)}var h=p.projection,s=bh(e.slice(),h),l=[[0,0]];if(h.canWrapX()&&o){var f=h.getExtent(),I=la(f);l.push([-I,0],[I,0])}var d,m=r.layerStatesArray,v=m.length;this.declutterTree_&&(d=this.declutterTree_.all().map(function(e){return e.value}));for(var y=[],_=0;_<l.length;_++)for(var x=v-1;x>=0;--x){var g=m[x],j=g.layer;if(j.hasRenderer()&&rd(g,p)&&i.call($,j)){var C=j.getRenderer(),T=j.getSource();if(C&&T){var q=T.getWrapX()?s:e,E=u.bind(null,g.managed);y[0]=q[0]+l[_][0],y[1]=q[1]+l[_][1],c=C.forEachFeatureAtCoordinate(y,r,t,E,d)}if(c)return c}}},r.prototype.forEachLayerAtPixel=function(e,r,t,o,n){return ma()},r.prototype.hasFeatureAtCoordinate=function(e,r,t,o,n,a){return void 0!==this.forEachFeatureAtCoordinate(e,r,t,o,Xa,this,n,a)},r.prototype.getMap=function(){return this.map_},r.prototype.renderFrame=function(e){this.declutterTree_=ml(e,this.declutterTree_)},r.prototype.scheduleExpireIconCache=function(e){cf.canExpireCache()&&e.postRenderFunctions.push(_p)},r}(fe);function _p(e,r){cf.expire()}Ah.default=rl;var aq=zh&&zh.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ef=function(e){function r(r){var t=e.call(this,r)||this;t.fontChangeListenerKey_=fa(Hb,Tb.PROPERTYCHANGE,r.redrawText.bind(r)),t.element_=document.createElement("div");var n=t.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",t.element_.className=wb+" ol-layers";var s=r.getViewport();return s.insertBefore(t.element_,s.firstChild||null),t.children_=[],t.renderedVisible_=!0,t}return aq(r,e),r.prototype.dispatchRenderEvent=function(e,r){var t=this.getMap();if(t.hasListener(e)){var n=new Jg(e,void 0,r);t.dispatchEvent(n)}},r.prototype.disposeInternal=function(){ra(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),e.prototype.disposeInternal.call(this)},r.prototype.renderFrame=function(r){if(r){this.calculateMatrices2D(r),this.dispatchRenderEvent(Wb.PRECOMPOSE,r);var t=r.layerStatesArray.sort(function(e,r){return e.zIndex-r.zIndex}),n=r.viewState;this.children_.length=0;for(var s=null,i=0,a=t.length;i<a;++i){var o=t[i];if(r.layerIndex=i,rd(o,n)&&(o.sourceState==Aa.READY||o.sourceState==Aa.UNDEFINED)){var $=o.layer.render(r,s);$&&$!==s&&(this.children_.push($),s=$)}}e.prototype.renderFrame.call(this,r),ro(this.element_,this.children_),this.dispatchRenderEvent(Wb.POSTCOMPOSE,r),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(r)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)},r.prototype.forEachLayerAtPixel=function(e,r,t,n,s){for(var i=r.viewState,a=r.layerStatesArray,o=a.length-1;o>=0;--o){var $=a[o],l=$.layer;if(l.hasRenderer()&&rd($,i)&&s(l)){var p=l.getRenderer().getDataAtPixel(e,r,t);if(p){var c=n(l,p);if(c)return c}}}},r}(rl);zh.default=ef;var Eh={};var Va={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"};var bq=Eh&&Eh.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Pa={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},Fh=function(t){function e(e){var i=t.call(this)||this;i.options=e,i.id=e.id,i.insertFirst=void 0===e.insertFirst||e.insertFirst,i.stopEvent=void 0===e.stopEvent||e.stopEvent,i.element=document.createElement("div"),i.element.className=void 0!==e.className?e.className:"ol-overlay-container "+wo,i.element.style.position="absolute";var n=e.autoPan;return n&&"object"!=typeof n&&(n={animation:e.autoPanAnimation,margin:e.autoPanMargin}),i.autoPan=n||!1,i.rendered={transform_:"",visible:!0},i.mapPostrenderListenerKey=null,i.addEventListener(xa(Pa.ELEMENT),i.handleElementChanged),i.addEventListener(xa(Pa.MAP),i.handleMapChanged),i.addEventListener(xa(Pa.OFFSET),i.handleOffsetChanged),i.addEventListener(xa(Pa.POSITION),i.handlePositionChanged),i.addEventListener(xa(Pa.POSITIONING),i.handlePositioningChanged),void 0!==e.element&&i.setElement(e.element),i.setOffset(void 0!==e.offset?e.offset:[0,0]),i.setPositioning(void 0!==e.positioning?e.positioning:Va.TOP_LEFT),void 0!==e.position&&i.setPosition(e.position),i}return bq(e,t),e.prototype.getElement=function(){return this.get(Pa.ELEMENT)},e.prototype.getId=function(){return this.id},e.prototype.getMap=function(){return this.get(Pa.MAP)},e.prototype.getOffset=function(){return this.get(Pa.OFFSET)},e.prototype.getPosition=function(){return this.get(Pa.POSITION)},e.prototype.getPositioning=function(){return this.get(Pa.POSITIONING)},e.prototype.handleElementChanged=function(){Zj(this.element);var t=this.getElement();t&&this.element.appendChild(t)},e.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(ve(this.element),ra(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=fa(t,fd.POSTRENDER,this.render,this),this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}},e.prototype.render=function(){this.updatePixelPosition()},e.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},e.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.performAutoPan()},e.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},e.prototype.setElement=function(t){this.set(Pa.ELEMENT,t)},e.prototype.setMap=function(t){this.set(Pa.MAP,t)},e.prototype.setOffset=function(t){this.set(Pa.OFFSET,t)},e.prototype.setPosition=function(t){this.set(Pa.POSITION,t)},e.prototype.performAutoPan=function(){this.autoPan&&this.panIntoView(this.autoPan)},e.prototype.panIntoView=function(t){var e=this.getMap();if(e&&e.getTargetElement()&&this.get(Pa.POSITION)){var i=this.getRect(e.getTargetElement(),e.getSize()),n=this.getElement(),o=this.getRect(n,[po(n),qo(n)]),r=void 0===t.margin?20:t.margin;if(!La(i,o)){var s=o[0]-i[0],a=i[2]-o[2],p=o[1]-i[1],$=i[3]-o[3],c=[0,0];if(s<0?c[0]=s-r:a<0&&(c[0]=Math.abs(a)+r),p<0?c[1]=p-r:$<0&&(c[1]=Math.abs($)+r),0!==c[0]||0!==c[1]){var l=e.getView().getCenterInternal(),d=e.getPixelFromCoordinateInternal(l),h=[d[0]+c[0],d[1]+c[1]],P=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(h),duration:P.duration,easing:P.easing})}}}},e.prototype.getRect=function(t,e){var i=t.getBoundingClientRect(),n=i.left+window.pageXOffset,o=i.top+window.pageYOffset;return[n,o,n+e[0],o+e[1]]},e.prototype.setPositioning=function(t){this.set(Pa.POSITIONING,t)},e.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},e.prototype.updatePixelPosition=function(){var t=this.getMap(),e=this.getPosition();if(t&&t.isRendered()&&e){var i=t.getPixelFromCoordinate(e),n=t.getSize();this.updateRenderedPosition(i,n)}else this.setVisible(!1)},e.prototype.updateRenderedPosition=function(t,e){var i=this.element.style,n=this.getOffset(),o=this.getPositioning();this.setVisible(!0);var r=Math.round(t[0]+n[0])+"px",s=Math.round(t[1]+n[1])+"px",a="0%",p="0%";o==Va.BOTTOM_RIGHT||o==Va.CENTER_RIGHT||o==Va.TOP_RIGHT?a="-100%":o!=Va.BOTTOM_CENTER&&o!=Va.CENTER_CENTER&&o!=Va.TOP_CENTER||(a="-50%"),o==Va.BOTTOM_LEFT||o==Va.BOTTOM_CENTER||o==Va.BOTTOM_RIGHT?p="-100%":o!=Va.CENTER_LEFT&&o!=Va.CENTER_CENTER&&o!=Va.CENTER_RIGHT||(p="-50%");var $="translate("+a+", "+p+") translate("+r+", "+s+")";this.rendered.transform_!=$&&(this.rendered.transform_=$,i.transform=$,i.msTransform=$)},e.prototype.getOptions=function(){return this.options},e}(Ta);Eh.default=Fh;var sl=bf&&bf.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),ff=.75,Jd=.1,cq=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return sl(t,e),t.prototype.createRenderer=function(){return new ef(this)},t}(Ye),dq=function(e){function t(t){var i=this,o=t||{};(i=e.call(this,{element:document.createElement("div"),render:o.render||tl,target:o.target})||this).boundHandleRotationChanged_=i.handleRotationChanged_.bind(i),i.collapsed_=void 0===o.collapsed||o.collapsed,i.collapsible_=void 0===o.collapsible||o.collapsible,i.collapsible_||(i.collapsed_=!1),i.rotateWithView_=void 0!==o.rotateWithView&&o.rotateWithView,i.viewExtent_=void 0;var r=void 0!==o.className?o.className:"ol-overviewmap",a=void 0!==o.tipLabel?o.tipLabel:"Overview map",n=void 0!==o.collapseLabel?o.collapseLabel:"\xAB";"string"==typeof n?(i.collapseLabel_=document.createElement("span"),i.collapseLabel_.textContent=n):i.collapseLabel_=n;var l=void 0!==o.label?o.label:"\xBB";"string"==typeof l?(i.label_=document.createElement("span"),i.label_.textContent=l):i.label_=l;var p=i.collapsible_&&!i.collapsed_?i.collapseLabel_:i.label_,s=document.createElement("button");s.setAttribute("type","button"),s.title=a,s.appendChild(p),s.addEventListener(ca.CLICK,i.handleClick_.bind(i),!1),i.ovmapDiv_=document.createElement("div"),i.ovmapDiv_.className="ol-overviewmap-map",i.view_=o.view,i.ovmap_=new cq({view:o.view});var h=i.ovmap_;o.layers&&o.layers.forEach(function(e){h.addLayer(e)});var $=document.createElement("div");$.className="ol-overviewmap-box",$.style.boxSizing="border-box",i.boxOverlay_=new Fh({position:[0,0],positioning:Va.CENTER_CENTER,element:$}),i.ovmap_.addOverlay(i.boxOverlay_);var v=r+" "+wb+" "+zc+(i.collapsed_&&i.collapsible_?" "+ze:"")+(i.collapsible_?"":" ol-uncollapsible"),d=i.element;d.className=v,d.appendChild(i.ovmapDiv_),d.appendChild(s);var c=i,_=i.boxOverlay_,u=i.boxOverlay_.getElement(),M=function(e){var t,i={clientX:(t=e).clientX,clientY:t.clientY},o=h.getEventCoordinateInternal(i);_.setPosition(o)},A=function(e){var t=h.getEventCoordinateInternal(e);c.getMap().getView().setCenterInternal(t),window.removeEventListener("mousemove",M),window.removeEventListener("mouseup",A)};return u.addEventListener("mousedown",function(){window.addEventListener("mousemove",M),window.addEventListener("mouseup",A)}),i}return sl(t,e),t.prototype.setMap=function(t){var i=this.getMap();if(t!==i){if(i){var o=i.getView();o&&this.unbindView_(o),this.ovmap_.setTarget(null)}if(e.prototype.setMap.call(this,t),t){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(fa(t,Tb.PROPERTYCHANGE,this.handleMapPropertyChange_,this));var r=t.getView();r&&(this.bindView_(r),r.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_()))}}},t.prototype.handleMapPropertyChange_=function(e){if(e.key===Na.VIEW){var t=e.oldValue;t&&this.unbindView_(t);var i=this.getMap().getView();this.bindView_(i)}},t.prototype.bindView_=function(e){if(!this.view_){var t=new qh({projection:e.getProjection()});this.ovmap_.setView(t)}e.addEventListener(xa(Ca.ROTATION),this.boundHandleRotationChanged_),this.handleRotationChanged_()},t.prototype.unbindView_=function(e){e.removeEventListener(xa(Ca.ROTATION),this.boundHandleRotationChanged_)},t.prototype.handleRotationChanged_=function(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())},t.prototype.validateExtent_=function(){var e=this.getMap(),t=this.ovmap_;if(e.isRendered()&&t.isRendered()){var i=e.getSize(),o=e.getView().calculateExtentInternal(i);if(!this.viewExtent_||!eb(o,this.viewExtent_)){this.viewExtent_=o;var r=t.getSize(),a=t.getView().calculateExtentInternal(r),n=t.getPixelFromCoordinateInternal(fb(o)),l=t.getPixelFromCoordinateInternal(uc(o)),p=Math.abs(n[0]-l[0]),s=Math.abs(n[1]-l[1]),h=r[0],$=r[1];p<h*Jd||s<$*Jd||p>h*ff||s>$*ff?this.resetExtent_():La(a,o)||this.recenter_()}}},t.prototype.resetExtent_=function(){if(0!==ff&&0!==Jd){var e=this.getMap(),t=this.ovmap_,i=e.getSize(),o=e.getView().calculateExtentInternal(i),r=t.getView(),a=Math.log(ff/Jd)/Math.LN2,n=1/(Math.pow(2,a/2)*Jd);td(o,n),r.fitInternal(Lb(o))}},t.prototype.recenter_=function(){var e=this.getMap(),t=this.ovmap_,i=e.getView();t.getView().setCenterInternal(i.getCenterInternal())},t.prototype.updateBox_=function(){var e=this.getMap(),t=this.ovmap_;if(e.isRendered()&&t.isRendered()){var i=e.getSize(),o=e.getView(),r=t.getView(),a=this.rotateWithView_?0:-o.getRotation(),n=this.boxOverlay_,l=this.boxOverlay_.getElement(),p=o.getCenterInternal(),s=o.getResolution(),h=r.getResolution(),$=i[0]*s/h,v=i[1]*s/h;if(n.setPosition(p),l){l.style.width=$+"px",l.style.height=v+"px";var d="rotate("+a+"rad)";l.style.transform=d}}},t.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_()},t.prototype.handleToggle_=function(){this.element.classList.toggle(ze),this.collapsed_?_c(this.collapseLabel_,this.label_):_c(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;var e=this.ovmap_;if(!this.collapsed_){if(e.isRendered())return this.viewExtent_=void 0,void e.render();e.updateSize(),this.resetExtent_(),Qc(e,fd.POSTRENDER,function(e){this.updateBox_()},this)}},t.prototype.getCollapsible=function(){return this.collapsible_},t.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())},t.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()},t.prototype.getCollapsed=function(){return this.collapsed_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.setRotateWithView=function(e){this.rotateWithView_!==e&&(this.rotateWithView_=e,0!==this.getMap().getView().getRotation()&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))},t.prototype.getOverviewMap=function(){return this.ovmap_},t}(_a);function tl(e){this.validateExtent_(),this.updateBox_()}bf.render=tl,bf.default=dq;var Kd={};var eq=Kd&&Kd.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Gh="units",_b={DEGREES:"degrees",IMPERIAL:"imperial",NAUTICAL:"nautical",METRIC:"metric",US:"us"};Kd.Units=_b;var fq=[1,2,5],gq=function(e){function t(t){var r=this,i=t||{},s=void 0!==i.className?i.className:i.bar?"ol-scale-bar":"ol-scale-line";return(r=e.call(this,{element:document.createElement("div"),render:i.render||ul,target:i.target})||this).innerElement_=document.createElement("div"),r.innerElement_.className=s+"-inner",r.element.className=s+" "+wb,r.element.appendChild(r.innerElement_),r.viewState_=null,r.minWidth_=void 0!==i.minWidth?i.minWidth:64,r.renderedVisible_=!1,r.renderedWidth_=void 0,r.renderedHTML_="",r.addEventListener(xa(Gh),r.handleUnitsChanged_),r.setUnits(i.units||_b.METRIC),r.scaleBar_=i.bar||!1,r.scaleBarSteps_=i.steps||4,r.scaleBarText_=i.text||!1,r}return eq(t,e),t.prototype.getUnits=function(){return this.get(Gh)},t.prototype.handleUnitsChanged_=function(){this.updateElement_()},t.prototype.setUnits=function(e){this.set(Gh,e)},t.prototype.updateElement_=function(){var e=this.viewState_;if(e){var t=e.center,r=e.projection,i=this.getUnits(),s=i==_b.DEGREES?Qa.DEGREES:Qa.METERS,n=vg(r,e.resolution,t,s),a=this.minWidth_*n,o="";if(i==_b.DEGREES){var d=ob[Qa.DEGREES];(a*=d)<d/60?(o="\u2033",n*=3600):a<d?(o="\u2032",n*=60):o="\xB0"}else i==_b.IMPERIAL?a<.9144?(o="in",n/=.0254):a<1609.344?(o="ft",n/=.3048):(o="mi",n/=1609.344):i==_b.NAUTICAL?(n/=1852,o="nm"):i==_b.METRIC?a<.001?(o="\u03BCm",n*=1e6):a<1?(o="mm",n*=1e3):a<1e3?o="m":(o="km",n/=1e3):i==_b.US?a<.9144?(o="in",n*=39.37):a<1609.344?(o="ft",n/=.30480061):(o="mi",n/=1609.3472):ea(!1,33);for(var l,$,p,c,h=3*Math.floor(Math.log(this.minWidth_*n)/Math.log(10));;){p=Math.floor(h/3);var _=Math.pow(10,p);if(l=fq[(h%3+3)%3]*_,$=Math.round(l/n),isNaN($))return this.element.style.display="none",void(this.renderedVisible_=!1);if($>=this.minWidth_)break;++h}c=this.scaleBar_?this.createScaleBar($,l,o):l.toFixed(p<0?-p:0)+" "+o,this.renderedHTML_!=c&&(this.innerElement_.innerHTML=c,this.renderedHTML_=c),this.renderedWidth_!=$&&(this.innerElement_.style.width=$+"px",this.renderedWidth_=$),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},t.prototype.createScaleBar=function(e,t,r){for(var i="1 : "+Math.round(this.getScaleForResolution()).toLocaleString(),s=[],n=e/this.scaleBarSteps_,a="#ffffff",o=0;o<this.scaleBarSteps_;o++)0===o&&s.push(this.createMarker("absolute",o)),s.push("<div><div class=\"ol-scale-singlebar\" style=\"width: "+n+"px;background-color: "+a+";\"></div>"+this.createMarker("relative",o)+(o%2==0||2===this.scaleBarSteps_?this.createStepText(o,e,!1,t,r):"")+"</div>"),o===this.scaleBarSteps_-1&&s.push(this.createStepText(o+1,e,!0,t,r)),a="#ffffff"===a?"#000000":"#ffffff";return"<div style=\"display: flex;\">"+(this.scaleBarText_?"<div class=\"ol-scale-text\" style=\"width: "+e+"px;\">"+i+"</div>":"")+s.join("")+"</div>"},t.prototype.createMarker=function(e,t){return"<div class=\"ol-scale-step-marker\" style=\"position: "+e+";top: "+("absolute"===e?3:-10)+"px;\"></div>"},t.prototype.createStepText=function(e,t,r,i,s){var n=(0===e?0:Math.round(i/this.scaleBarSteps_*e*100)/100)+(0===e?"":" "+s);return"<div class=\"ol-scale-step-text\" style=\"margin-left: "+(0===e?-3:t/this.scaleBarSteps_*-1)+"px;text-align: "+(0===e?"left":"center")+"; min-width: "+(0===e?0:t/this.scaleBarSteps_*2)+"px;left: "+(r?t+"px":"unset")+";\">"+n+"</div>"},t.prototype.getScaleForResolution=function(){var e=this.getMap().getView().getResolution(),t=this.viewState_.projection.getMetersPerUnit();return parseFloat(e.toString())*t*39.37*(25.4/.28)},t}(_a);function ul(e){var t=e.frameState;this.viewState_=t?t.viewState:null,this.updateElement_()}Kd.render=ul,Kd.default=gq;var gf={};var hq=gf&&gf.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ld={VERTICAL:0,HORIZONTAL:1},iq=function(t){function e(e){var i=this,r=e||{};(i=t.call(this,{element:document.createElement("div"),render:r.render||vl})||this).dragListenerKeys_=[],i.currentResolution_=void 0,i.direction_=Ld.VERTICAL,i.dragging_,i.heightLimit_=0,i.widthLimit_=0,i.startX_,i.startY_,i.thumbSize_=null,i.sliderInitialized_=!1,i.duration_=void 0!==r.duration?r.duration:200;var n=void 0!==r.className?r.className:"ol-zoomslider",o=document.createElement("button");o.setAttribute("type","button"),o.className=n+"-thumb "+wb;var s=i.element;return s.className=n+" "+wb+" "+zc,s.appendChild(o),s.addEventListener(Jb.POINTERDOWN,i.handleDraggerStart_.bind(i),!1),s.addEventListener(Jb.POINTERMOVE,i.handleDraggerDrag_.bind(i),!1),s.addEventListener(Jb.POINTERUP,i.handleDraggerEnd_.bind(i),!1),s.addEventListener(ca.CLICK,i.handleContainerClick_.bind(i),!1),o.addEventListener(ca.CLICK,Mn,!1),i}return hq(e,t),e.prototype.setMap=function(e){t.prototype.setMap.call(this,e),e&&e.render()},e.prototype.initSlider_=function(){var t=this.element,e=t.offsetWidth,i=t.offsetHeight,r=t.firstElementChild,n=getComputedStyle(r),o=r.offsetWidth+parseFloat(n.marginRight)+parseFloat(n.marginLeft),s=r.offsetHeight+parseFloat(n.marginTop)+parseFloat(n.marginBottom);this.thumbSize_=[o,s],e>i?(this.direction_=Ld.HORIZONTAL,this.widthLimit_=e-o):(this.direction_=Ld.VERTICAL,this.heightLimit_=i-s),this.sliderInitialized_=!0},e.prototype.handleContainerClick_=function(t){var e=this.getMap().getView(),i=this.getRelativePosition_(t.offsetX-this.thumbSize_[0]/2,t.offsetY-this.thumbSize_[1]/2),r=this.getResolutionForPosition_(i),n=e.getConstrainedZoom(e.getZoomForResolution(r));e.animateInternal({zoom:n,duration:this.duration_,easing:$b})},e.prototype.handleDraggerStart_=function(t){if(!this.dragging_&&t.target===this.element.firstElementChild){var e=this.element.firstElementChild;if(this.getMap().getView().beginInteraction(),this.startX_=t.clientX-parseFloat(e.style.left),this.startY_=t.clientY-parseFloat(e.style.top),this.dragging_=!0,0===this.dragListenerKeys_.length){var i=this.handleDraggerDrag_,r=this.handleDraggerEnd_;this.dragListenerKeys_.push(fa(document,Jb.POINTERMOVE,i,this),fa(document,Jb.POINTERUP,r,this))}}},e.prototype.handleDraggerDrag_=function(t){if(this.dragging_){var e=t.clientX-this.startX_,i=t.clientY-this.startY_,r=this.getRelativePosition_(e,i);this.currentResolution_=this.getResolutionForPosition_(r),this.getMap().getView().setResolution(this.currentResolution_)}},e.prototype.handleDraggerEnd_=function(t){this.dragging_&&(this.getMap().getView().endInteraction(),this.dragging_=!1,this.startX_=void 0,this.startY_=void 0,this.dragListenerKeys_.forEach(ra),this.dragListenerKeys_.length=0)},e.prototype.setThumbPosition_=function(t){var e=this.getPositionForResolution_(t),i=this.element.firstElementChild;this.direction_==Ld.HORIZONTAL?i.style.left=this.widthLimit_*e+"px":i.style.top=this.heightLimit_*e+"px"},e.prototype.getRelativePosition_=function(t,e){var i;return i=this.direction_===Ld.HORIZONTAL?t/this.widthLimit_:e/this.heightLimit_,ja(i,0,1)},e.prototype.getResolutionForPosition_=function(t){return this.getMap().getView().getResolutionForValueFunction()(1-t)},e.prototype.getPositionForResolution_=function(t){var e=this.getMap().getView().getValueForResolutionFunction();return ja(1-e(t),0,1)},e}(_a);function vl(t){if(t.frameState){this.sliderInitialized_||this.initSlider_();var e=t.frameState.viewState.resolution;this.currentResolution_=e,this.setThumbPosition_(e)}}gf.render=vl,gf.default=iq;var Hh={};var jq=Hh&&Hh.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),kq=function(t){function e(e){var n=this,o=e||{};(n=t.call(this,{element:document.createElement("div"),target:o.target})||this).extent=o.extent?o.extent:null;var r=void 0!==o.className?o.className:"ol-zoom-extent",i=void 0!==o.label?o.label:"E",a=void 0!==o.tipLabel?o.tipLabel:"Fit to extent",$=document.createElement("button");$.setAttribute("type","button"),$.title=a,$.appendChild("string"==typeof i?document.createTextNode(i):i),$.addEventListener(ca.CLICK,n.handleClick_.bind(n),!1);var l=r+" "+wb+" "+zc,p=n.element;return p.className=l,p.appendChild($),n}return jq(e,t),e.prototype.handleClick_=function(t){t.preventDefault(),this.handleZoomToExtent()},e.prototype.handleZoomToExtent=function(){var t=this.getMap().getView(),e=this.extent?this.extent:t.getProjection().getExtent();t.fitInternal(Lb(e))},e}(_a);Hh.default=kq;function wl(o){var a=o||{},r=new Ja,e=new lq(-.005,.05,100);return(void 0===a.altShiftDragRotate||a.altShiftDragRotate)&&r.push(new Fl),(void 0===a.doubleClickZoom||a.doubleClickZoom)&&r.push(new yl({delta:a.zoomDelta,duration:a.zoomDuration})),(void 0===a.dragPan||a.dragPan)&&r.push(new El({condition:a.onFocusOnly?kf:void 0,kinetic:e})),(void 0===a.pinchRotate||a.pinchRotate)&&r.push(new Nl),(void 0===a.pinchZoom||a.pinchZoom)&&r.push(new Ol({duration:a.zoomDuration})),(void 0===a.keyboard||a.keyboard)&&(r.push(new Kl),r.push(new Ll({delta:a.zoomDelta,duration:a.zoomDuration}))),(void 0===a.mouseWheelZoom||a.mouseWheelZoom)&&r.push(new Ml({condition:a.onFocusOnly?kf:void 0,duration:a.zoomDuration})),(void 0===a.shiftDragZoom||a.shiftDragZoom)&&r.push(new Jl({duration:a.zoomDuration})),r}var lq=function(){function t(t,i,n){this.decay_=t,this.minVelocity_=i,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}return t.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},t.prototype.update=function(t,i){this.points_.push(t,i,Date.now())},t.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,i=this.points_.length-3;if(this.points_[i+2]<t)return!1;for(var n=i-3;n>0&&this.points_[n+2]>t;)n-=3;var e=this.points_[i+2]-this.points_[n+2];if(e<1e3/60)return!1;var s=this.points_[i]-this.points_[n],o=this.points_[i+1]-this.points_[n+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/e,this.initialVelocity_>this.minVelocity_},t.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},t.prototype.getAngle=function(){return this.angle_},t}();var Ih={};var Md={};var hf={ACTIVE:"active"};var mq=Md&&Md.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ac=function(t){function e(e){var r=t.call(this)||this;return e.handleEvent&&(r.handleEvent=e.handleEvent),r.map_=null,r.setActive(!0),r}return mq(e,t),e.prototype.getActive=function(){return this.get(hf.ACTIVE)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(hf.ACTIVE,t)},e.prototype.setMap=function(t){this.map_=t},e}(Ta);function xl(t,e,r){var n=t.getCenterInternal();if(n){var o=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:void 0!==r?r:250,easing:Xo,center:t.getConstrainedCenter(o)})}}function jf(t,e,r,n){var o=t.getZoom();if(void 0!==o){var p=t.getConstrainedZoom(o+e),a=t.getResolutionForZoom(p);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:a,anchor:r,duration:void 0!==n?n:250,easing:$b})}}Md.pan=xl,Md.zoomByDelta=jf,Md.default=ac;var nq=Ih&&Ih.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function a(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}(),yl=function(t){function e(e){var r=t.call(this,{handleEvent:oq})||this,a=e||{};return r.delta_=a.delta?a.delta:1,r.duration_=void 0!==a.duration?a.duration:250,r}return nq(e,t),e}(ac);function oq(t){var e=!1;if(t.type==na.DBLCLICK){var r=t.originalEvent,a=t.map,n=t.coordinate,o=r.shiftKey?-this.delta_:this.delta_,$=a.getView();jf($,o,n,this.duration_),t.preventDefault(),e=!0}return!e}Ih.default=yl;var Jh={};var pq=function(e){var t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey};var qq=function(e){var t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey};var kf=function(e){return e.target.getTargetElement()===document.activeElement};var Kh=Xa;var zl=function(e){var t=e.originalEvent;return 0==t.button&&!(to&&uo&&t.ctrlKey)};var Al=oc;var Bl=function(e){return e.type==na.SINGLECLICK};var Lh=function(e){var t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey};var lf=function(e){var t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey};var Cl=function(e){var t=e.originalEvent.target.tagName;return"INPUT"!==t&&"SELECT"!==t&&"TEXTAREA"!==t};var gd=function(e){var t=e.pointerEvent;return ea(void 0!==t,56),"mouse"==t.pointerType};var Dl=function(e){var t=e.pointerEvent;return ea(void 0!==t,56),t.isPrimary&&0===t.button};var mf={};var rq=mf&&mf.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hb=function(e){function t(t){var n=this,r=t||{};return n=e.call(this,r)||this,r.handleDownEvent&&(n.handleDownEvent=r.handleDownEvent),r.handleDragEvent&&(n.handleDragEvent=r.handleDragEvent),r.handleMoveEvent&&(n.handleMoveEvent=r.handleMoveEvent),r.handleUpEvent&&(n.handleUpEvent=r.handleUpEvent),r.stopDown&&(n.stopDown=r.stopDown),n.handlingDownUpSequence=!1,n.trackedPointers_={},n.targetPointers=[],n}return rq(t,e),t.prototype.getPointerCount=function(){return this.targetPointers.length},t.prototype.handleDownEvent=function(e){return!1},t.prototype.handleDragEvent=function(e){},t.prototype.handleEvent=function(e){if(!e.pointerEvent)return!0;var t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==na.POINTERDRAG)this.handleDragEvent(e);else if(e.type==na.POINTERUP){var n=this.handleUpEvent(e);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(e.type==na.POINTERDOWN){var r=this.handleDownEvent(e);this.handlingDownUpSequence=r,t=this.stopDown(r)}else e.type==na.POINTERMOVE&&this.handleMoveEvent(e);return!t},t.prototype.handleMoveEvent=function(e){},t.prototype.handleUpEvent=function(e){return!1},t.prototype.stopDown=function(e){return e},t.prototype.updateTrackedPointers_=function(e){if(sq(e)){var t=e.pointerEvent,n=t.pointerId.toString();e.type==na.POINTERUP?delete this.trackedPointers_[n]:e.type==na.POINTERDOWN?this.trackedPointers_[n]=t:n in this.trackedPointers_&&(this.trackedPointers_[n]=t),this.targetPointers=gg(this.trackedPointers_)}},t}(ac);function nf(e){for(var t=e.length,n=0,r=0,o=0;o<t;o++)n+=e[o].clientX,r+=e[o].clientY;return[n/t,r/t]}function sq(e){var t=e.type;return t===na.POINTERDOWN||t===na.POINTERDRAG||t===na.POINTERUP}mf.centroid=nf,mf.default=hb;var tq=Jh&&Jh.__extends||function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),El=function(t){function n(n){var e=t.call(this,{stopDown:oc})||this,i=n||{};return e.kinetic_=i.kinetic,e.lastCentroid=null,e.lastPointersCount_,e.panning_=!1,e.condition_=i.condition?i.condition:uq,e.noKinetic_=!1,e}return tq(n,t),n.prototype.conditionInternal_=function(t){var n=!0;return t.map.getTargetElement().hasAttribute("tabindex")&&(n=kf(t)),n&&this.condition_(t)},n.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var n=this.targetPointers,e=nf(n);if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(e[0],e[1]),this.lastCentroid){var i=[this.lastCentroid[0]-e[0],e[1]-this.lastCentroid[1]],r=t.map.getView();vk(i,r.getResolution()),Pe(i,r.getRotation()),r.adjustCenterInternal(i)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=e,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()},n.prototype.handleUpEvent=function(t){var n=t.map,e=n.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var i=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=e.getCenterInternal(),a=n.getPixelFromCoordinateInternal(o),s=n.getCoordinateFromPixelInternal([a[0]-i*Math.cos(r),a[1]-i*Math.sin(r)]);e.animateInternal({center:e.getConstrainedCenter(s),duration:500,easing:$b})}return this.panning_&&(this.panning_=!1,e.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},n.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.conditionInternal_(t)){var n=t.map.getView();return this.lastCentroid=null,n.getAnimating()&&n.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},n}(hb);function uq(t){return Lh(t)&&Dl(t)}Jh.default=El;var Mh={};var vq=Mh&&Mh.__extends||function(){var t=function(n,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])})(n,o)};return function(n,o){function e(){this.constructor=n}t(n,o),n.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}}(),Fl=function(t){function n(n){var o=this,e=n||{};return(o=t.call(this,{stopDown:oc})||this).condition_=e.condition?e.condition:qq,o.lastAngle_=void 0,o.duration_=void 0!==e.duration?e.duration:250,o}return vq(n,t),n.prototype.handleDragEvent=function(t){if(gd(t)){var n=t.map,o=n.getView();if(o.getConstraints().rotation!==Me){var e=n.getSize(),r=t.pixel,i=Math.atan2(e[1]/2-r[1],r[0]-e[0]/2);if(void 0!==this.lastAngle_){var a=i-this.lastAngle_;o.adjustRotationInternal(-a)}this.lastAngle_=i}}},n.prototype.handleUpEvent=function(t){return!gd(t)||(t.map.getView().endInteraction(this.duration_),!1)},n.prototype.handleDownEvent=function(t){return!!gd(t)&&!(!zl(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0)},n}(hb);Mh.default=Fl;var Nh={};var Oh={};var Ph={};var wq=Ph&&Ph.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Gl=function(t){function e(e){var r=t.call(this)||this;return r.geometry_=null,r.element_=document.createElement("div"),r.element_.style.position="absolute",r.element_.className="ol-box "+e,r.map_=null,r.startPixel_=null,r.endPixel_=null,r}return wq(e,t),e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,r=this.element_.style;r.left=Math.min(t[0],e[0])+"px",r.top=Math.min(t[1],e[1])+"px",r.width=Math.abs(e[0]-t[0])+"px",r.height=Math.abs(e[1]-t[1])+"px"},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,r=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new xb([r])},e.prototype.getGeometry=function(){return this.geometry_},e}(fe);Ph.default=Gl;var Hl=Oh&&Oh.__extends||function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),Qh={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend"},Rh=function(t){function n(n,e,o){var r=t.call(this,n)||this;return r.coordinate=e,r.mapBrowserEvent=o,r}return Hl(n,t),n}(Ka),Il=function(t){function n(n){var e=t.call(this)||this,o=n||{};return e.box_=new Gl(o.className||"ol-dragbox"),e.minArea_=void 0!==o.minArea?o.minArea:64,e.onBoxEnd_=o.onBoxEnd?o.onBoxEnd:tb,e.startPixel_=null,e.condition_=o.condition?o.condition:zl,e.boxEndCondition_=o.boxEndCondition?o.boxEndCondition:e.defaultBoxEndCondition,e}return Hl(n,t),n.prototype.defaultBoxEndCondition=function(t,n,e){var o=e[0]-n[0],r=e[1]-n[1];return o*o+r*r>=this.minArea_},n.prototype.getGeometry=function(){return this.box_.getGeometry()},n.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Rh(Qh.BOXDRAG,t.coordinate,t))},n.prototype.handleUpEvent=function(t){return this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd_(t),this.dispatchEvent(new Rh(Qh.BOXEND,t.coordinate,t))),!1},n.prototype.handleDownEvent=function(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Rh(Qh.BOXSTART,t.coordinate,t)),!0)},n}(hb);Oh.default=Il;var xq=Nh&&Nh.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),Jl=function(t){function e(e){var o=this,r=e||{},n=r.condition?r.condition:lf;return(o=t.call(this,{condition:n,className:r.className||"ol-dragzoom",minArea:r.minArea,onBoxEnd:yq})||this).duration_=void 0!==r.duration?r.duration:200,o.out_=void 0!==r.out&&r.out,o}return xq(e,t),e}(Il);function yq(){var t=this.getMap(),e=t.getView(),o=t.getSize(),r=this.getGeometry().getExtent();if(this.out_){var n=e.calculateExtentInternal(o),i=bo([t.getPixelFromCoordinateInternal(Yb(r)),t.getPixelFromCoordinateInternal(vc(r))]),a=e.getResolutionForExtentInternal(i,o);td(n,1/a),r=n}var $=e.getConstrainedResolution(e.getResolutionForExtentInternal(r,o)),p=e.getConstrainedCenter(Ma(r),$);e.animateInternal({resolution:$,center:p,duration:this.duration_,easing:$b})}Nh.default=Jl;var Sh={};var Gc={LEFT:37,UP:38,RIGHT:39,DOWN:40};var zq=Sh&&Sh.__extends||function(){var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(t,e)};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Kl=function(o){function t(t){var e=o.call(this,{handleEvent:Aq})||this,r=t||{};return e.defaultCondition_=function(o){return Lh(o)&&Cl(o)},e.condition_=void 0!==r.condition?r.condition:e.defaultCondition_,e.duration_=void 0!==r.duration?r.duration:100,e.pixelDelta_=void 0!==r.pixelDelta?r.pixelDelta:128,e}return zq(t,o),t}(ac);function Aq(o){var t=!1;if(o.type==ca.KEYDOWN){var e=o.originalEvent.keyCode;if(this.condition_(o)&&(e==Gc.DOWN||e==Gc.LEFT||e==Gc.RIGHT||e==Gc.UP)){var r=o.map.getView(),n=r.getResolution()*this.pixelDelta_,i=0,$=0;e==Gc.DOWN?$=-n:e==Gc.LEFT?i=-n:e==Gc.RIGHT?i=n:$=n;var a=[i,$];Pe(a,r.getRotation()),xl(r,a,this.duration_),o.preventDefault(),t=!0}}return!t}Sh.default=Kl;var Th={};var Bq=Th&&Th.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ll=function(t){function e(e){var r=t.call(this,{handleEvent:Cq})||this,n=e||{};return r.condition_=n.condition?n.condition:Cl,r.delta_=n.delta?n.delta:1,r.duration_=void 0!==n.duration?n.duration:100,r}return Bq(e,t),e}(ac);function Cq(t){var e=!1;if(t.type==ca.KEYDOWN||t.type==ca.KEYPRESS){var r=t.originalEvent.charCode;if(this.condition_(t)&&(r=="+".charCodeAt(0)||r=="-".charCodeAt(0))){var n=t.map,o=r=="+".charCodeAt(0)?this.delta_:-this.delta_,i=n.getView();jf(i,o,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}Th.default=Ll;var of={};var Dq=of&&of.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),pf={TRACKPAD:"trackpad",WHEEL:"wheel"};of.Mode=pf;var Ml=function(t){function e(e){var o=this,i=e||{};return(o=t.call(this,i)||this).totalDelta_=0,o.lastDelta_=0,o.maxDelta_=void 0!==i.maxDelta?i.maxDelta:1,o.duration_=void 0!==i.duration?i.duration:250,o.timeout_=void 0!==i.timeout?i.timeout:80,o.useAnchor_=void 0===i.useAnchor||i.useAnchor,o.condition_=i.condition?i.condition:Kh,o.lastAnchor_=null,o.startTime_=void 0,o.timeoutId_,o.mode_=void 0,o.trackpadEventGap_=400,o.trackpadTimeoutId_,o.deltaPerZoom_=300,o}return Dq(e,t),e.prototype.conditionInternal_=function(t){var e=!0;return t.map.getTargetElement().hasAttribute("tabindex")&&(e=kf(t)),e&&this.condition_(t)},e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)},e.prototype.handleEvent=function(t){if(!this.conditionInternal_(t))return!0;if(t.type!==ca.WHEEL)return!0;t.preventDefault();var e,o=t.map,i=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==ca.WHEEL&&(e=i.deltaY,so&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=we),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var r=Date.now();void 0===this.startTime_&&(this.startTime_=r),(!this.mode_||r-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?pf.TRACKPAD:pf.WHEEL);var a=o.getView();if(this.mode_===pf.TRACKPAD&&!a.getConstrainResolution())return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-e/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=r,!1;this.totalDelta_+=e;var n=Math.max(this.timeout_-(r-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,o),n),!1},e.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var o=-ja(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;e.getConstrainResolution()&&(o=o?o>0?1:-1:0),jf(e,o,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(ac);of.default=Ml;var Uh={};var Eq=Uh&&Uh.__extends||function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Nl=function(t){function n(n){var e=this,r=n||{},o=r;return o.stopDown||(o.stopDown=oc),(e=t.call(this,o)||this).anchor_=null,e.lastAngle_=void 0,e.rotating_=!1,e.rotationDelta_=0,e.threshold_=void 0!==r.threshold?r.threshold:.3,e.duration_=void 0!==r.duration?r.duration:250,e}return Eq(n,t),n.prototype.handleDragEvent=function(t){var n=0,e=this.targetPointers[0],r=this.targetPointers[1],o=Math.atan2(r.clientY-e.clientY,r.clientX-e.clientX);if(void 0!==this.lastAngle_){var i=o-this.lastAngle_;this.rotationDelta_+=i,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=i}this.lastAngle_=o;var a=t.map,s=a.getView();if(s.getConstraints().rotation!==Me){var h=a.getViewport().getBoundingClientRect(),l=nf(this.targetPointers);l[0]-=h.left,l[1]-=h.top,this.anchor_=a.getCoordinateFromPixelInternal(l),this.rotating_&&(a.render(),s.adjustRotationInternal(n,this.anchor_))}},n.prototype.handleUpEvent=function(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)},n.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var n=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1},n}(hb);Uh.default=Nl;var Vh={};var Fq=Vh&&Vh.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ol=function(t){function e(e){var r=this,n=e||{},o=n;return o.stopDown||(o.stopDown=oc),(r=t.call(this,o)||this).anchor_=null,r.duration_=void 0!==n.duration?n.duration:400,r.lastDistance_=void 0,r.lastScaleDelta_=1,r}return Fq(e,t),e.prototype.handleDragEvent=function(t){var e=1,r=this.targetPointers[0],n=this.targetPointers[1],o=r.clientX-n.clientX,i=r.clientY-n.clientY,a=Math.sqrt(o*o+i*i);void 0!==this.lastDistance_&&(e=this.lastDistance_/a),this.lastDistance_=a;var s=t.map,c=s.getView();1!=e&&(this.lastScaleDelta_=e);var l=s.getViewport().getBoundingClientRect(),u=nf(this.targetPointers);u[0]-=l.left,u[1]-=l.top,this.anchor_=s.getCoordinateFromPixelInternal(u),s.render(),c.adjustResolutionInternal(e,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView(),r=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,r),!1}return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},e}(hb);Vh.default=Ol;var Wh={};var Pl=Wh&&Wh.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Gq={ADD_FEATURES:"addfeatures"},Hq=function(t){function e(e,r,n,o){var i=t.call(this,e)||this;return i.features=n,i.file=r,i.projection=o,i}return Pl(e,t),e}(Ka),Iq=function(t){function e(e){var r=this,n=e||{};return(r=t.call(this,{handleEvent:Xa})||this).formatConstructors_=n.formatConstructors?n.formatConstructors:[],r.projection_=n.projection?pa(n.projection):null,r.dropListenKeys_=null,r.source_=n.source||null,r.target=n.target?n.target:null,r}return Pl(e,t),e.prototype.handleResult_=function(t,e){var r=e.target.result,n=this.getMap(),o=this.projection_;o||(o=n.getView().getProjection());for(var i=this.formatConstructors_,s=[],$=0,a=i.length;$<a;++$){var p=new i[$];if((s=this.tryReadFeatures_(p,r,{featureProjection:o}))&&s.length>0)break}this.source_&&(this.source_.clear(),this.source_.addFeatures(s)),this.dispatchEvent(new Hq(Gq.ADD_FEATURES,t,s,o))},e.prototype.registerListeners_=function(){var t=this.getMap();if(t){var e=this.target?this.target:t.getViewport();this.dropListenKeys_=[fa(e,ca.DROP,Jq,this),fa(e,ca.DRAGENTER,Xh,this),fa(e,ca.DRAGOVER,Xh,this),fa(e,ca.DROP,Xh,this)]}},e.prototype.setActive=function(e){!this.getActive()&&e&&this.registerListeners_(),this.getActive()&&!e&&this.unregisterListeners_(),t.prototype.setActive.call(this,e)},e.prototype.setMap=function(e){this.unregisterListeners_(),t.prototype.setMap.call(this,e),this.getActive()&&this.registerListeners_()},e.prototype.tryReadFeatures_=function(t,e,r){try{return t.readFeatures(e,r)}catch(n){return null}},e.prototype.unregisterListeners_=function(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(ra),this.dropListenKeys_=null)},e}(ac);function Jq(t){for(var e=t.dataTransfer.files,r=0,n=e.length;r<n;++r){var o=e.item(r),i=new FileReader;i.addEventListener(ca.LOAD,this.handleResult_.bind(this,o)),i.readAsText(o)}}function Xh(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}Wh.default=Iq;var Yh={};var Kq=Yh&&Yh.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Lq=function(t){function e(e){var n=this,i=e||{};return(n=t.call(this,i)||this).condition_=i.condition?i.condition:lf,n.lastAngle_=void 0,n.lastMagnitude_=void 0,n.lastScaleDelta_=0,n.duration_=void 0!==i.duration?i.duration:400,n}return Kq(e,t),e.prototype.handleDragEvent=function(t){if(gd(t)){var e=t.map,n=e.getSize(),i=t.pixel,o=i[0]-n[0]/2,a=n[1]/2-i[1],r=Math.atan2(a,o),s=Math.sqrt(o*o+a*a),l=e.getView();if(void 0!==this.lastAngle_){var u=this.lastAngle_-r;l.adjustRotationInternal(u)}this.lastAngle_=r,void 0!==this.lastMagnitude_&&l.adjustResolutionInternal(this.lastMagnitude_/s),void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/s),this.lastMagnitude_=s}},e.prototype.handleUpEvent=function(t){if(!gd(t))return!0;var e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),this.lastScaleDelta_=0,!1},e.prototype.handleDownEvent=function(t){return!!gd(t)&&!!this.condition_(t)&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,this.lastMagnitude_=void 0,!0)},e}(hb);Yh.default=Lq;var Nd={};var qf={};var Mq=qf&&qf.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Wa=function(e){function t(t){var r=e.call(this)||this;if(r.id_=void 0,r.geometryName_="geometry",r.style_=null,r.styleFunction_=void 0,r.geometryChangeKey_=null,r.addEventListener(xa(r.geometryName_),r.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){var n=t;r.setGeometry(n)}else{var o=t;r.setProperties(o)}return r}return Mq(t,e),t.prototype.clone=function(){var e=new t(this.getProperties());e.setGeometryName(this.getGeometryName());var r=this.getGeometry();r&&e.setGeometry(r.clone());var n=this.getStyle();return n&&e.setStyle(n),e},t.prototype.getGeometry=function(){return this.get(this.geometryName_)},t.prototype.getId=function(){return this.id_},t.prototype.getGeometryName=function(){return this.geometryName_},t.prototype.getStyle=function(){return this.style_},t.prototype.getStyleFunction=function(){return this.styleFunction_},t.prototype.handleGeometryChange_=function(){this.changed()},t.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(ra(this.geometryChangeKey_),this.geometryChangeKey_=null);var e=this.getGeometry();e&&(this.geometryChangeKey_=fa(e,ca.CHANGE,this.handleGeometryChange_,this)),this.changed()},t.prototype.setGeometry=function(e){this.set(this.geometryName_,e)},t.prototype.setStyle=function(e){this.style_=e,this.styleFunction_=e?Ql(e):void 0,this.changed()},t.prototype.setId=function(e){this.id_=e,this.changed()},t.prototype.setGeometryName=function(e){this.removeEventListener(xa(this.geometryName_),this.handleGeometryChanged_),this.geometryName_=e,this.addEventListener(xa(this.geometryName_),this.handleGeometryChanged_),this.handleGeometryChanged_()},t}(Ta);function Ql(e){return"function"==typeof e?e:(Array.isArray(e)?t=e:(ea("function"==typeof e.getZIndex,41),t=[e]),function(){return t});var t}qf.createStyleFunction=Ql,qf.default=Wa;var Zh={};var Nq=Zh&&Zh.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Od=function(t){function e(e,r,o){var i=t.call(this)||this;if(void 0!==o&&void 0===r)i.setFlatCoordinates(o,e);else{var s=r||0;i.setCenterAndRadius(e,s,o)}return i}return Nq(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),void 0,this.layout)},e.prototype.closestPointXY=function(t,e,r,o){var i=this.flatCoordinates,s=t-i[0],n=e-i[1],a=s*s+n*n;if(a<o){if(0===a)for(var p=0;p<this.stride;++p)r[p]=i[p];else{var d=this.getRadius()/Math.sqrt(a);r[0]=i[0]+d*s,r[1]=i[1]+d*n;for(p=2;p<this.stride;++p)r[p]=i[p]}return r.length=this.stride,a}return o},e.prototype.containsXY=function(t,e){var r=this.flatCoordinates,o=t-r[0],i=e-r[1];return o*o+i*i<=this.getRadiusSquared_()},e.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.computeExtent=function(t){var e=this.flatCoordinates,r=e[this.stride]-e[0];return nb(e[0]-r,e[1]-r,e[0]+r,e[1]+r,t)},e.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},e.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},e.prototype.getType=function(){return aa.CIRCLE},e.prototype.intersectsExtent=function(t){var e=this.getExtent();if(ya(t,e)){var r=this.getCenter();return t[0]<=r[0]&&t[2]>=r[0]||t[1]<=r[1]&&t[3]>=r[1]||Pj(t,this.intersectsCoordinate.bind(this))}return!1},e.prototype.setCenter=function(t){var e=this.stride,r=this.flatCoordinates[e]-this.flatCoordinates[0],o=t.slice();o[e]=o[0]+r;for(var i=1;i<e;++i)o[e+i]=t[i];this.setFlatCoordinates(this.layout,o),this.changed()},e.prototype.setCenterAndRadius=function(t,e,r){this.setLayout(r,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var o=this.flatCoordinates,i=Hk(o,0,t,this.stride);o[i++]=o[0]+e;for(var s=1,n=this.stride;s<n;++s)o[i++]=o[s];o.length=i,this.changed()},e.prototype.getCoordinates=function(){return null},e.prototype.setCoordinates=function(t,e){},e.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},e.prototype.rotate=function(t,e){var r=this.getCenter(),o=this.getStride();this.setCenter(Ak(r,0,r.length,o,t,e,r)),this.changed()},e.prototype.translate=function(t,e){var r=this.getCenter(),o=this.getStride();this.setCenter(Bk(r,0,r.length,o,t,e,r)),this.changed()},e}(Kb);Od.prototype.transform,Zh.default=Od;var $h={};function Rl(r,e,t,i,n,$){var o=NaN,l=NaN,a=(t-e)/i;if(1===a)o=r[e],l=r[e+1];else if(2==a)o=(1-n)*r[e]+n*r[e+i],l=(1-n)*r[e+1]+n*r[e+i+1];else if(0!==a){for(var u=r[e],p=r[e+1],f=0,s=[0],q=e+i;q<t;q+=i){var D=r[q],T=r[q+1];f+=Math.sqrt((D-u)*(D-u)+(T-p)*(T-p)),s.push(f),u=D,p=T}var v=n*f,c=Jn(s,v);if(c<0){var g=(v-s[-c-2])/(s[-c-1]-s[-c-2]),x=e+(-c-2)*i;o=Rc(r[x],r[x+i],g),l=Rc(r[x+1],r[x+i+1],g)}else o=r[e+c*i],l=r[e+c*i+1]}return $?($[0]=o,$[1]=l,$):[o,l]}function _h(r,e,t,i,n,$){if(t==e)return null;var o;if(n<r[e+i-1])return $?((o=r.slice(e,e+i))[i-1]=n,o):null;if(r[t-1]<n)return $?((o=r.slice(t-i,t))[i-1]=n,o):null;if(n==r[e+i-1])return r.slice(e,e+i);for(var l=e/i,a=t/i;l<a;){var u=l+a>>1;n<r[(u+1)*i-1]?a=u:l=u+1}var p=r[l*i-1];if(n==p)return r.slice((l-1)*i,(l-1)*i+i);var f=(n-p)/(r[(l+1)*i-1]-p);o=[];for(var s=0;s<i-1;++s)o.push(Rc(r[(l-1)*i+s],r[l*i+s],f));return o.push(n),o}function Oq(r,e,t,i,n,$,o){if(o)return _h(r,e,t[t.length-1],i,n,$);var l;if(n<r[i-1])return $?((l=r.slice(0,i))[i-1]=n,l):null;if(r[r.length-1]<n)return $?((l=r.slice(r.length-i))[i-1]=n,l):null;for(var a=0,u=t.length;a<u;++a){var p=t[a];if(e!=p){if(n<r[e+i-1])return null;if(n<=r[p-1])return _h(r,e,p,i,n,!1);e=p}}return null}function Sl(r,n,t,e){for(var $=r[n],i=r[n+1],x=0,Z=n+e;Z<t;Z+=e){var g=r[Z],o=r[Z+1];x+=Math.sqrt((g-$)*(g-$)+(o-i)*(o-i)),$=g,i=o}return x}var Pq=$h&&$h.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),Mb=function(t){function e(e,i){var o=t.call(this)||this;return o.flatMidpoint_=null,o.flatMidpointRevision_=-1,o.maxDelta_=-1,o.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?o.setCoordinates(e,i):o.setFlatCoordinates(i,e),o}return Pq(e,t),e.prototype.appendCoordinate=function(t){this.flatCoordinates?bb(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,o){return o<sc(this.getExtent(),t,e)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(fh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),hh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,o))},e.prototype.forEachSegment=function(t){return Mk(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,e){if(this.layout!=wa.XYM&&this.layout!=wa.XYZM)return null;var i=void 0!==e&&e;return _h(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},e.prototype.getCoordinates=function(){return Hd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,e){return Rl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e)},e.prototype.getLength=function(){return Sl(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=kh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,wa.XY)},e.prototype.getType=function(){return aa.LINE_STRING},e.prototype.intersectsExtent=function(t){return We(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Te(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Kb);$h.default=Mb;var ai={};var Qq=ai&&ai.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),bi=function(t){function e(e,r,i){var o=t.call(this)||this;if(o.ends_=[],o.maxDelta_=-1,o.maxDeltaRevision_=-1,Array.isArray(e[0]))o.setCoordinates(e,r);else if(void 0!==r&&i)o.setFlatCoordinates(r,e),o.ends_=i;else{for(var s=o.getLayout(),n=e,a=[],f=[],l=0,$=n.length;l<$;++l){var p=n[l];0===l&&(s=p.getLayout()),bb(a,p.getFlatCoordinates()),f.push(a.length)}o.setFlatCoordinates(s,a),o.ends_=f}return o}return Qq(e,t),e.prototype.appendLineString=function(t){this.flatCoordinates?bb(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,r,i){return i<sc(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(gh(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ih(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,r,i))},e.prototype.getCoordinateAtM=function(t,e,r){if(this.layout!=wa.XYM&&this.layout!=wa.XYZM||0===this.flatCoordinates.length)return null;var i=void 0!==e&&e,o=void 0!==r&&r;return Oq(this.flatCoordinates,0,this.ends_,this.stride,t,i,o)},e.prototype.getCoordinates=function(){return Ue(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new Mb(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,e=this.ends_,r=this.layout,i=[],o=0,s=0,n=e.length;s<n;++s){var a=e[s],f=new Mb(t.slice(o,a),r);i.push(f),o=a}return i},e.prototype.getFlatMidpoints=function(){for(var t=[],e=this.flatCoordinates,r=0,i=this.ends_,o=this.stride,s=0,n=i.length;s<n;++s){var a=i[s],f=Rl(e,r,a,o,.5);bb(t,f),r=a}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[],i=[];return r.length=ep(this.flatCoordinates,0,this.ends_,this.stride,t,r,0,i),new e(r,wa.XY,i)},e.prototype.getType=function(){return aa.MULTI_LINE_STRING},e.prototype.intersectsExtent=function(t){return mp(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=jh(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===r.length?0:r[r.length-1],this.changed()},e}(Kb);ai.default=bi;var ci={};var Rq=ci&&ci.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),rf=function(t){function e(e,r){var o=t.call(this)||this;return r&&!Array.isArray(e[0])?o.setFlatCoordinates(r,e):o.setCoordinates(e,r),o}return Rq(e,t),e.prototype.appendPoint=function(t){this.flatCoordinates?bb(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,r,o){if(o<sc(this.getExtent(),t,e))return o;for(var i=this.flatCoordinates,n=this.stride,s=0,a=i.length;s<a;s+=n){var u=rc(t,e,i[s],i[s+1]);if(u<o){o=u;for(var d=0;d<n;++d)r[d]=i[s+d];r.length=n}}return o},e.prototype.getCoordinates=function(){return Hd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getPoint=function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new gb(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},e.prototype.getPoints=function(){for(var t=this.flatCoordinates,e=this.layout,r=this.stride,o=[],i=0,n=t.length;i<n;i+=r){var s=new gb(t.slice(i,i+r),e);o.push(s)}return o},e.prototype.getType=function(){return aa.MULTI_POINT},e.prototype.intersectsExtent=function(t){for(var e=this.flatCoordinates,r=this.stride,o=0,i=e.length;o<i;o+=r){var n=e[o],s=e[o+1];if(zg(t,n,s))return!0}return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Te(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Kb);ci.default=rf;var di={};function Sq(r,e,t,$){for(var n=[],a=Ha(),i=0,o=t.length;i<o;++i){var s=t[i];a=Nj(r,e,s[0],$),n.push((a[0]+a[2])/2,(a[1]+a[3])/2),e=s[s.length-1]}return n}var Tq=di&&di.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ei=function(t){function e(e,i,r){var o=t.call(this)||this;if(o.endss_=[],o.flatInteriorPointsRevision_=-1,o.flatInteriorPoints_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){for(var s=o.getLayout(),n=e,a=[],h=[],l=0,u=n.length;l<u;++l){var $=n[l];0===l&&(s=$.getLayout());for(var d=a.length,p=$.getEnds(),f=0,c=p.length;f<c;++f)p[f]+=d;bb(a,$.getFlatCoordinates()),h.push(p)}i=s,e=a,r=h}return void 0!==i&&r?(o.setFlatCoordinates(i,e),o.endss_=r):o.setCoordinates(e,i),o}return Tq(e,t),e.prototype.appendPolygon=function(t){var e;if(this.flatCoordinates){var i=this.flatCoordinates.length;bb(this.flatCoordinates,t.getFlatCoordinates());for(var r=0,o=(e=t.getEnds().slice()).length;r<o;++r)e[r]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()},e.prototype.clone=function(){for(var t=this.endss_.length,i=new Array(t),r=0;r<t;++r)i[r]=this.endss_[r].slice();return new e(this.flatCoordinates.slice(),this.layout,i)},e.prototype.closestPointXY=function(t,e,i,r){return r<sc(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(bp(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),cp(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,r))},e.prototype.containsXY=function(t,e){return kp(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},e.prototype.getArea=function(){return ap(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Pk(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,Ik(e,0,this.endss_,this.stride)},e.prototype.getEndss=function(){return this.endss_},e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=Sq(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=lp(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},e.prototype.getInteriorPoints=function(){return new rf(this.getFlatInteriorPoints().slice(),wa.XYM)},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;pp(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Pk(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],r=[];return i.length=gp(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),i,0,r),new e(i,wa.XY,r)},e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var i=this.endss_[t-1];e=i[i.length-1]}var r=this.endss_[t].slice(),o=r[r.length-1];if(0!==e)for(var s=0,n=r.length;s<n;++s)r[s]-=e;return new xb(this.flatCoordinates.slice(e,o),this.layout,r)},e.prototype.getPolygons=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.endss_,r=[],o=0,s=0,n=i.length;s<n;++s){var a=i[s].slice(),h=a[a.length-1];if(0!==o)for(var l=0,u=a.length;l<u;++l)a[l]-=o;var $=new xb(e.slice(o,h),t,a);r.push($),o=h}return r},e.prototype.getType=function(){return aa.MULTI_POLYGON},e.prototype.intersectsExtent=function(t){return op(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=dp(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{var r=i[i.length-1];this.flatCoordinates.length=0===r.length?0:r[r.length-1]}this.changed()},e}(Kb);di.default=ei;var fi={};var gi={};var hi={};var ii={};var Tl=function(){function t(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.displacement_=t.displacement}return t.prototype.clone=function(){return new t({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},t.prototype.getOpacity=function(){return this.opacity_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getDisplacement=function(){return this.displacement_},t.prototype.getAnchor=function(){return ma()},t.prototype.getImage=function(t){return ma()},t.prototype.getHitDetectionImage=function(t){return ma()},t.prototype.getImageState=function(){return ma()},t.prototype.getImageSize=function(){return ma()},t.prototype.getHitDetectionImageSize=function(){return ma()},t.prototype.getOrigin=function(){return ma()},t.prototype.getSize=function(){return ma()},t.prototype.setOpacity=function(t){this.opacity_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t},t.prototype.listenImageChange=function(t){ma()},t.prototype.load=function(){ma()},t.prototype.unlistenImageChange=function(t){ma()},t}();var Uq=ii&&ii.__extends||function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function r(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ul=function(t){function i(i){var e=this,r=void 0!==i.rotateWithView&&i.rotateWithView;return(e=t.call(this,{opacity:1,rotateWithView:r,rotation:void 0!==i.rotation?i.rotation:0,scale:1,displacement:void 0!==i.displacement?i.displacement:[0,0]})||this).canvas_=null,e.hitDetectionCanvas_=null,e.fill_=void 0!==i.fill?i.fill:null,e.origin_=[0,0],e.points_=i.points,e.radius_=void 0!==i.radius?i.radius:i.radius1,e.radius2_=i.radius2,e.angle_=void 0!==i.angle?i.angle:0,e.stroke_=void 0!==i.stroke?i.stroke:null,e.anchor_=null,e.size_=null,e.imageSize_=null,e.hitDetectionImageSize_=null,e.render(),e}return Uq(i,t),i.prototype.clone=function(){var t=new i({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},i.prototype.getAnchor=function(){return this.anchor_},i.prototype.getAngle=function(){return this.angle_},i.prototype.getFill=function(){return this.fill_},i.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},i.prototype.getImage=function(t){return this.canvas_},i.prototype.getImageSize=function(){return this.imageSize_},i.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},i.prototype.getImageState=function(){return ia.LOADED},i.prototype.getOrigin=function(){return this.origin_},i.prototype.getPoints=function(){return this.points_},i.prototype.getRadius=function(){return this.radius_},i.prototype.getRadius2=function(){return this.radius2_},i.prototype.getSize=function(){return this.size_},i.prototype.getStroke=function(){return this.stroke_},i.prototype.listenImageChange=function(t){},i.prototype.load=function(){},i.prototype.unlistenImageChange=function(t){},i.prototype.render=function(){var t,i=cd,e=dd,r=0,o=null,s=0,n=0;this.stroke_&&(null===(t=this.stroke_.getColor())&&(t=Ad),t=yb(t),void 0===(n=this.stroke_.getWidth())&&(n=Cd),o=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset(),void 0===(e=this.stroke_.getLineJoin())&&(e=dd),void 0===(i=this.stroke_.getLineCap())&&(i=cd),void 0===(r=this.stroke_.getMiterLimit())&&(r=zd));var a=2*(this.radius_+n)+1,l={strokeStyle:t,strokeWidth:n,size:a,lineCap:i,lineDash:o,lineDashOffset:s,lineJoin:e,miterLimit:r},h=Ea(a,a);this.canvas_=h.canvas;var u=a=this.canvas_.width,p=this.getDisplacement();this.draw_(l,h,0,0),this.createHitDetectionCanvas_(l),this.anchor_=[a/2-p[0],a/2+p[1]],this.size_=[a,a],this.imageSize_=[u,u]},i.prototype.draw_=function(t,i,e,r){var o,s,n;i.setTransform(1,0,0,1,0,0),i.translate(e,r),i.beginPath();var a=this.points_;if(a===1/0)i.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var l=void 0!==this.radius2_?this.radius2_:this.radius_;for(l!==this.radius_&&(a*=2),o=0;o<=a;o++)s=2*o*Math.PI/a-Math.PI/2+this.angle_,n=o%2==0?this.radius_:l,i.lineTo(t.size/2+n*Math.cos(s),t.size/2+n*Math.sin(s))}if(this.fill_){var h=this.fill_.getColor();null===h&&(h=Gb),i.fillStyle=yb(h),i.fill()}this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,i.setLineDash&&t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineCap=t.lineCap,i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit,i.stroke()),i.closePath()},i.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.hitDetectionCanvas_=this.canvas_,this.fill_){var i=this.fill_.getColor(),e=0;if("string"==typeof i&&(i=il(i)),null===i?e=1:Array.isArray(i)&&(e=4===i.length?i[3]:1),0===e){var r=Ea(t.size,t.size);this.hitDetectionCanvas_=r.canvas,this.drawHitDetectionCanvas_(t,r,0,0)}}},i.prototype.drawHitDetectionCanvas_=function(t,i,e,r){i.setTransform(1,0,0,1,0,0),i.translate(e,r),i.beginPath();var o=this.points_;if(o===1/0)i.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var s=void 0!==this.radius2_?this.radius2_:this.radius_;s!==this.radius_&&(o*=2);var n=void 0,a=void 0,l=void 0;for(n=0;n<=o;n++)l=2*n*Math.PI/o-Math.PI/2+this.angle_,a=n%2==0?this.radius_:s,i.lineTo(t.size/2+a*Math.cos(l),t.size/2+a*Math.sin(l))}i.fillStyle=Gb,i.fill(),this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.stroke()),i.closePath()},i}(Tl);ii.default=Ul;var Vq=hi&&hi.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ji=function(t){function e(e){var r=e||{};return t.call(this,{points:1/0,fill:r.fill,radius:r.radius,stroke:r.stroke,displacement:void 0!==r.displacement?r.displacement:[0,0]})||this}return Vq(e,t),e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(Ul);hi.default=ji;var bc=function(){function o(o){var r=o||{};this.color_=void 0!==r.color?r.color:null}return o.prototype.clone=function(){var r=this.getColor();return new o({color:Array.isArray(r)?r.slice():r||void 0})},o.prototype.getColor=function(){return this.color_},o.prototype.setColor=function(o){this.color_=o},o}();var Nb=function(){function t(t){var i=t||{};this.color_=void 0!==i.color?i.color:null,this.lineCap_=i.lineCap,this.lineDash_=void 0!==i.lineDash?i.lineDash:null,this.lineDashOffset_=i.lineDashOffset,this.lineJoin_=i.lineJoin,this.miterLimit_=i.miterLimit,this.width_=i.width}return t.prototype.clone=function(){var i=this.getColor();return new t({color:Array.isArray(i)?i.slice():i||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},t.prototype.getColor=function(){return this.color_},t.prototype.getLineCap=function(){return this.lineCap_},t.prototype.getLineDash=function(){return this.lineDash_},t.prototype.getLineDashOffset=function(){return this.lineDashOffset_},t.prototype.getLineJoin=function(){return this.lineJoin_},t.prototype.getMiterLimit=function(){return this.miterLimit_},t.prototype.getWidth=function(){return this.width_},t.prototype.setColor=function(t){this.color_=t},t.prototype.setLineCap=function(t){this.lineCap_=t},t.prototype.setLineDash=function(t){this.lineDash_=t},t.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t},t.prototype.setLineJoin=function(t){this.lineJoin_=t},t.prototype.setMiterLimit=function(t){this.miterLimit_=t},t.prototype.setWidth=function(t){this.width_=t},t}();var pb=function(){function e(e){var t=e||{};this.geometry_=null,this.geometryFunction_=Wl,void 0!==t.geometry&&this.setGeometry(t.geometry),this.fill_=void 0!==t.fill?t.fill:null,this.image_=void 0!==t.image?t.image:null,this.renderer_=void 0!==t.renderer?t.renderer:null,this.stroke_=void 0!==t.stroke?t.stroke:null,this.text_=void 0!==t.text?t.text:null,this.zIndex_=t.zIndex}return e.prototype.clone=function(){var t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new e({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.setRenderer=function(e){this.renderer_=e},e.prototype.getGeometry=function(){return this.geometry_},e.prototype.getGeometryFunction=function(){return this.geometryFunction_},e.prototype.getFill=function(){return this.fill_},e.prototype.setFill=function(e){this.fill_=e},e.prototype.getImage=function(){return this.image_},e.prototype.setImage=function(e){this.image_=e},e.prototype.getStroke=function(){return this.stroke_},e.prototype.setStroke=function(e){this.stroke_=e},e.prototype.getText=function(){return this.text_},e.prototype.setText=function(e){this.text_=e},e.prototype.getZIndex=function(){return this.zIndex_},e.prototype.setGeometry=function(e){"function"==typeof e?this.geometryFunction_=e:"string"==typeof e?this.geometryFunction_=function(t){return t.get(e)}:e?void 0!==e&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=Wl,this.geometry_=e},e.prototype.setZIndex=function(e){this.zIndex_=e},e}();function Wq(e){var t;if("function"==typeof e)t=e;else{var r;if(Array.isArray(e))r=e;else ea("function"==typeof e.getZIndex,41),r=[e];t=function(){return r}}return t}var Vl=null;function Xq(e,t){if(!Vl){var r=new bc({color:"rgba(255,255,255,0.4)"}),o=new Nb({color:"#3399CC",width:1.25});Vl=[new pb({image:new ji({fill:r,stroke:o,radius:5}),fill:r,stroke:o})]}return Vl}function Pd(){var e={},t=[255,255,255,1],r=[0,153,255,1];return e[aa.POLYGON]=[new pb({fill:new bc({color:[255,255,255,.5]})})],e[aa.MULTI_POLYGON]=e[aa.POLYGON],e[aa.LINE_STRING]=[new pb({stroke:new Nb({color:t,width:5})}),new pb({stroke:new Nb({color:r,width:3})})],e[aa.MULTI_LINE_STRING]=e[aa.LINE_STRING],e[aa.CIRCLE]=e[aa.POLYGON].concat(e[aa.LINE_STRING]),e[aa.POINT]=[new pb({image:new ji({radius:6,fill:new bc({color:r}),stroke:new Nb({color:t,width:1.5})}),zIndex:1/0})],e[aa.MULTI_POINT]=e[aa.POINT],e[aa.GEOMETRY_COLLECTION]=e[aa.POLYGON].concat(e[aa.LINE_STRING],e[aa.POINT]),e}function Wl(e){return e.getGeometry()}var Yq=gi&&gi.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Xl={RENDER_ORDER:"renderOrder"},Qd=function(t){function e(e){var r=this,n=e||{},i=ha({},n);return delete i.style,delete i.renderBuffer,delete i.updateWhileAnimating,delete i.updateWhileInteracting,(r=t.call(this,i)||this).declutter_=void 0!==n.declutter&&n.declutter,r.renderBuffer_=void 0!==n.renderBuffer?n.renderBuffer:100,r.style_=null,r.styleFunction_=void 0,r.setStyle(n.style),r.updateWhileAnimating_=void 0!==n.updateWhileAnimating&&n.updateWhileAnimating,r.updateWhileInteracting_=void 0!==n.updateWhileInteracting&&n.updateWhileInteracting,r}return Yq(e,t),e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(Xl.RENDER_ORDER)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(Xl.RENDER_ORDER,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:Xq,this.styleFunction_=null===t?void 0:Wq(this.style_),this.changed()},e}(ge);gi.default=Qd;var ki={};var li={};var ga={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},sf=[ga.FILL];var cc=[ga.STROKE];var Hc=[ga.BEGIN_PATH];var Yl=[ga.CLOSE_PATH];var Zq=li&&li.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),hd=function(t){function e(e,i,r,n){var o=t.call(this)||this;return o.tolerance=e,o.maxExtent=i,o.pixelRatio=n,o.maxLineWidth=0,o.resolution=r,o.beginGeometryInstruction1_=null,o.beginGeometryInstruction2_=null,o.bufferedMaxExtent_=null,o.instructions=[],o.coordinates=[],o.tmpCoordinate_=[],o.hitDetectionInstructions=[],o.state={},o}return Zq(e,t),e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})},e.prototype.appendFlatCoordinates=function(t,e,i,r,n,o){var s=this.coordinates.length,a=this.getBufferedMaxExtent();o&&(e+=r);var u,$,l,p=t[e],c=t[e+1],h=this.tmpCoordinate_,d=!0;for(u=e+r;u<i;u+=r)h[0]=t[u],h[1]=t[u+1],(l=Ag(a,h))!==$?(d&&(this.coordinates[s++]=p,this.coordinates[s++]=c),this.coordinates[s++]=h[0],this.coordinates[s++]=h[1],d=!1):l===Ia.INTERSECTING?(this.coordinates[s++]=h[0],this.coordinates[s++]=h[1],d=!1):d=!0,p=h[0],c=h[1],$=l;return(n&&d||u===e+r)&&(this.coordinates[s++]=p,this.coordinates[s++]=c),s},e.prototype.drawCustomCoordinates_=function(t,e,i,r,n){for(var o=0,s=i.length;o<s;++o){var a=i[o],u=this.appendFlatCoordinates(t,e,a,r,!1,!1);n.push(u),e=a}return e},e.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);var r,n,o,s,a,u=t.getType(),$=t.getStride(),l=this.coordinates.length;if(u==aa.MULTI_POLYGON){r=(t=t).getOrientedFlatCoordinates(),s=[];var p=t.getEndss();a=0;for(var c=0,h=p.length;c<h;++c){var d=[];a=this.drawCustomCoordinates_(r,a,p[c],$,d),s.push(d)}this.instructions.push([ga.CUSTOM,l,s,t,i,Ik])}else u==aa.POLYGON||u==aa.MULTI_LINE_STRING?(o=[],r=u==aa.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),a=this.drawCustomCoordinates_(r,0,t.getEnds(),$,o),this.instructions.push([ga.CUSTOM,l,o,t,i,Ue])):u==aa.LINE_STRING||u==aa.MULTI_POINT?(r=t.getFlatCoordinates(),n=this.appendFlatCoordinates(r,0,r.length,$,!1,!1),this.instructions.push([ga.CUSTOM,l,n,t,i,Hd])):u==aa.POINT&&(r=t.getFlatCoordinates(),this.coordinates.push(r[0],r[1]),n=this.coordinates.length,this.instructions.push([ga.CUSTOM,l,n,t,i]));this.endGeometry(e)},e.prototype.beginGeometry=function(t,e){var i=t.getExtent();this.beginGeometryInstruction1_=[ga.BEGIN_GEOMETRY,e,0,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[ga.BEGIN_GEOMETRY,e,0,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var i,r,n=e.length,o=-1;for(t=0;t<n;++t)(r=(i=e[t])[0])==ga.END_GEOMETRY?o=t:r==ga.BEGIN_GEOMETRY&&(i[2]=t,Kn(this.hitDetectionInstructions,o,t),o=-1)},e.prototype.setFillStrokeStyle=function(t,e){var i=this.state;if(t){var r=t.getColor();i.fillStyle=yb(r||Gb)}else i.fillStyle=void 0;if(e){var n=e.getColor();i.strokeStyle=yb(n||Ad);var o=e.getLineCap();i.lineCap=void 0!==o?o:cd;var s=e.getLineDash();i.lineDash=s?s.slice():Be;var a=e.getLineDashOffset();i.lineDashOffset=a||Ce;var u=e.getLineJoin();i.lineJoin=void 0!==u?u:dd;var $=e.getWidth();i.lineWidth=void 0!==$?$:Cd;var l=e.getMiterLimit();i.miterLimit=void 0!==l?l:zd,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},e.prototype.createFill=function(t){var e=t.fillStyle,i=[ga.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(!0),i},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[ga.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,e){var i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)},e.prototype.updateStrokeStyle=function(t,e){var i=t.strokeStyle,r=t.lineCap,n=t.lineDash,o=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,u=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=r||n!=t.currentLineDash&&!Vb(t.currentLineDash,n)||t.currentLineDashOffset!=o||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=u)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=r,t.currentLineDash=n,t.currentLineDashOffset=o,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=u)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[ga.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Mj(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;db(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(nl);li.default=hd;var mi={};var $q=mi&&mi.__extends||function(){var t=function(i,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(i,o)};return function(i,o){function e(){this.constructor=i}t(i,o),i.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}}(),Zl=function(t){function i(i,o,e,h){var s=t.call(this,i,o,e,h)||this;return s.declutterGroups_=null,s.hitDetectionImage_=null,s.image_=null,s.anchorX_=void 0,s.anchorY_=void 0,s.height_=void 0,s.opacity_=void 0,s.originX_=void 0,s.originY_=void 0,s.rotateWithView_=void 0,s.rotation_=void 0,s.scale_=void 0,s.width_=void 0,s}return $q(i,t),i.prototype.drawCoordinates_=function(t,i,o,e){return this.appendFlatCoordinates(t,i,o,e,!1,!1)},i.prototype.drawPoint=function(t,i){if(this.image_){this.beginGeometry(t,i);var o=t.getFlatCoordinates(),e=t.getStride(),h=this.coordinates.length,s=this.drawCoordinates_(o,0,o.length,e);this.instructions.push([ga.DRAW_IMAGE,h,s,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([ga.DRAW_IMAGE,h,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(i)}},i.prototype.drawMultiPoint=function(t,i){if(this.image_){this.beginGeometry(t,i);var o=t.getFlatCoordinates(),e=t.getStride(),h=this.coordinates.length,s=this.drawCoordinates_(o,0,o.length,e);this.instructions.push([ga.DRAW_IMAGE,h,s,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([ga.DRAW_IMAGE,h,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(i)}},i.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,t.prototype.finish.call(this)},i.prototype.setImageStyle=function(t,i){var o=t.getAnchor(),e=t.getSize(),h=t.getHitDetectionImage(1),s=t.getImage(1),r=t.getOrigin();this.anchorX_=o[0],this.anchorY_=o[1],this.declutterGroups_=i,this.hitDetectionImage_=h,this.image_=s,this.height_=e[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.width_=e[0]},i}(hd);mi.default=Zl;var ni={};var _q=ni&&ni.__extends||function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}(),$l=function(t){function i(i,e,s,n){return t.call(this,i,e,s,n)||this}return _q(i,t),i.prototype.drawFlatCoordinates_=function(t,i,e,s){var n=this.coordinates.length,o=this.appendFlatCoordinates(t,i,e,s,!1,!1),r=[ga.MOVE_TO_LINE_TO,n,o];return this.instructions.push(r),this.hitDetectionInstructions.push(r),e},i.prototype.drawLineString=function(t,i){var e=this.state,s=e.strokeStyle,n=e.lineWidth;if(void 0!==s&&void 0!==n){this.updateStrokeStyle(e,this.applyStroke),this.beginGeometry(t,i),this.hitDetectionInstructions.push([ga.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset],Hc);var o=t.getFlatCoordinates(),r=t.getStride();this.drawFlatCoordinates_(o,0,o.length,r),this.hitDetectionInstructions.push(cc),this.endGeometry(i)}},i.prototype.drawMultiLineString=function(t,i){var e=this.state,s=e.strokeStyle,n=e.lineWidth;if(void 0!==s&&void 0!==n){this.updateStrokeStyle(e,this.applyStroke),this.beginGeometry(t,i),this.hitDetectionInstructions.push([ga.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset],Hc);for(var o=t.getEnds(),r=t.getFlatCoordinates(),p=t.getStride(),a=0,h=0,u=o.length;h<u;++h)a=this.drawFlatCoordinates_(r,a,o[h],p);this.hitDetectionInstructions.push(cc),this.endGeometry(i)}},i.prototype.finish=function(){var i=this.state;return null!=i.lastStroke&&i.lastStroke!=this.coordinates.length&&this.instructions.push(cc),this.reverseHitDetectionInstructions(),this.state=null,t.prototype.finish.call(this)},i.prototype.applyStroke=function(i){null!=i.lastStroke&&i.lastStroke!=this.coordinates.length&&(this.instructions.push(cc),i.lastStroke=this.coordinates.length),i.lastStroke=0,t.prototype.applyStroke.call(this,i),this.instructions.push(Hc)},i}(hd);ni.default=$l;var oi={};var ar=oi&&oi.__extends||function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}(),pi=function(t){function i(i,e,s,o){return t.call(this,i,e,s,o)||this}return ar(i,t),i.prototype.drawFlatCoordinatess_=function(t,i,e,s){var o=this.state,n=void 0!==o.fillStyle,r=void 0!==o.strokeStyle,l=e.length;this.instructions.push(Hc),this.hitDetectionInstructions.push(Hc);for(var h=0;h<l;++h){var a=e[h],$=this.coordinates.length,u=this.appendFlatCoordinates(t,i,a,s,!0,!r),c=[ga.MOVE_TO_LINE_TO,$,u];this.instructions.push(c),this.hitDetectionInstructions.push(c),r&&(this.instructions.push(Yl),this.hitDetectionInstructions.push(Yl)),i=a}return n&&(this.instructions.push(sf),this.hitDetectionInstructions.push(sf)),r&&(this.instructions.push(cc),this.hitDetectionInstructions.push(cc)),i},i.prototype.drawCircle=function(t,i){var e=this.state,s=e.fillStyle,o=e.strokeStyle;if(void 0!==s||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,i),void 0!==e.fillStyle&&this.hitDetectionInstructions.push([ga.SET_FILL_STYLE,Gb]),void 0!==e.strokeStyle&&this.hitDetectionInstructions.push([ga.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset]);var n=t.getFlatCoordinates(),r=t.getStride(),l=this.coordinates.length;this.appendFlatCoordinates(n,0,n.length,r,!1,!1);var h=[ga.CIRCLE,l];this.instructions.push(Hc,h),this.hitDetectionInstructions.push(Hc,h),void 0!==e.fillStyle&&(this.instructions.push(sf),this.hitDetectionInstructions.push(sf)),void 0!==e.strokeStyle&&(this.instructions.push(cc),this.hitDetectionInstructions.push(cc)),this.endGeometry(i)}},i.prototype.drawPolygon=function(t,i){var e=this.state,s=e.fillStyle,o=e.strokeStyle;if(void 0!==s||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,i),void 0!==e.fillStyle&&this.hitDetectionInstructions.push([ga.SET_FILL_STYLE,Gb]),void 0!==e.strokeStyle&&this.hitDetectionInstructions.push([ga.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset]);var n=t.getEnds(),r=t.getOrientedFlatCoordinates(),l=t.getStride();this.drawFlatCoordinatess_(r,0,n,l),this.endGeometry(i)}},i.prototype.drawMultiPolygon=function(t,i){var e=this.state,s=e.fillStyle,o=e.strokeStyle;if(void 0!==s||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,i),void 0!==e.fillStyle&&this.hitDetectionInstructions.push([ga.SET_FILL_STYLE,Gb]),void 0!==e.strokeStyle&&this.hitDetectionInstructions.push([ga.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset]);for(var n=t.getEndss(),r=t.getOrientedFlatCoordinates(),l=t.getStride(),h=0,a=0,$=n.length;a<$;++a)h=this.drawFlatCoordinatess_(r,h,n[a],l);this.endGeometry(i)}},i.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var i=this.tolerance;if(0!==i)for(var e=this.coordinates,s=0,o=e.length;s<o;++s)e[s]=Ec(e[s],i);return t.prototype.finish.call(this)},i.prototype.setFillStrokeStyles_=function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)},i}(hd);oi.default=pi;var tf={};function br(h,t,r,$,a){var n,o,C,i,c,e,u,v,p,s=r,x=r,g=0,k=0,m=r;for(n=r;n<$;n+=a){var d=t[n],f=t[n+1];void 0!==i&&(v=d-i,p=f-c,C=Math.sqrt(v*v+p*p),void 0!==e&&(k+=o,Math.acos((e*v+u*p)/(o*C))>h&&(k>g&&(g=k,s=m,x=n),k=0,m=n-a)),o=C,e=v,u=p),i=d,c=f}return(k+=C)>g?[m,n]:[s,x]}var _l={POINT:"point",LINE:"line"};var cr=tf&&tf.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),id={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};tf.TEXT_ALIGN=id;var am=function(t){function e(e,i,r,s){var o=t.call(this,e,i,r,s)||this;return o.declutterGroups_,o.labels_=null,o.text_="",o.textOffsetX_=0,o.textOffsetY_=0,o.textRotateWithView_=void 0,o.textRotation_=0,o.textFillState_=null,o.fillStates={},o.textStrokeState_=null,o.strokeStates={},o.textState_={},o.textStates={},o.textKey_="",o.fillKey_="",o.strokeKey_="",o}return cr(e,t),e.prototype.finish=function(){var e=t.prototype.finish.call(this);return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e},e.prototype.drawText=function(t,e){var i=this.textFillState_,r=this.textStrokeState_,s=this.textState_;if(""!==this.text_&&s&&(i||r)){var o,l,a=this.coordinates.length,n=t.getType(),$=null,h=2,p=2;if(s.placement===_l.LINE){if(!ya(this.getBufferedMaxExtent(),t.getExtent()))return;var u=void 0;if($=t.getFlatCoordinates(),p=t.getStride(),n==aa.LINE_STRING)u=[$.length];else if(n==aa.MULTI_LINE_STRING)u=t.getEnds();else if(n==aa.POLYGON)u=t.getEnds().slice(0,1);else if(n==aa.MULTI_POLYGON){var f=t.getEndss();for(u=[],o=0,l=f.length;o<l;++o)u.push(f[o][0])}this.beginGeometry(t,e);for(var d=s.textAlign,c=0,_=void 0,x=0,g=u.length;x<g;++x){if(null==d){var S=br(s.maxAngle,$,c,u[x],p);c=S[0],_=S[1]}else _=u[x];for(o=c;o<_;o+=p)this.coordinates.push($[o],$[o+1]);h=this.coordinates.length,c=u[x];var y=this.declutterGroups_?0===x?this.declutterGroups_[0]:[].concat(this.declutterGroups_[0]):null;this.drawChars_(a,h,y),a=h}this.endGeometry(e)}else{var m=null;switch(s.overflow||(m=[]),n){case aa.POINT:case aa.MULTI_POINT:h=($=t.getFlatCoordinates()).length;break;case aa.LINE_STRING:$=t.getFlatMidpoint();break;case aa.CIRCLE:$=t.getCenter();break;case aa.MULTI_LINE_STRING:h=($=t.getFlatMidpoints()).length;break;case aa.POLYGON:$=t.getFlatInteriorPoint(),s.overflow||m.push($[2]/this.resolution),p=3;break;case aa.MULTI_POLYGON:var D=t.getFlatInteriorPoints();for($=[],o=0,l=D.length;o<l;o+=3)s.overflow||m.push(D[o+2]/this.resolution),$.push(D[o],D[o+1]);if(0==(h=$.length))return;}h=this.appendFlatCoordinates($,0,h,p,!1,!1),this.saveTextStates_(),(s.backgroundFill||s.backgroundStroke)&&(this.setFillStrokeStyle(s.backgroundFill,s.backgroundStroke),s.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),s.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);var w=this.pixelRatio;this.instructions.push([ga.DRAW_IMAGE,a,h,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1,NaN,s.padding==ed?ed:s.padding.map(function(t){return t*w}),!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]),this.hitDetectionInstructions.push([ga.DRAW_IMAGE,a,h,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1/this.pixelRatio,NaN,s.padding,!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,m]),this.endGeometry(e)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var s=this.textKey_;s in this.textStates||(this.textStates[s]={font:e.font,textAlign:e.textAlign||Bd,textBaseline:e.textBaseline||De,scale:e.scale});var o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))},e.prototype.drawChars_=function(t,e,i){var r=this.textStrokeState_,s=this.textState_,o=this.strokeKey_,l=this.textKey_,a=this.fillKey_;this.saveTextStates_();var n=this.pixelRatio,$=id[s.textBaseline],h=this.textOffsetY_*n,p=this.text_,u=s.scale,f=r?r.lineWidth*u/2:0;this.instructions.push([ga.DRAW_CHARS,t,e,$,i,s.overflow,a,s.maxAngle,n,h,o,f*n,p,l,1]),this.hitDetectionInstructions.push([ga.DRAW_CHARS,t,e,$,i,s.overflow,a,s.maxAngle,1,h,o,f,p,l,1/n])},e.prototype.setTextStyle=function(t,e){var i,r,s;if(t){this.declutterGroups_=e;var o=t.getFill();o?((r=this.textFillState_)||(r={},this.textFillState_=r),r.fillStyle=yb(o.getColor()||Gb)):(r=null,this.textFillState_=r);var l=t.getStroke();if(l){(s=this.textStrokeState_)||(s={},this.textStrokeState_=s);var a=l.getLineDash(),n=l.getLineDashOffset(),$=l.getWidth(),h=l.getMiterLimit();s.lineCap=l.getLineCap()||cd,s.lineDash=a?a.slice():Be,s.lineDashOffset=void 0===n?Ce:n,s.lineJoin=l.getLineJoin()||dd,s.lineWidth=void 0===$?Cd:$,s.miterLimit=void 0===h?zd:h,s.strokeStyle=yb(l.getColor()||Ad)}else s=null,this.textStrokeState_=s;i=this.textState_;var p=t.getFont()||ck;Go(p);var u=t.getScale();i.overflow=t.getOverflow(),i.font=p,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.textBaseline=t.getTextBaseline()||De,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||ed,i.scale=void 0===u?1:u;var f=t.getOffsetX(),d=t.getOffsetY(),c=t.getRotateWithView(),_=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===f?0:f,this.textOffsetY_=void 0===d?0:d,this.textRotateWithView_=void 0!==c&&c,this.textRotation_=void 0===_?0:_,this.strokeKey_=s?("string"==typeof s.strokeStyle?s.strokeStyle:da(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.textBaseline||"?"),this.fillKey_=r?"string"==typeof r.fillStyle?r.fillStyle:"|"+da(r.fillStyle):""}else this.text_=""},e}(hd);tf.default=am;var dr={Circle:pi,Default:hd,Image:Zl,LineString:$l,Polygon:pi,Text:am},bm=function(){function e(e,r,t,i,d){this.declutter_=d,this.declutterGroups_=null,this.tolerance_=e,this.maxExtent_=r,this.pixelRatio_=i,this.resolution_=t,this.buildersByZIndex_={}}return e.prototype.addDeclutter=function(e){var r=null;return this.declutter_&&(e?(r=this.declutterGroups_)[0][4]++:(r=[Ha()],this.declutterGroups_=r,r[0].push(1))),r},e.prototype.finish=function(){var e={};for(var r in this.buildersByZIndex_){e[r]=e[r]||{};var t=this.buildersByZIndex_[r];for(var i in t){var d=t[i].finish();e[r][i]=d}}return e},e.prototype.getBuilder=function(e,r){var t=void 0!==e?e.toString():"0",i=this.buildersByZIndex_[t];void 0===i&&(i={},this.buildersByZIndex_[t]=i);var d=i[r];void 0===d&&(d=new(0,dr[r])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[r]=d);return d},e}();function er(t,a,r,h,$,e,o,x,M,p,n){for(var P,i,v=[],w=t[a]>t[r-h],J=$.length,N=t[a],l=t[a+1],s=t[a+=h],I=t[a+1],f=0,u=Math.sqrt(Math.pow(s-N,2)+Math.pow(I-l,2)),d=!1,m=0;m<J;++m){for(var q=$[P=w?J-m-1:m],O=x*M(p,q,n),T=e+O/2;a<r-h&&f+u<T;)N=s,l=I,s=t[a+=h],I=t[a+1],f+=u,u=Math.sqrt(Math.pow(s-N,2)+Math.pow(I-l,2));var c=T-f,b=Math.atan2(I-l,s-N);if(w&&(b+=b>0?-Math.PI:Math.PI),void 0!==i){var g=b-i;if(d=d||0!==g,g+=g>Math.PI?-2*Math.PI:g<-Math.PI?2*Math.PI:0,Math.abs(g)>o)return null}i=b;var j=c/u,k=Rc(N,s,j),y=Rc(l,I,j);v[P]=[k,y,O/2,b,q],e+=O}return d?v:[[v[0][0],v[0][1],v[0][2],v[0][3],$]]}var qi,uf={},c=arguments[0];!function(t,i){"object"==typeof uf?uf=i():"function"==typeof qi&&qi.amd?qi(i):(t=t||self).RBush=i()}(uf,function(){function t(t,r,e,a,o){!function t(n,r,e,a,o){for(;a>e;){if(a-e>600){var h=a-e+1,s=r-e+1,l=Math.log(h),f=.5*Math.exp(2*l/3),p=.5*Math.sqrt(l*f*(h-f)/h)*(s-h/2<0?-1:1),u=Math.max(e,Math.floor(r-s*f/h+p)),m=Math.min(a,Math.floor(r+(h-s)*f/h+p));t(n,r,u,m,o)}var c=n[r],d=e,x=a;for(i(n,e,r),o(n[a],c)>0&&i(n,e,a);d<x;){for(i(n,d,x),d++,x--;o(n[d],c)<0;)d++;for(;o(n[x],c)>0;)x--}0===o(n[e],c)?i(n,e,x):i(n,++x,a),x<=r&&(e=x+1),r<=x&&(a=x-1)}}(t,r,e||0,a||t.length-1,o||n)}function i(t,i,n){var r=t[i];t[i]=t[n],t[n]=r}function n(t,i){return t<i?-1:t>i?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function e(t,i,n){if(!n)return i.indexOf(t);for(var r=0;r<i.length;r++)if(n(t,i[r]))return r;return-1}function a(t,i){o(t,0,t.children.length,i,t)}function o(t,i,n,r,e){e||(e=c(null)),e.minX=1/0,e.minY=1/0,e.maxX=-1/0,e.maxY=-1/0;for(var a=i;a<n;a++){var o=t.children[a];h(e,t.leaf?r(o):o)}return e}function h(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t}function s(t,i){return t.minX-i.minX}function l(t,i){return t.minY-i.minY}function f(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function p(t){return t.maxX-t.minX+(t.maxY-t.minY)}function u(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function m(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function c(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(i,n,r,e,a){for(var o=[n,r];o.length;)if(!((r=o.pop())-(n=o.pop())<=e)){var h=n+Math.ceil((r-n)/e/2)*e;t(i,h,n,r,a),o.push(n,h,h,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var i=this.data,n=[];if(!m(t,i))return n;for(var r=this.toBBox,e=[];i;){for(var a=0;a<i.children.length;a++){var o=i.children[a],h=i.leaf?r(o):o;m(t,h)&&(i.leaf?n.push(o):u(t,h)?this._all(o,n):e.push(o))}i=e.pop()}return n},r.prototype.collides=function(t){var i=this.data;if(!m(t,i))return!1;for(var n=[];i;){for(var r=0;r<i.children.length;r++){var e=i.children[r],a=i.leaf?this.toBBox(e):e;if(m(t,a)){if(i.leaf||u(t,a))return!0;n.push(e)}}i=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var i=0;i<t.length;i++)this.insert(t[i]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length){if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=c([]),this},r.prototype.remove=function(t,i){if(!t)return this;for(var n,r,a,o=this.data,h=this.toBBox(t),s=[],l=[];o||s.length;){if(o||(o=s.pop(),r=s[s.length-1],n=l.pop(),a=!0),o.leaf){var f=e(t,o.children,i);if(-1!==f)return o.children.splice(f,1),s.push(o),this._condense(s),this}a||o.leaf||!u(o,h)?r?(n++,o=r.children[n],a=!1):o=null:(s.push(o),l.push(n),n=0,r=o,o=o.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,i){return t.minX-i.minX},r.prototype.compareMinY=function(t,i){return t.minY-i.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,i){for(var n=[];t;)t.leaf?i.push.apply(i,t.children):n.push.apply(n,t.children),t=n.pop();return i},r.prototype._build=function(t,i,n,r){var e,o=n-i+1,h=this._maxEntries;if(o<=h)return a(e=c(t.slice(i,n+1)),this.toBBox),e;r||(r=Math.ceil(Math.log(o)/Math.log(h)),h=Math.ceil(o/Math.pow(h,r-1))),(e=c([])).leaf=!1,e.height=r;var s=Math.ceil(o/h),l=s*Math.ceil(Math.sqrt(h));d(t,i,n,l,this.compareMinX);for(var f=i;f<=n;f+=l){var p=Math.min(f+l-1,n);d(t,f,p,s,this.compareMinY);for(var u=f;u<=p;u+=s){var m=Math.min(u+s-1,p);e.children.push(this._build(t,u,m,r-1))}}return a(e,this.toBBox),e},r.prototype._chooseSubtree=function(t,i,n,r){for(;r.push(i),!i.leaf&&r.length-1!==n;){for(var e=1/0,a=1/0,o=void 0,h=0;h<i.children.length;h++){var s=i.children[h],l=f(s),p=(u=t,m=s,(Math.max(m.maxX,u.maxX)-Math.min(m.minX,u.minX))*(Math.max(m.maxY,u.maxY)-Math.min(m.minY,u.minY))-l);p<a?(a=p,e=l<e?l:e,o=s):p===a&&l<e&&(e=l,o=s)}i=o||i.children[0]}var u,m;return i},r.prototype._insert=function(t,i,n){var r=n?t:this.toBBox(t),e=[],a=this._chooseSubtree(r,this.data,i,e);for(a.children.push(t),h(a,r);i>=0&&e[i].children.length>this._maxEntries;)this._split(e,i),i--;this._adjustParentBBoxes(r,e,i)},r.prototype._split=function(t,i){var n=t[i],r=n.children.length,e=this._minEntries;this._chooseSplitAxis(n,e,r);var o=this._chooseSplitIndex(n,e,r),h=c(n.children.splice(o,n.children.length-o));h.height=n.height,h.leaf=n.leaf,a(n,this.toBBox),a(h,this.toBBox),i?t[i-1].children.push(h):this._splitRoot(n,h)},r.prototype._splitRoot=function(t,i){this.data=c([t,i]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,i,n){for(var r,e,a,h,s,l,p,u=1/0,m=1/0,c=i;c<=n-i;c++){var d=o(t,0,c,this.toBBox),x=o(t,c,n,this.toBBox),v=(e=d,a=x,h=void 0,s=void 0,l=void 0,p=void 0,h=Math.max(e.minX,a.minX),s=Math.max(e.minY,a.minY),l=Math.min(e.maxX,a.maxX),p=Math.min(e.maxY,a.maxY),Math.max(0,l-h)*Math.max(0,p-s)),M=f(d)+f(x);v<u?(u=v,r=c,m=M<m?M:m):v===u&&M<m&&(m=M,r=c)}return r||n-i},r.prototype._chooseSplitAxis=function(t,i,n){var r=t.leaf?this.compareMinX:s,e=t.leaf?this.compareMinY:l;this._allDistMargin(t,i,n,r)<this._allDistMargin(t,i,n,e)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,i,n,r){t.children.sort(r);for(var e=this.toBBox,a=o(t,0,i,e),s=o(t,n-i,n,e),l=p(a)+p(s),f=i;f<n-i;f++){var u=t.children[f];h(a,t.leaf?e(u):u),l+=p(a)}for(var m=n-i-1;m>=i;m--){var c=t.children[m];h(s,t.leaf?e(c):c),l+=p(s)}return l},r.prototype._adjustParentBBoxes=function(t,i,n){for(var r=n;r>=0;r--)h(i[r],t)},r.prototype._condense=function(t){for(var i=t.length-1,n=void 0;i>=0;i--)0===t[i].children.length?i>0?(n=t[i-1].children).splice(n.indexOf(t[i]),1):this.clear():a(t[i],this.toBBox)},r});var Ic=Ha(),Rd=Fa(),Ob=[],zb=[],Ab=[],Pb=[],fr=function(){function t(t,e,r,i){this.overlaps=r,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.declutterItems=[],this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=Fa(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={}}return t.prototype.createLabel=function(t,e,r,i){var a=t+e+r+i;if(this.labels_[a])return this.labels_[a];var $=i?this.strokeStates[i]:null,p=r?this.fillStates[r]:null,s=this.textStates[e],o=this.pixelRatio,n=s.scale*o,l=id[s.textAlign||Bd],h=i&&$.lineWidth?$.lineWidth:0,E=t.split("\n"),v=E.length,m=[],u=Io(s.font,E,m),c=Ho(s.font),K=c*v,Z=u+h,f=[],d={width:Math.ceil((Z+2)*n),height:Math.ceil((K+h)*n),contextInstructions:f};(1!=n&&f.push("scale",[n,n]),f.push("font",s.font),i)&&(f.push("strokeStyle",$.strokeStyle),f.push("lineWidth",h),f.push("lineCap",$.lineCap),f.push("lineJoin",$.lineJoin),f.push("miterLimit",$.miterLimit),(xe?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D).prototype.setLineDash&&(f.push("setLineDash",[$.lineDash]),f.push("lineDashOffset",$.lineDashOffset)));r&&f.push("fillStyle",p.fillStyle),f.push("textBaseline","middle"),f.push("textAlign","center");var _,x=.5-l,g=l*Z+x*h;if(i)for(_=0;_<v;++_)f.push("strokeText",[E[_],g+x*m[_],.5*(h+c)+_*c]);if(r)for(_=0;_<v;++_)f.push("fillText",[E[_],g+x*m[_],.5*(h+c)+_*c]);return this.labels_[a]=d,d},t.prototype.replayTextBackground_=function(t,e,r,i,a,$,p){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,r),t.lineTo.apply(t,i),t.lineTo.apply(t,a),t.lineTo.apply(t,e),$&&(this.alignFill_=$[2],this.fill_(t)),p&&(this.setStrokeStyle_(t,p),t.stroke())},t.prototype.replayImageOrLabel_=function(t,e,r,i,a,$,p,s,o,n,l,h,E,v,m,u,c,K){var Z=c||K;e-=a*=E,r-=$*=E;var f=m+n>i.width?i.width-n:m,d=s+l>i.height?i.height-l:s,_=u[3]+f*E+u[1],x=u[0]+d*E+u[2],g=e-u[3],T=r-u[0];(Z||0!==h)&&(Ob[0]=g,Pb[0]=g,Ob[1]=T,zb[1]=T,zb[0]=g+_,Ab[0]=zb[0],Ab[1]=T+x,Pb[1]=Ab[1]);var y=null;if(0!==h){var I=e+a,b=r+$;y=Ya(Rd,I,b,1,1,h,-I,-b),ta(Rd,Ob),ta(Rd,zb),ta(Rd,Ab),ta(Rd,Pb),nb(Math.min(Ob[0],zb[0],Ab[0],Pb[0]),Math.min(Ob[1],zb[1],Ab[1],Pb[1]),Math.max(Ob[0],zb[0],Ab[0],Pb[0]),Math.max(Ob[1],zb[1],Ab[1],Pb[1]),Ic)}else nb(g,T,g+_,T+x,Ic);var S=t.canvas,C=K?K[2]*E/2:0,k=Ic[0]-C<=S.width&&Ic[2]+C>=0&&Ic[1]-C<=S.height&&Ic[3]+C>=0;if(v&&(e=Math.round(e),r=Math.round(r)),p){if(!k&&1==p[4])return;Bg(p,Ic);var L=k?[t,y?y.slice(0):null,o,i,n,l,f,d,e,r,E]:null;L&&(Z&&L.push(c,K,Ob.slice(0),zb.slice(0),Ab.slice(0),Pb.slice(0)),p.push(L))}else k&&(Z&&this.replayTextBackground_(t,Ob,zb,Ab,Pb,c,K),gk(t,y,o,i,n,l,f,d,e,r,E))},t.prototype.fill_=function(t){if(this.alignFill_){var e=ta(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;t.save(),t.translate(e[0]%r,e[1]%r),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()},t.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.setLineDash&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},t.prototype.renderDeclutter=function(t,e,r,i){if(t&&t.length>5){var a=t[4];if(1==a||a==t.length-5){var $={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};var $C6Up$$interop$default=Hj(uf);if(i||(i=new $C6Up$$interop$default.d(9)),!i.collides($)){i.insert($);for(var p=5,s=t.length;p<s;++p){var o=t[p],n=o[0],l=n.globalAlpha;l!==r&&(n.globalAlpha=r),o.length>11&&this.replayTextBackground_(o[0],o[13],o[14],o[15],o[16],o[11],o[12]),gk.apply(void 0,o),l!==r&&(n.globalAlpha=l)}}t.length=5,Uc(t)}}return i},t.prototype.drawLabelWithPointPlacement_=function(t,e,r,i){var a=this.textStates[e],$=this.createLabel(t,e,i,r),p=this.strokeStates[r],s=this.pixelRatio,o=id[a.textAlign||Bd],n=id[a.textBaseline||De],l=p&&p.lineWidth?p.lineWidth:0;return{label:$,anchorX:o*($.width/s-2*a.scale)+2*(.5-o)*l,anchorY:n*$.height/s+2*(.5-n)*l}},t.prototype.execute_=function(t,e,r,i,a,$){var p;this.declutterItems.length=0,this.pixelCoordinates_&&Vb(e,this.renderedTransform_)?p=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),p=Dc(this.coordinates,0,this.coordinates.length,2,e,this.pixelCoordinates_),zo(this.renderedTransform_,e));for(var s,o,n,l,h,E,v,m,u,c,K,Z,f,d,_,x,g,T=0,y=r.length,I=0,b=0,S=0,C=null,k=null,L=this.coordinateCache_,R=this.viewRotation_,O=Math.round(1e12*Math.atan2(-e[1],e[0]))/1e12,w={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:R},A=this.instructions!=r||this.overlaps?0:200;T<y;){var D=r[T];switch(D[0]){case ga.BEGIN_GEOMETRY:(_=D[1]).getGeometry()?void 0===$||ya($,D[3])?++T:T=D[2]+1:T=D[2];break;case ga.BEGIN_PATH:b>A&&(this.fill_(t),b=0),S>A&&(t.stroke(),S=0),b||S||(t.beginPath(),l=NaN,h=NaN),++T;break;case ga.CIRCLE:var M=p[I=D[1]],q=p[I+1],N=p[I+2]-M,P=p[I+3]-q,W=Math.sqrt(N*N+P*P);t.moveTo(M+W,q),t.arc(M,q,W,0,2*Math.PI,!0),++T;break;case ga.CLOSE_PATH:t.closePath(),++T;break;case ga.CUSTOM:I=D[1],s=D[2];var j=D[3],B=D[4],F=6==D.length?D[5]:void 0;w.geometry=j,w.feature=_,T in L||(L[T]=[]);var G=L[T];F?F(p,I,s,2,G):(G[0]=p[I],G[1]=p[I+1],G.length=2),B(G,w),++T;break;case ga.DRAW_IMAGE:I=D[1],s=D[2],c=D[3],o=D[4],n=D[5],u=a?null:D[6];var X=D[7],Y=D[8],H=D[9],U=D[10],J=D[11],V=D[12],z=D[13],Q=D[14];if(!c&&D.length>=19){K=D[18],Z=D[19],f=D[20],d=D[21];var tt=this.drawLabelWithPointPlacement_(K,Z,f,d);c=tt.label,D[3]=c;var et=D[22];o=(tt.anchorX-et)*this.pixelRatio,D[4]=o;var rt=D[23];n=(tt.anchorY-rt)*this.pixelRatio,D[5]=n,X=c.height,D[7]=X,Q=c.width,D[14]=Q}var it=void 0;D.length>24&&(it=D[24]);var at=void 0,$t=void 0,pt=void 0;D.length>16?(at=D[15],$t=D[16],pt=D[17]):(at=ed,$t=!1,pt=!1),J&&O?V+=R:J||O||(V-=R);for(var st=0,ot=0;I<s;I+=2)if(!(it&&it[st++]<Q/this.pixelRatio)){if(u){var nt=Math.floor(ot);u.length<nt+1&&((m=Ha()).push(u[0][4]),u.push(m)),m=u[nt]}this.replayImageOrLabel_(t,p[I],p[I+1],c,o,n,m,X,Y,H,U,V,z,i,Q,at,$t?C:null,pt?k:null),m&&(ot===Math.floor(ot)&&this.declutterItems.push(this,m,_),ot+=1/m[4])}++T;break;case ga.DRAW_CHARS:var lt=D[1],ht=D[2],Et=D[3];m=a?null:D[4];var vt=D[5];d=D[6];var mt=D[7],ut=D[8],ct=D[9];f=D[10];var Kt=D[11];K=D[12],Z=D[13];var Zt=D[14],ft=this.textStates[Z],dt=ft.font,_t=ft.scale*ut,xt=void 0;dt in this.widths_?xt=this.widths_[dt]:(xt={},this.widths_[dt]=xt);var gt=Sl(p,lt,ht,2),Tt=_t*ek(dt,K,xt);if(vt||Tt<=gt){var yt=this.textStates[Z].textAlign,It=(gt-Tt)*id[yt],bt=er(p,lt,ht,2,K,It,mt,_t,ek,dt,xt);if(bt){var St=void 0,Ct=void 0,kt=void 0,Lt=void 0,Rt=void 0;if(f)for(St=0,Ct=bt.length;St<Ct;++St)kt=(Rt=bt[St])[4],Lt=this.createLabel(kt,Z,"",f),o=Rt[2]+Kt,n=Et*Lt.height+2*(.5-Et)*Kt-ct,this.replayImageOrLabel_(t,Rt[0],Rt[1],Lt,o,n,m,Lt.height,1,0,0,Rt[3],Zt,!1,Lt.width,ed,null,null);if(d)for(St=0,Ct=bt.length;St<Ct;++St)kt=(Rt=bt[St])[4],Lt=this.createLabel(kt,Z,d,""),o=Rt[2],n=Et*Lt.height-ct,this.replayImageOrLabel_(t,Rt[0],Rt[1],Lt,o,n,m,Lt.height,1,0,0,Rt[3],Zt,!1,Lt.width,ed,null,null)}}this.declutterItems.push(this,m,_),++T;break;case ga.END_GEOMETRY:if(void 0!==a){var Ot=a(_=D[1]);if(Ot)return Ot}++T;break;case ga.FILL:A?b++:this.fill_(t),++T;break;case ga.MOVE_TO_LINE_TO:for(I=D[1],s=D[2],x=p[I],v=(g=p[I+1])+.5|0,(E=x+.5|0)===l&&v===h||(t.moveTo(x,g),l=E,h=v),I+=2;I<s;I+=2)E=(x=p[I])+.5|0,v=(g=p[I+1])+.5|0,I!=s-2&&E===l&&v===h||(t.lineTo(x,g),l=E,h=v);++T;break;case ga.SET_FILL_STYLE:C=D,this.alignFill_=D[2],b&&(this.fill_(t),b=0,S&&(t.stroke(),S=0)),t.fillStyle=D[1],++T;break;case ga.SET_STROKE_STYLE:k=D,S&&(t.stroke(),S=0),this.setStrokeStyle_(t,D),++T;break;case ga.STROKE:A?S++:t.stroke(),++T;break;default:++T;}}b&&this.fill_(t),S&&t.stroke()},t.prototype.execute=function(t,e,r,i){this.viewRotation_=r,this.execute_(t,e,this.instructions,i,void 0,void 0)},t.prototype.executeHitDetection=function(t,e,r,i,a){return this.viewRotation_=r,this.execute_(t,e,this.hitDetectionInstructions,!0,i,a)},t}();var ri=[ka.POLYGON,ka.CIRCLE,ka.LINE_STRING,ka.IMAGE,ka.TEXT,ka.DEFAULT],cm=function(){function r(r,e,t,i,o,n){this.maxExtent_=r,this.overlaps_=i,this.pixelRatio_=t,this.resolution_=e,this.renderBuffer_=n,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Fa(),this.createExecutors_(o)}return r.prototype.clip=function(r,e){var t=this.getClipCoords(e);r.beginPath(),r.moveTo(t[0],t[1]),r.lineTo(t[2],t[3]),r.lineTo(t[4],t[5]),r.lineTo(t[6],t[7]),r.clip()},r.prototype.createExecutors_=function(r){for(var e in r){var t=this.executorsByZIndex_[e];void 0===t&&(t={},this.executorsByZIndex_[e]=t);var i=r[e];for(var o in i){var n=i[o];t[o]=new fr(this.resolution_,this.pixelRatio_,this.overlaps_,n)}}},r.prototype.hasExecutors=function(r){for(var e in this.executorsByZIndex_)for(var t=this.executorsByZIndex_[e],i=0,o=r.length;i<o;++i)if(r[i]in t)return!0;return!1},r.prototype.forEachFeatureAtCoordinate=function(r,e,t,i,o,n){var $=2*(i=Math.round(i))+1,c=Ya(this.hitDetectionTransform_,i+.5,i+.5,1/e,-1/e,-t,-r[0],-r[1]);this.hitDetectionContext_||(this.hitDetectionContext_=Ea($,$));var a,l=this.hitDetectionContext_;l.canvas.width!==$||l.canvas.height!==$?(l.canvas.width=$,l.canvas.height=$):l.clearRect(0,0,$,$),void 0!==this.renderBuffer_&&(a=Ha(),Vc(a,r),db(a,e*(this.renderBuffer_+i),a));var s,p=gr(i);function u(r){for(var e=l.getImageData(0,0,$,$).data,t=0;t<$;t++)for(var i=0;i<$;i++)if(p[t][i]&&e[4*(i*$+t)+3]>0){var c=void 0;return(!n||s!=ka.IMAGE&&s!=ka.TEXT||-1!==n.indexOf(r))&&(c=o(r)),c||void l.clearRect(0,0,$,$)}}var E,g,f,v,d,h=Object.keys(this.executorsByZIndex_).map(Number);for(h.sort(Ub),E=h.length-1;E>=0;--E){var x=h[E].toString();for(f=this.executorsByZIndex_[x],g=ri.length-1;g>=0;--g)if(void 0!==(v=f[s=ri[g]])&&(d=v.executeHitDetection(l,c,t,u,a)))return d}},r.prototype.getClipCoords=function(r){var e=this.maxExtent_;if(!e)return null;var t=e[0],i=e[1],o=e[2],n=e[3],$=[t,i,t,n,o,n,o,i];return Dc($,0,8,2,r,$),$},r.prototype.isEmpty=function(){return be(this.executorsByZIndex_)},r.prototype.execute=function(r,e,t,i,o,n){var $=Object.keys(this.executorsByZIndex_).map(Number);$.sort(Ub),this.maxExtent_&&(r.save(),this.clip(r,e));var c,a,l,s,p,u,E=o||ri;for(c=0,a=$.length;c<a;++c){var g=$[c].toString();for(p=this.executorsByZIndex_[g],l=0,s=E.length;l<s;++l){var f=E[l];if(void 0!==(u=p[f]))if(!n||f!=ka.IMAGE&&f!=ka.TEXT)u.execute(r,e,t,i);else{var v=n[g];v?v.push(u,e.slice(0)):n[g]=[u,e.slice(0)]}}}this.maxExtent_&&r.restore()},r}(),si={0:[[!0]]};function dc(r,e,t){var i,o=Math.floor(r.length/2);if(e>=o)for(i=o;i<e;i++)r[i][t]=!0;else if(e<o)for(i=e+1;i<o;i++)r[i][t]=!0}function gr(r){if(void 0!==si[r])return si[r];for(var e=2*r+1,t=new Array(e),i=0;i<e;i++)t[i]=new Array(e);for(var o=r,n=0,$=0;o>=n;)dc(t,r+o,r+n),dc(t,r+n,r+o),dc(t,r-n,r+o),dc(t,r-o,r+n),dc(t,r-o,r-n),dc(t,r-n,r-o),dc(t,r+n,r-o),dc(t,r+o,r-n),2*(($+=1+2*++n)-o)+1>0&&($+=1-2*(o-=1));return si[r]=t,t}function dm(r,e,t,i,o,n){for(var $=Object.keys(r).map(Number).sort(Ub),c=0,a=$.length;c<a;++c)for(var l=r[$[c].toString()],s=void 0,p=0,u=l.length;p<u;){var E=l[p++];E!==s&&(s=E,n.push({items:E.declutterItems,opacity:i}));var g=l[p++];E.execute(e,g,t,o)}}function em(e,t,r,a,o,i,n){var $=e[0]/2,c=e[1]/2,m=Ea($,c);m.imageSmoothingEnabled=!1;for(var g=m.canvas,p=new Ch(m,.5,o,null,n),s=r.length,h=Math.floor(16777215/s),l={},C=1;C<=s;++C){var v=r[C-1],M=v.getStyleFunction()||a;if(a){var u=M(v,i);if(u){Array.isArray(u)||(u=[u]);for(var d="#"+("000000"+(C*h).toString(16)).slice(-6),y=0,f=u.length;y<f;++y){var I=u[y],x=I.clone(),S=x.getFill();S&&S.setColor(d);var D=x.getStroke();D&&D.setColor(d),x.setText(void 0);var w=I.getImage();if(w){var T=w.getImageSize();if(!T)continue;var G=document.createElement("canvas");G.width=T[0],G.height=T[1];var j=G.getContext("2d",{alpha:!1});j.fillStyle=d;var q=j.canvas;j.fillRect(0,0,q.width,q.height);var E=T?T[0]:q.width,b=T?T[1]:q.height;Ea(E,b).drawImage(q,0,0),x.setImage(new vi({img:q,imgSize:T,anchor:w.getAnchor(),anchorXUnits:ec.PIXELS,anchorYUnits:ec.PIXELS,offset:w.getOrigin(),size:w.getSize(),opacity:w.getOpacity(),scale:w.getScale(),rotation:w.getRotation(),rotateWithView:w.getRotateWithView()}))}var A=Number(x.getZIndex());(L=l[A])||(L={},l[A]=L,L[aa.POLYGON]=[],L[aa.CIRCLE]=[],L[aa.LINE_STRING]=[],L[aa.POINT]=[]);var N=x.getGeometryFunction()(v);N&&ya(o,N.getExtent())&&L[N.getType().replace("Multi","")].push(N,x)}}}}for(var O=Object.keys(l).map(Number).sort(Ub),R=(C=0,O.length);C<R;++C){var L=l[O[C]];for(var U in L){var z=L[U];for(y=0,f=z.length;y<f;y+=2){p.setStyle(z[y+1]);for(var F=0,P=t.length;F<P;++F)p.setTransform(t[F]),p.drawGeometry(z[y])}}}return document.body.appendChild(m.canvas),m.getImageData(0,0,g.width,g.height)}function fm(e,t,r){var a=[];if(r){var o=4*(Math.round(e[0]/2)+Math.round(e[1]/2)*r.width),i=r.data[o],n=r.data[o+1],$=r.data[o+2]+256*(n+256*i),c=Math.floor(16777215/t.length);$&&$%c==0&&a.push(t[$/c-1])}return a}var ti={};var ec={FRACTION:"fraction",PIXELS:"pixels"};var vf={};var wf={};var ui={};var hr=ui&&ui.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),xf=function(t){function e(e,r,o,n){var p=t.call(this)||this;return p.extent=e,p.pixelRatio_=o,p.resolution=r,p.state=n,p}return hr(e,t),e.prototype.changed=function(){this.dispatchEvent(ca.CHANGE)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return ma()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){ma()},e}(qc);ui.default=xf;var ir=wf&&wf.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Sd=function(t){function e(e,n,i,r,o,a){var $=t.call(this,e,n,i,ia.IDLE)||this;return $.src_=r,$.image_=new Image,null!==o&&($.image_.crossOrigin=o),$.unlisten_=null,$.state=ia.IDLE,$.imageLoadFunction_=a,$}return ir(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=ia.ERROR,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=va(this.extent)/this.image_.height),this.state=ia.LOADED,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state!=ia.IDLE&&this.state!=ia.ERROR||(this.state=ia.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=yf(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(xf);function yf(t,e,n){var i=t;if(i.src&&$j){var r=i.decode(),o=!0;return r.then(function(){o&&e()}).catch(function(t){o&&("EncodingError"===t.name&&"Invalid image type."===t.message?e():n())}),function(){o=!1}}var a=[Qc(i,ca.LOAD,e),Qc(i,ca.ERROR,n)];return function(){a.forEach(ra)}}wf.listenImage=yf,wf.default=Sd;var jr=vf&&vf.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function a(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),gm=function(t){function e(e,i,a,n,r,s){var o=t.call(this)||this;return o.hitDetectionImage_=null,o.image_=e||new Image,null!==n&&(o.image_.crossOrigin=n),o.canvas_=s?document.createElement("canvas"):null,o.color_=s,o.unlisten_=null,o.imageState_=r,o.size_=a,o.src_=i,o.tainted_,o}return jr(e,t),e.prototype.isTainted_=function(t){if(void 0===this.tainted_&&this.imageState_===ia.LOADED){t||(t=Ea(1,1)).drawImage(this.image_,0,0);try{t.getImageData(0,0,1,1),this.tainted_=!1}catch(e){this.tainted_=!0}}return!0===this.tainted_},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(ca.CHANGE)},e.prototype.handleImageError_=function(){this.imageState_=ia.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=ia.LOADED,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.replaceColor_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.canvas_?this.canvas_:this.image_},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(t){if(!this.hitDetectionImage_)if(this.isTainted_()){var e=this.size_[0],i=this.size_[1],a=Ea(e,i);a.fillRect(0,0,e,i),this.hitDetectionImage_=a.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==ia.IDLE){this.imageState_=ia.LOADING;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=yf(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},e.prototype.replaceColor_=function(){if(this.color_){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var t=this.canvas_.getContext("2d");if(t.drawImage(this.image_,0,0),this.isTainted_(t)){var e=this.color_;return t.globalCompositeOperation="multiply",t.fillStyle="rgb("+e[0]+","+e[1]+","+e[2]+")",t.fillRect(0,0,this.image_.width,this.image_.height),t.globalCompositeOperation="destination-in",void t.drawImage(this.image_,0,0)}for(var i=t.getImageData(0,0,this.image_.width,this.image_.height),a=i.data,n=this.color_[0]/255,r=this.color_[1]/255,s=this.color_[2]/255,o=0,h=a.length;o<h;o+=4)a[o]*=n,a[o+1]*=r,a[o+2]*=s;t.putImageData(i,0,0)}},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(qc);function hm(t,e,i,a,n,r){var s=cf.get(e,a,r);return s||(s=new gm(t,e,i,a,n,r),cf.set(e,a,r,s)),s}vf.get=hm,vf.default=gm;var ib={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};var kr=ti&&ti.__extends||function(){var i=function(t,o){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var o in t)t.hasOwnProperty(o)&&(i[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}i(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),vi=function(i){function t(t){var o=this,r=t||{},n=void 0!==r.opacity?r.opacity:1,e=void 0!==r.rotation?r.rotation:0,s=void 0!==r.scale?r.scale:1,c=void 0!==r.rotateWithView&&r.rotateWithView;(o=i.call(this,{opacity:n,rotation:e,scale:s,displacement:void 0!==r.displacement?r.displacement:[0,0],rotateWithView:c})||this).anchor_=void 0!==r.anchor?r.anchor:[.5,.5],o.normalizedAnchor_=null,o.anchorOrigin_=void 0!==r.anchorOrigin?r.anchorOrigin:ib.TOP_LEFT,o.anchorXUnits_=void 0!==r.anchorXUnits?r.anchorXUnits:ec.FRACTION,o.anchorYUnits_=void 0!==r.anchorYUnits?r.anchorYUnits:ec.FRACTION,o.crossOrigin_=void 0!==r.crossOrigin?r.crossOrigin:null;var a=void 0!==r.img?r.img:null,h=void 0!==r.imgSize?r.imgSize:null,$=r.src;ea(!(void 0!==$&&a),4),ea(!a||a&&h,5),void 0!==$&&0!==$.length||!a||($=a.src||da(a)),ea(void 0!==$&&$.length>0,6);var g=void 0!==r.src?ia.IDLE:ia.LOADED;return o.color_=void 0!==r.color?il(r.color):null,o.iconImage_=hm(a,$,h,o.crossOrigin_,g,o.color_),o.offset_=void 0!==r.offset?r.offset:[0,0],o.offsetOrigin_=void 0!==r.offsetOrigin?r.offsetOrigin:ib.TOP_LEFT,o.origin_=null,o.size_=void 0!==r.size?r.size:null,o}return kr(t,i),t.prototype.clone=function(){return new t({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},t.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var i=this.anchor_,t=this.getSize();if(this.anchorXUnits_==ec.FRACTION||this.anchorYUnits_==ec.FRACTION){if(!t)return null;i=this.anchor_.slice(),this.anchorXUnits_==ec.FRACTION&&(i[0]*=t[0]),this.anchorYUnits_==ec.FRACTION&&(i[1]*=t[1])}if(this.anchorOrigin_!=ib.TOP_LEFT){if(!t)return null;i===this.anchor_&&(i=this.anchor_.slice()),this.anchorOrigin_!=ib.TOP_RIGHT&&this.anchorOrigin_!=ib.BOTTOM_RIGHT||(i[0]=-i[0]+t[0]),this.anchorOrigin_!=ib.BOTTOM_LEFT&&this.anchorOrigin_!=ib.BOTTOM_RIGHT||(i[1]=-i[1]+t[1])}return this.normalizedAnchor_=i,this.normalizedAnchor_},t.prototype.setAnchor=function(i){this.anchor_=i,this.normalizedAnchor_=null},t.prototype.getColor=function(){return this.color_},t.prototype.getImage=function(i){return this.iconImage_.getImage(i)},t.prototype.getImageSize=function(){return this.iconImage_.getSize()},t.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},t.prototype.getImageState=function(){return this.iconImage_.getImageState()},t.prototype.getHitDetectionImage=function(i){return this.iconImage_.getHitDetectionImage(i)},t.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var i=this.offset_,t=this.getDisplacement();if(this.offsetOrigin_!=ib.TOP_LEFT){var o=this.getSize(),r=this.iconImage_.getSize();if(!o||!r)return null;i=i.slice(),this.offsetOrigin_!=ib.TOP_RIGHT&&this.offsetOrigin_!=ib.BOTTOM_RIGHT||(i[0]=r[0]-o[0]-i[0]),this.offsetOrigin_!=ib.BOTTOM_LEFT&&this.offsetOrigin_!=ib.BOTTOM_RIGHT||(i[1]=r[1]-o[1]-i[1])}return i[0]+=t[0],i[1]+=t[1],this.origin_=i,this.origin_},t.prototype.getSrc=function(){return this.iconImage_.getSrc()},t.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},t.prototype.listenImageChange=function(i){this.iconImage_.addEventListener(ca.CHANGE,i)},t.prototype.load=function(){this.iconImage_.load()},t.prototype.unlistenImageChange=function(i){this.iconImage_.removeEventListener(ca.CHANGE,i)},t}(Tl);ti.default=vi;var lr="#333",im=function(){function t(t){var e=t||{};this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.text_=e.text,this.textAlign_=e.textAlign,this.textBaseline_=e.textBaseline,this.fill_=void 0!==e.fill?e.fill:new bc({color:lr}),this.maxAngle_=void 0!==e.maxAngle?e.maxAngle:Math.PI/4,this.placement_=void 0!==e.placement?e.placement:_l.POINT,this.overflow_=!!e.overflow,this.stroke_=void 0!==e.stroke?e.stroke:null,this.offsetX_=void 0!==e.offsetX?e.offsetX:0,this.offsetY_=void 0!==e.offsetY?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=void 0===e.padding?null:e.padding}return t.prototype.clone=function(){return new t({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:this.getScale(),text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()})},t.prototype.getOverflow=function(){return this.overflow_},t.prototype.getFont=function(){return this.font_},t.prototype.getMaxAngle=function(){return this.maxAngle_},t.prototype.getPlacement=function(){return this.placement_},t.prototype.getOffsetX=function(){return this.offsetX_},t.prototype.getOffsetY=function(){return this.offsetY_},t.prototype.getFill=function(){return this.fill_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getStroke=function(){return this.stroke_},t.prototype.getText=function(){return this.text_},t.prototype.getTextAlign=function(){return this.textAlign_},t.prototype.getTextBaseline=function(){return this.textBaseline_},t.prototype.getBackgroundFill=function(){return this.backgroundFill_},t.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},t.prototype.getPadding=function(){return this.padding_},t.prototype.setOverflow=function(t){this.overflow_=t},t.prototype.setFont=function(t){this.font_=t},t.prototype.setMaxAngle=function(t){this.maxAngle_=t},t.prototype.setOffsetX=function(t){this.offsetX_=t},t.prototype.setOffsetY=function(t){this.offsetY_=t},t.prototype.setPlacement=function(t){this.placement_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setFill=function(t){this.fill_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.setText=function(t){this.text_=t},t.prototype.setTextAlign=function(t){this.textAlign_=t},t.prototype.setTextBaseline=function(t){this.textBaseline_=t},t.prototype.setBackgroundFill=function(t){this.backgroundFill_=t},t.prototype.setBackgroundStroke=function(t){this.backgroundStroke_=t},t.prototype.setPadding=function(t){this.padding_=t},t}();var mr=ki&&ki.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),wi=function(e){function t(t){var r=e.call(this,t)||this;return r.boundHandleStyleImageChange_=r.handleStyleImageChange_.bind(r),r.animatingOrInteracting_,r.dirty_=!1,r.hitDetectionImageData_=null,r.renderedFeatures_=null,r.renderedRevision_=-1,r.renderedResolution_=NaN,r.renderedExtent_=Ha(),r.renderedRotation_,r.renderedCenter_=null,r.renderedProjection_=null,r.renderedRenderOrder_=null,r.replayGroup_=null,r.replayGroupChanged=!0,r}return mr(t,e),t.prototype.useContainer=function(t,r,i){i<1&&(t=null),e.prototype.useContainer.call(this,t,r,i)},t.prototype.renderFrame=function(e,t){var r=e.pixelRatio,i=e.layerStatesArray[e.layerIndex];Bo(this.pixelTransform,1/r,1/r),yd(this.inversePixelTransform,this.pixelTransform);var n=Lg(this.pixelTransform);this.useContainer(t,n,i.opacity);var a=this.context,o=a.canvas,s=this.replayGroup_;if(!s||s.isEmpty())return!this.containerReused&&o.width>0&&(o.width=0),this.container;var $=Math.round(e.size[0]*r),d=Math.round(e.size[1]*r);o.width!=$||o.height!=d?(o.width=$,o.height=d,o.style.transform!==n&&(o.style.transform=n)):this.containerReused||a.clearRect(0,0,$,d),this.preRender(a,e);var p=e.extent,u=e.viewState,h=u.center,c=u.resolution,l=u.projection,g=u.rotation,m=l.getExtent(),F=this.getLayer().getSource(),f=!1;if(i.extent){var v=Ua(i.extent,l);(f=!La(v,e.extent)&&ya(v,e.extent))&&this.clip(a,e,v)}var _=e.viewHints,y=!(_[qa.ANIMATING]||_[qa.INTERACTING]),x=this.getRenderTransform(h,c,g,r,$,d,0),R=this.getLayer().getDeclutter()?{}:null;if(s.execute(a,x,g,y,void 0,R),F.getWrapX()&&l.canWrapX()&&!La(m,p)){for(var I=p[0],w=la(m),E=0,T=void 0;I<m[0];){T=w*--E;var C=this.getRenderTransform(h,c,g,r,$,d,T);s.execute(a,C,g,y,void 0,R),I+=w}for(E=0,I=p[2];I>m[2];){T=w*++E;var j=this.getRenderTransform(h,c,g,r,$,d,T);s.execute(a,j,g,y,void 0,R),I-=w}}if(R){var G=e.viewHints,S=!(G[qa.ANIMATING]||G[qa.INTERACTING]);dm(R,a,g,1,S,e.declutterItems)}f&&a.restore(),this.postRender(a,e);var A=i.opacity,D=this.container;return A!==parseFloat(D.style.opacity)&&(D.style.opacity=1===A?"":A),this.container},t.prototype.getFeatures=function(e){return new Promise(function(t,r){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var i=[this.context.canvas.width,this.context.canvas.height];ta(this.pixelTransform,i);var n=this.renderedCenter_,a=this.renderedResolution_,o=this.renderedRotation_,s=this.renderedProjection_,$=this.renderedExtent_,d=this.getLayer(),p=[],u=i[0]/2,h=i[1]/2;p.push(this.getRenderTransform(n,a,o,.5,u,h,0).slice());var c=d.getSource(),l=s.getExtent();if(c.getWrapX()&&s.canWrapX()&&!La(l,$)){for(var g=$[0],m=la(l),F=0,f=void 0;g<l[0];)f=m*--F,p.push(this.getRenderTransform(n,a,o,.5,u,h,f).slice()),g+=m;for(F=0,g=$[2];g>l[2];)f=m*++F,p.push(this.getRenderTransform(n,a,o,.5,u,h,f).slice()),g-=m}this.hitDetectionImageData_=em(i,p,this.renderedFeatures_,d.getStyleFunction(),$,a,o)}t(fm(e,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},t.prototype.forEachFeatureAtCoordinate=function(e,t,r,i,n){if(this.replayGroup_){var a=t.viewState.resolution,o=t.viewState.rotation,s=this.getLayer(),$={};return this.replayGroup_.forEachFeatureAtCoordinate(e,a,o,r,function(e){var t=da(e);if(!(t in $))return $[t]=!0,i(e,s)},s.getDeclutter()?n:null)}},t.prototype.handleFontsChanged=function(){var e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()},t.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},t.prototype.prepareFrame=function(e){var t=this.getLayer(),r=t.getSource();if(!r)return!1;var i=e.viewHints[qa.ANIMATING],n=e.viewHints[qa.INTERACTING],a=t.getUpdateWhileAnimating(),o=t.getUpdateWhileInteracting();if(!this.dirty_&&!a&&i||!o&&n)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var s=e.extent,$=e.viewState,d=$.projection,p=$.resolution,u=e.pixelRatio,h=t.getRevision(),c=t.getRenderBuffer(),l=t.getRenderOrder();void 0===l&&(l=Qp);var g=$.center.slice(),m=db(s,c*p),F=[m.slice()],f=d.getExtent();if(r.getWrapX()&&d.canWrapX()&&!La(f,e.extent)){var v=la(f),_=Math.max(la(m)/2,v);m[0]=f[0]-_,m[2]=f[2]+_,bh(g,d);var y=Qj(F[0],d);y[0]<f[0]&&y[2]<f[2]?F.push([y[0]+v,y[1],y[2]+v,y[3]]):y[0]>f[0]&&y[2]>f[2]&&F.push([y[0]-v,y[1],y[2]-v,y[3]])}if(!this.dirty_&&this.renderedResolution_==p&&this.renderedRevision_==h&&this.renderedRenderOrder_==l&&La(this.renderedExtent_,m))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var x,R=new bm(pl(p,u),m,p,u,t.getDeclutter()),I=Ra();if(I){for(var w=0,E=F.length;w<E;++w)r.loadFeatures($c(F[w],d),p,I);x=mb(I,d)}else for(w=0,E=F.length;w<E;++w)r.loadFeatures(F[w],p,d);var T=Dh(p,u),C=function(e){var r,i=e.getStyleFunction()||t.getStyleFunction();if(i&&(r=i(e,p)),r){var n=this.renderFeature(e,T,r,R,x);this.dirty_=this.dirty_||n}}.bind(this),j=$c(m,d),G=r.getFeaturesInExtent(j);l&&G.sort(l);for(w=0,E=G.length;w<E;++w)C(G[w]);this.renderedFeatures_=G;var S=R.finish(),A=new cm(m,p,u,r.getOverlaps(),S,t.getRenderBuffer());return this.renderedResolution_=p,this.renderedRevision_=h,this.renderedRenderOrder_=l,this.renderedExtent_=m,this.renderedRotation_=$.rotation,this.renderedCenter_=g,this.renderedProjection_=d,this.replayGroup_=A,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},t.prototype.renderFeature=function(e,t,r,i,n){if(!r)return!1;var a=!1;if(Array.isArray(r))for(var o=0,s=r.length;o<s;++o)a=df(i,e,r[o],t,this.boundHandleStyleImageChange_,n)||a;else a=df(i,e,r,t,this.boundHandleStyleImageChange_,n);return a},t}(Ge);ki.default=wi;var nr=fi&&fi.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function o(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),fc=function(e){function r(r){return e.call(this,r)||this}return nr(r,e),r.prototype.createRenderer=function(){return new wi(this)},r}(Qd);fi.default=fc;var zf={};var Td={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};var or=!1;function jm(e,t,r,$){return function(o,a,s){var i=new XMLHttpRequest;i.open("GET","function"==typeof e?e(o,a,s):e,!0),t.getType()==Td.ARRAY_BUFFER&&(i.responseType="arraybuffer"),i.withCredentials=or,i.onload=function(e){if(!i.status||i.status>=200&&i.status<300){var a=t.getType(),n=void 0;a==Td.JSON||a==Td.TEXT?n=i.responseText:a==Td.XML?(n=i.responseXML)||(n=new DOMParser().parseFromString(i.responseText,"application/xml")):a==Td.ARRAY_BUFFER&&(n=i.response),n?r.call(this,t.readFeatures(n,{extent:o,featureProjection:s}),t.readProjection(n)):$.call(this)}else $.call(this)}.bind(this),i.onerror=function(){$.call(this)}.bind(this),i.send()}}function km(e,t){return jm(e,t,function(e,t){"function"==typeof this.addFeatures&&this.addFeatures(e)},tb)}function pr(t,e){return[[-1/0,-1/0,1/0,1/0]]}var xi={};var qr=xi&&xi.__extends||function(){var t=function(r,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])})(r,o)};return function(r,o){function e(){this.constructor=r}t(r,o),r.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}}(),jd=function(t){function r(r){var o=t.call(this)||this;return o.projection_=pa(r.projection),o.attributions_=lm(r.attributions),o.attributionsCollapsible_=void 0===r.attributionsCollapsible||r.attributionsCollapsible,o.loading=!1,o.state_=void 0!==r.state?r.state:Aa.READY,o.wrapX_=void 0!==r.wrapX&&r.wrapX,o}return qr(r,t),r.prototype.getAttributions=function(){return this.attributions_},r.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},r.prototype.getProjection=function(){return this.projection_},r.prototype.getResolutions=function(){return ma()},r.prototype.getState=function(){return this.state_},r.prototype.getWrapX=function(){return this.wrapX_},r.prototype.refresh=function(){this.changed()},r.prototype.setAttributions=function(t){this.attributions_=lm(t),this.changed()},r.prototype.setState=function(t){this.state_=t,this.changed()},r}(Ta);function lm(t){return t?Array.isArray(t)?function(r){return t}:"function"==typeof t?t:function(r){return[t]}:null}xi.default=jd;var Sa={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"};var Af=function(){function t(t){var $C6Up$$interop$default=Hj(uf);this.rbush_=new $C6Up$$interop$default.d(t),this.items_={}}return t.prototype.insert=function(t,r){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:r};this.rbush_.insert(i),this.items_[da(r)]=i},t.prototype.load=function(t,r){for(var i=new Array(r.length),e=0,n=r.length;e<n;e++){var o=t[e],s=r[e],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};i[e]=u,this.items_[da(s)]=u}this.rbush_.load(i)},t.prototype.remove=function(t){var r=da(t),i=this.items_[r];return delete this.items_[r],null!==this.rbush_.remove(i)},t.prototype.update=function(t,r){var i=this.items_[da(r)],e=[i.minX,i.minY,i.maxX,i.maxY];eb(e,t)||(this.remove(r),this.insert(t,r))},t.prototype.getAll=function(){return this.rbush_.all().map(function(t){return t.value})},t.prototype.getInExtent=function(t){var r={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(r).map(function(t){return t.value})},t.prototype.forEach=function(t){return this.forEach_(this.getAll(),t)},t.prototype.forEachInExtent=function(t,r){return this.forEach_(this.getInExtent(t),r)},t.prototype.forEach_=function(t,r){for(var i,e=0,n=t.length;e<n;e++)if(i=r(t[e]))return i;return i},t.prototype.isEmpty=function(){return be(this.items_)},t.prototype.clear=function(){this.rbush_.clear(),this.items_={}},t.prototype.getExtent=function(t){var r=this.rbush_.toJSON();return nb(r.minX,r.minY,r.maxX,r.maxY,t)},t.prototype.concat=function(t){for(var r in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[r]=t.items_[r]},t}();var mm=zf&&zf.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),kd=function(e){function t(t,r){var o=e.call(this,t)||this;return o.feature=r,o}return mm(t,e),t}(Ka);zf.VectorSourceEvent=kd;var gc=function(e){function t(t){var r=this,o=t||{};(r=e.call(this,{attributions:o.attributions,projection:void 0,state:Aa.READY,wrapX:void 0===o.wrapX||o.wrapX})||this).loader_=tb,r.format_=o.format,r.overlaps_=void 0===o.overlaps||o.overlaps,r.url_=o.url,void 0!==o.loader?r.loader_=o.loader:void 0!==r.url_&&(ea(r.format_,7),r.loader_=km(r.url_,r.format_)),r.strategy_=void 0!==o.strategy?o.strategy:pr;var i,n,s=void 0===o.useSpatialIndex||o.useSpatialIndex;return r.featuresRtree_=s?new Af:null,r.loadedExtentsRtree_=new Af,r.nullGeometryFeatures_={},r.idIndex_={},r.uidIndex_={},r.featureChangeKeys_={},r.featuresCollection_=null,Array.isArray(o.features)?n=o.features:o.features&&(n=(i=o.features).getArray()),s||void 0!==i||(i=new Ja(n)),void 0!==n&&r.addFeaturesInternal(n),void 0!==i&&r.bindFeaturesCollection_(i),r}return mm(t,e),t.prototype.addFeature=function(e){this.addFeatureInternal(e),this.changed()},t.prototype.addFeatureInternal=function(e){var t=da(e);if(this.addToIndex_(t,e)){this.setupChangeEvents_(t,e);var r=e.getGeometry();if(r){var o=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(o,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new kd(Sa.ADDFEATURE,e))}else this.featuresCollection_&&this.featuresCollection_.remove(e)},t.prototype.setupChangeEvents_=function(e,t){this.featureChangeKeys_[e]=[fa(t,ca.CHANGE,this.handleFeatureChange_,this),fa(t,Tb.PROPERTYCHANGE,this.handleFeatureChange_,this)]},t.prototype.addToIndex_=function(e,t){var r=!0,o=t.getId();return void 0!==o&&(o.toString()in this.idIndex_?r=!1:this.idIndex_[o.toString()]=t),r&&(ea(!(e in this.uidIndex_),30),this.uidIndex_[e]=t),r},t.prototype.addFeatures=function(e){this.addFeaturesInternal(e),this.changed()},t.prototype.addFeaturesInternal=function(e){for(var t=[],r=[],o=[],i=0,n=e.length;i<n;i++){var s=e[i],a=da(s);this.addToIndex_(a,s)&&r.push(s)}i=0;for(var u=r.length;i<u;i++){s=r[i],a=da(s);this.setupChangeEvents_(a,s);var $=s.getGeometry();if($){var l=$.getExtent();t.push(l),o.push(s)}else this.nullGeometryFeatures_[a]=s}this.featuresRtree_&&this.featuresRtree_.load(t,o);i=0;for(var p=r.length;i<p;i++)this.dispatchEvent(new kd(Sa.ADDFEATURE,r[i]))},t.prototype.bindFeaturesCollection_=function(e){var t=!1;this.addEventListener(Sa.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),this.addEventListener(Sa.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),e.addEventListener(Ba.ADD,function(e){t||(t=!0,this.addFeature(e.element),t=!1)}.bind(this)),e.addEventListener(Ba.REMOVE,function(e){t||(t=!0,this.removeFeature(e.element),t=!1)}.bind(this)),this.featuresCollection_=e},t.prototype.clear=function(e){if(e){for(var t in this.featureChangeKeys_){this.featureChangeKeys_[t].forEach(ra)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(var r in this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this)),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var o=new kd(Sa.CLEAR);this.dispatchEvent(o),this.changed()},t.prototype.forEachFeature=function(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},t.prototype.forEachFeatureAtCoordinateDirect=function(e,t){var r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(r){return r.getGeometry().intersectsCoordinate(e)?t(r):void 0})},t.prototype.forEachFeatureInExtent=function(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},t.prototype.forEachFeatureIntersectingExtent=function(e,t){return this.forEachFeatureInExtent(e,function(r){if(r.getGeometry().intersectsExtent(e)){var o=t(r);if(o)return o}})},t.prototype.getFeaturesCollection=function(){return this.featuresCollection_},t.prototype.getFeatures=function(){var e;return this.featuresCollection_?e=this.featuresCollection_.getArray():this.featuresRtree_&&(e=this.featuresRtree_.getAll(),be(this.nullGeometryFeatures_)||bb(e,gg(this.nullGeometryFeatures_))),e},t.prototype.getFeaturesAtCoordinate=function(e){var t=[];return this.forEachFeatureAtCoordinateDirect(e,function(e){t.push(e)}),t},t.prototype.getFeaturesInExtent=function(e){return this.featuresRtree_?this.featuresRtree_.getInExtent(e):this.featuresCollection_?this.featuresCollection_.getArray():[]},t.prototype.getClosestFeatureToCoordinate=function(e,t){var r=e[0],o=e[1],i=null,n=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],u=t||Xa;return this.featuresRtree_.forEachInExtent(a,function(e){if(u(e)){var t=e.getGeometry(),$=s;if((s=t.closestPointXY(r,o,n,s))<$){i=e;var l=Math.sqrt(s);a[0]=r-l,a[1]=o-l,a[2]=r+l,a[3]=o+l}}}),i},t.prototype.getExtent=function(e){return this.featuresRtree_.getExtent(e)},t.prototype.getFeatureById=function(e){var t=this.idIndex_[e.toString()];return void 0!==t?t:null},t.prototype.getFeatureByUid=function(e){var t=this.uidIndex_[e];return void 0!==t?t:null},t.prototype.getFormat=function(){return this.format_},t.prototype.getOverlaps=function(){return this.overlaps_},t.prototype.getUrl=function(){return this.url_},t.prototype.handleFeatureChange_=function(e){var t=e.target,r=da(t),o=t.getGeometry();if(o){var i=o.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(i,t)):this.featuresRtree_&&this.featuresRtree_.update(i,t)}else r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);var n=t.getId();if(void 0!==n){var s=n.toString();this.idIndex_[s]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[s]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new kd(Sa.CHANGEFEATURE,t))},t.prototype.hasFeature=function(e){var t=e.getId();return void 0!==t?t in this.idIndex_:da(e)in this.uidIndex_},t.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&be(this.nullGeometryFeatures_)},t.prototype.loadFeatures=function(e,t,r){var o=this.loadedExtentsRtree_,i=this.strategy_(e,t);this.loading=!1;for(var n=function(e,n){var a=i[e];o.forEachInExtent(a,function(e){return La(e.extent,a)})||(s.loader_.call(s,a,t,r),o.insert(a,{extent:a.slice()}),s.loading=s.loader_!==tb)},s=this,a=0,u=i.length;a<u;++a)n(a)},t.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),e.prototype.refresh.call(this)},t.prototype.removeLoadedExtent=function(e){var t,r=this.loadedExtentsRtree_;r.forEachInExtent(e,function(r){if(eb(r.extent,e))return t=r,!0}),t&&r.remove(t)},t.prototype.removeFeature=function(e){var t=da(e);t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.removeFeatureInternal(e),this.changed()},t.prototype.removeFeatureInternal=function(e){var t=da(e);this.featureChangeKeys_[t].forEach(ra),delete this.featureChangeKeys_[t];var r=e.getId();void 0!==r&&delete this.idIndex_[r.toString()],delete this.uidIndex_[t],this.dispatchEvent(new kd(Sa.REMOVEFEATURE,e))},t.prototype.removeFromIdIndex_=function(e){var t=!1;for(var r in this.idIndex_)if(this.idIndex_[r]===e){delete this.idIndex_[r],t=!0;break}return t},t.prototype.setLoader=function(e){this.loader_=e},t.prototype.setUrl=function(e){ea(this.format_,7),this.setLoader(km(e,this.format_))},t}(jd);zf.default=gc;var nm=Nd&&Nd.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ua={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",CIRCLE:"Circle"},Bf={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"},Cf=function(e){function t(t,i){var r=e.call(this,t)||this;return r.feature=i,r}return nm(t,e),t}(Ka),rr=function(e){function t(t){var i=this,r=t;r.stopDown||(r.stopDown=oc),(i=e.call(this,r)||this).shouldHandle_=!1,i.downPx_=null,i.downTimeout_,i.lastDragTime_,i.freehand_=!1,i.source_=t.source?t.source:null,i.features_=t.features?t.features:null,i.snapTolerance_=t.snapTolerance?t.snapTolerance:12,i.type_=t.type,i.mode_=vr(i.type_),i.stopClick_=!!t.stopClick,i.minPoints_=t.minPoints?t.minPoints:i.mode_===ua.POLYGON?3:2,i.maxPoints_=t.maxPoints?t.maxPoints:1/0,i.finishCondition_=t.finishCondition?t.finishCondition:Xa;var o=t.geometryFunction;if(!o)if(i.type_===aa.CIRCLE)o=function(e,t,i){var r=t||new Od([NaN,NaN]),o=oa(e[0],i),n=$a(o,oa(e[1],i));r.setCenterAndRadius(o,Math.sqrt(n));var s=Ra();return s&&r.transform(i,s),r};else{var n,s=i.mode_;s===ua.POINT?n=gb:s===ua.LINE_STRING?n=Mb:s===ua.POLYGON&&(n=xb),o=function(e,t,i){var r=t;return r?s===ua.POLYGON?e[0].length?r.setCoordinates([e[0].concat([e[0][0]])]):r.setCoordinates([]):r.setCoordinates(e):r=new n(e),r}}return i.geometryFunction_=o,i.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,i.finishCoordinate_=null,i.sketchFeature_=null,i.sketchPoint_=null,i.sketchCoords_=null,i.sketchLine_=null,i.sketchLineCoords_=null,i.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,i.overlay_=new fc({source:new gc({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:sr(),updateWhileInteracting:!0}),i.geometryName_=t.geometryName,i.condition_=t.condition?t.condition:Lh,i.freehandCondition_,t.freehand?i.freehandCondition_=Kh:i.freehandCondition_=t.freehandCondition?t.freehandCondition:lf,i.addEventListener(xa(hf.ACTIVE),i.updateState_),i}return nm(t,e),t.prototype.setMap=function(t){e.prototype.setMap.call(this,t),this.updateState_()},t.prototype.getOverlay=function(){return this.overlay_},t.prototype.handleEvent=function(t){t.originalEvent.type===ca.CONTEXTMENU&&t.preventDefault(),this.freehand_=this.mode_!==ua.POINT&&this.freehandCondition_(t);var i=t.type===na.POINTERMOVE,r=!0;!this.freehand_&&this.lastDragTime_&&t.type===na.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,i=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0));return this.freehand_&&t.type===na.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t.coordinate),r=!1):this.freehand_&&t.type===na.POINTERDOWN?r=!1:i?(r=t.type===na.POINTERMOVE)&&this.freehand_?r=this.handlePointerMove_(t):("mouse"==t.pointerEvent.pointerType||t.type===na.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(t):t.type===na.DBLCLICK&&(r=!1),e.prototype.handleEvent.call(this,t)&&r},t.prototype.handleDownEvent=function(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new Ib(na.POINTERMOVE,e.map,e.pointerEvent,!1,e.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)},t.prototype.handleUpEvent=function(e){var t=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);var i=this.mode_===ua.CIRCLE;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||i?this.finishDrawing():this.atFinish_(e)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate):(this.startDrawing_(e),this.mode_===ua.POINT&&this.finishDrawing()),t=!1):this.freehand_&&this.abortDrawing(),!t&&this.stopClick_&&e.stopPropagation(),t},t.prototype.handlePointerMove_=function(e){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var t=this.downPx_,i=e.pixel,r=t[0]-i[0],o=t[1]-i[1],n=r*r+o*o;if(this.shouldHandle_=this.freehand_?n>this.squaredClickTolerance_:n<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(e):this.createOrUpdateSketchPoint_(e),!0},t.prototype.atFinish_=function(e){var t=!1;if(this.sketchFeature_){var i=!1,r=[this.finishCoordinate_];if(this.mode_===ua.LINE_STRING)i=this.sketchCoords_.length>this.minPoints_;else if(this.mode_===ua.POLYGON){var o=this.sketchCoords_;i=o[0].length>this.minPoints_,r=[o[0][0],o[0][o[0].length-2]]}if(i)for(var n=e.map,s=0,a=r.length;s<a;s++){var $=r[s],h=n.getPixelFromCoordinate($),p=e.pixel,d=p[0]-h[0],_=p[1]-h[1],c=this.freehand_?1:this.snapTolerance_;if(t=Math.sqrt(d*d+_*_)<=c){this.finishCoordinate_=$;break}}}return t},t.prototype.createOrUpdateSketchPoint_=function(e){var t=e.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new Wa(new gb(t)),this.updateSketchFeatures_())},t.prototype.startDrawing_=function(e){var t=e.coordinate,i=e.map.getView().getProjection();this.finishCoordinate_=t,this.mode_===ua.POINT?this.sketchCoords_=t.slice():this.mode_===ua.POLYGON?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new Wa(new Mb(this.sketchLineCoords_)));var r=this.geometryFunction_(this.sketchCoords_,void 0,i);this.sketchFeature_=new Wa,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(r),this.updateSketchFeatures_(),this.dispatchEvent(new Cf(Bf.DRAWSTART,this.sketchFeature_))},t.prototype.modifyDrawing_=function(e){var t,i,r,o=e.coordinate,n=this.sketchFeature_.getGeometry(),s=e.map.getView().getProjection();(this.mode_===ua.POINT?i=this.sketchCoords_:this.mode_===ua.POLYGON?(i=(t=this.sketchCoords_[0])[t.length-1],this.atFinish_(e)&&(o=this.finishCoordinate_.slice())):i=(t=this.sketchCoords_)[t.length-1],i[0]=o[0],i[1]=o[1],this.geometryFunction_(this.sketchCoords_,n,s),this.sketchPoint_)&&this.sketchPoint_.getGeometry().setCoordinates(o);if(n.getType()==aa.POLYGON&&this.mode_!==ua.POLYGON){this.sketchLine_||(this.sketchLine_=new Wa);var a=n.getLinearRing(0);(r=this.sketchLine_.getGeometry())?(r.setFlatCoordinates(a.getLayout(),a.getFlatCoordinates()),r.changed()):(r=new Mb(a.getFlatCoordinates(),a.getLayout()),this.sketchLine_.setGeometry(r))}else this.sketchLineCoords_&&(r=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()},t.prototype.addToDrawing_=function(e){var t,i,r=this.sketchFeature_.getGeometry(),o=this.getMap().getView().getProjection();this.mode_===ua.LINE_STRING?(this.finishCoordinate_=e.slice(),(i=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?i.pop():t=!0),i.push(e.slice()),this.geometryFunction_(i,r,o)):this.mode_===ua.POLYGON&&((i=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?i.pop():t=!0),i.push(e.slice()),t&&(this.finishCoordinate_=i[0]),this.geometryFunction_(this.sketchCoords_,r,o)),this.updateSketchFeatures_(),t&&this.finishDrawing()},t.prototype.removeLastPoint=function(){if(this.sketchFeature_){var e,t=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection();this.mode_===ua.LINE_STRING?((e=this.sketchCoords_).splice(-2,1),this.geometryFunction_(e,t,i),e.length>=2&&(this.finishCoordinate_=e[e.length-2].slice())):this.mode_===ua.POLYGON&&((e=this.sketchCoords_[0]).splice(-2,1),this.sketchLine_.getGeometry().setCoordinates(e),this.geometryFunction_(this.sketchCoords_,t,i)),0===e.length&&this.abortDrawing(),this.updateSketchFeatures_()}},t.prototype.finishDrawing=function(){var e=this.abortDrawing_();if(e){var t=this.sketchCoords_,i=e.getGeometry(),r=this.getMap().getView().getProjection();this.mode_===ua.LINE_STRING?(t.pop(),this.geometryFunction_(t,i,r)):this.mode_===ua.POLYGON&&(t[0].pop(),this.geometryFunction_(t,i,r),t=i.getCoordinates()),this.type_===aa.MULTI_POINT?e.setGeometry(new rf([t])):this.type_===aa.MULTI_LINE_STRING?e.setGeometry(new bi([t])):this.type_===aa.MULTI_POLYGON&&e.setGeometry(new ei([t])),this.dispatchEvent(new Cf(Bf.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e)}},t.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),e},t.prototype.abortDrawing=function(){var e=this.abortDrawing_();e&&this.dispatchEvent(new Cf(Bf.DRAWABORT,e))},t.prototype.appendCoordinates=function(e){var t=this.mode_,i=[];t===ua.LINE_STRING?i=this.sketchCoords_:t===ua.POLYGON&&(i=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]);for(var r=i.pop(),o=0;o<e.length;o++)this.addToDrawing_(e[o]);this.addToDrawing_(r)},t.prototype.extend=function(e){var t=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=t.getCoordinates();var i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new Cf(Bf.DRAWSTART,this.sketchFeature_))},t.prototype.updateSketchFeatures_=function(){var e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);var t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)},t.prototype.updateState_=function(){var e=this.getMap(),t=this.getActive();e&&t||this.abortDrawing(),this.overlay_.setMap(t?e:null)},t}(hb);function sr(){var e=Pd();return function(t,i){return e[t.getGeometry().getType()]}}function tr(e,t){return function(i,r,o){var n=oa(i[0],o),s=oa(i[1],o),a=Math.sqrt($a(n,s)),$=r||Id(new Od(n),e),h=t;if(!t){var p=s[0]-n[0],d=s[1]-n[1];h=Math.atan(d/p)-(p<0?Math.PI:0)}oh($,n,a,h);var _=Ra();return _&&$.transform(o,_),$}}function ur(){return function(e,t,i){var r=Da(e.map(function(e){return oa(e,i)})),o=[[Yb(r),uc(r),vc(r),fb(r),Yb(r)]],n=t;n?n.setCoordinates(o):n=new xb(o);var s=Ra();return s&&n.transform(i,s),n}}function vr(e){var t;return e===aa.POINT||e===aa.MULTI_POINT?t=ua.POINT:e===aa.LINE_STRING||e===aa.MULTI_LINE_STRING?t=ua.LINE_STRING:e===aa.POLYGON||e===aa.MULTI_POLYGON?t=ua.POLYGON:e===aa.CIRCLE&&(t=ua.CIRCLE),t}Nd.createRegularPolygon=tr,Nd.createBox=ur,Nd.default=rr;var yi={};var om=yi&&yi.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),wr={EXTENTCHANGED:"extentchanged"},xr=function(e){function t(t){var r=e.call(this,wr.EXTENTCHANGED)||this;return r.extent=t,r}return om(t,e),t}(Ka),yr=function(e){function t(t){var r=this,n=t||{};return(r=e.call(this,n)||this).extent_=null,r.pointerHandler_=null,r.pixelTolerance_=void 0!==n.pixelTolerance?n.pixelTolerance:10,r.snappedToVertex_=!1,r.extentFeature_=null,r.vertexFeature_=null,t||(t={}),r.extentOverlay_=new fc({source:new gc({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.boxStyle?t.boxStyle:zr(),updateWhileAnimating:!0,updateWhileInteracting:!0}),r.vertexOverlay_=new fc({source:new gc({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.pointerStyle?t.pointerStyle:Ar(),updateWhileAnimating:!0,updateWhileInteracting:!0}),t.extent&&r.setExtent(t.extent),r}return om(t,e),t.prototype.snapToVertex_=function(e,t){var r=t.getCoordinateFromPixelInternal(e),n=this.getExtentInternal();if(n){var o=Br(n);o.sort(function(e,t){return Re(r,e)-Re(r,t)});var i=o[0],a=Oe(r,i),$=t.getPixelFromCoordinateInternal(a);if(Qe(e,$)<=this.pixelTolerance_){var l=t.getPixelFromCoordinateInternal(i[0]),p=t.getPixelFromCoordinateInternal(i[1]),u=$a($,l),s=$a($,p),c=Math.sqrt(Math.min(u,s));return this.snappedToVertex_=c<=this.pixelTolerance_,this.snappedToVertex_&&(a=u>s?i[1]:i[0]),a}}return null},t.prototype.handlePointerMove_=function(e){var t=e.pixel,r=e.map,n=this.snapToVertex_(t,r);n||(n=r.getCoordinateFromPixelInternal(t)),this.createOrUpdatePointerFeature_(n)},t.prototype.createOrUpdateExtentFeature_=function(e){var t=this.extentFeature_;return t?e?t.setGeometry(Lb(e)):t.setGeometry(void 0):(t=e?new Wa(Lb(e)):new Wa({}),this.extentFeature_=t,this.extentOverlay_.getSource().addFeature(t)),t},t.prototype.createOrUpdatePointerFeature_=function(e){var t=this.vertexFeature_;t?t.getGeometry().setCoordinates(e):(t=new Wa(new gb(e)),this.vertexFeature_=t,this.vertexOverlay_.getSource().addFeature(t));return t},t.prototype.handleEvent=function(t){return!t.pointerEvent||(t.type!=na.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),e.prototype.handleEvent.call(this,t),!1)},t.prototype.handleDownEvent=function(e){var t=e.pixel,r=e.map,n=this.getExtentInternal(),o=this.snapToVertex_(t,r),i=function(e){var t=null,r=null;return e[0]==n[0]?t=n[2]:e[0]==n[2]&&(t=n[0]),e[1]==n[1]?r=n[3]:e[1]==n[3]&&(r=n[1]),null!==t&&null!==r?[t,r]:null};if(o&&n){var a=o[0]==n[0]||o[0]==n[2]?o[0]:null,$=o[1]==n[1]||o[1]==n[3]?o[1]:null;null!==a&&null!==$?this.pointerHandler_=pm(i(o)):null!==a?this.pointerHandler_=qm(i([a,n[1]]),i([a,n[3]])):null!==$&&(this.pointerHandler_=qm(i([n[0],$]),i([n[2],$])))}else o=r.getCoordinateFromPixelInternal(t),this.setExtent([o[0],o[1],o[0],o[1]]),this.pointerHandler_=pm(o);return!0},t.prototype.handleDragEvent=function(e){if(this.pointerHandler_){var t=e.coordinate;this.setExtent(this.pointerHandler_(t)),this.createOrUpdatePointerFeature_(t)}return!0},t.prototype.handleUpEvent=function(e){this.pointerHandler_=null;var t=this.getExtentInternal();return t&&0!==qe(t)||this.setExtent(null),!1},t.prototype.setMap=function(t){this.extentOverlay_.setMap(t),this.vertexOverlay_.setMap(t),e.prototype.setMap.call(this,t)},t.prototype.getExtent=function(){return $c(this.getExtentInternal(),this.getMap().getView().getProjection())},t.prototype.getExtentInternal=function(){return this.extent_},t.prototype.setExtent=function(e){this.extent_=e||null,this.createOrUpdateExtentFeature_(e),this.dispatchEvent(new xr(this.extent_))},t}(hb);function zr(){var e=Pd();return function(t,r){return e[aa.POLYGON]}}function Ar(){var e=Pd();return function(t,r){return e[aa.POINT]}}function pm(e){return function(t){return Da([e,t])}}function qm(e,t){return e[0]==t[0]?function(r){return Da([e,[r[0],t[1]]])}:e[1]==t[1]?function(r){return Da([e,[t[0],r[1]]])}:null}function Br(e){return[[[e[0],e[1]],[e[0],e[3]]],[[e[0],e[3]],[e[2],e[3]]],[[e[2],e[3]],[e[2],e[1]]],[[e[2],e[1]],[e[0],e[1]]]]}yi.default=yr;var Df={};var rm=Df&&Df.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),sm=0,Ud=1,tm=[0,0,0,0],ld=[],zi={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"},Ef=function(e){function t(t,r,o){var i=e.call(this,t)||this;return i.features=r,i.mapBrowserEvent=o,i}return rm(t,e),t}(Ka);Df.ModifyEvent=Ef;var Cr=function(e){function t(t){var r,o=e.call(this,t)||this;if(o.boundHandleFeatureChange_=o.handleFeatureChange_.bind(o),o.condition_=t.condition?t.condition:Dl,o.defaultDeleteCondition_=function(e){return pq(e)&&Bl(e)},o.deleteCondition_=t.deleteCondition?t.deleteCondition:o.defaultDeleteCondition_,o.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:Kh,o.vertexFeature_=null,o.vertexSegments_=null,o.lastPixel_=[0,0],o.ignoreNextSingleClick_=!1,o.modified_=!1,o.rBush_=new Af,o.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,o.snappedToVertex_=!1,o.changingFeature_=!1,o.dragSegments_=[],o.overlay_=new fc({source:new gc({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:Er(),updateWhileAnimating:!0,updateWhileInteracting:!0}),o.SEGMENT_WRITERS_={Point:o.writePointGeometry_.bind(o),LineString:o.writeLineStringGeometry_.bind(o),LinearRing:o.writeLineStringGeometry_.bind(o),Polygon:o.writePolygonGeometry_.bind(o),MultiPoint:o.writeMultiPointGeometry_.bind(o),MultiLineString:o.writeMultiLineStringGeometry_.bind(o),MultiPolygon:o.writeMultiPolygonGeometry_.bind(o),Circle:o.writeCircleGeometry_.bind(o),GeometryCollection:o.writeGeometryCollectionGeometry_.bind(o)},o.source_=null,t.source?(o.source_=t.source,r=new Ja(o.source_.getFeatures()),o.source_.addEventListener(Sa.ADDFEATURE,o.handleSourceAdd_.bind(o)),o.source_.addEventListener(Sa.REMOVEFEATURE,o.handleSourceRemove_.bind(o))):r=t.features,!r)throw new Error("The modify interaction requires features or a source");return o.features_=r,o.features_.forEach(o.addFeature_.bind(o)),o.features_.addEventListener(Ba.ADD,o.handleFeatureAdd_.bind(o)),o.features_.addEventListener(Ba.REMOVE,o.handleFeatureRemove_.bind(o)),o.lastPointerEvent_=null,o}return rm(t,e),t.prototype.addFeature_=function(e){var t=e.getGeometry();if(t){var r=this.SEGMENT_WRITERS_[t.getType()];r&&r(e,t)}var o=this.getMap();o&&o.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,o),e.addEventListener(ca.CHANGE,this.boundHandleFeatureChange_)},t.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new Ef(zi.MODIFYSTART,this.features_,e)))},t.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(ca.CHANGE,this.boundHandleFeatureChange_)},t.prototype.removeFeatureSegmentData_=function(e){var t=this.rBush_,r=[];t.forEach(function(t){e===t.feature&&r.push(t)});for(var o=r.length-1;o>=0;--o){for(var i=r[o],n=this.dragSegments_.length-1;n>=0;--n)this.dragSegments_[n][0]===i&&this.dragSegments_.splice(n,1);t.remove(i)}},t.prototype.setActive=function(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.prototype.setActive.call(this,t)},t.prototype.setMap=function(t){this.overlay_.setMap(t),e.prototype.setMap.call(this,t)},t.prototype.getOverlay=function(){return this.overlay_},t.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},t.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},t.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},t.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){var t=e.target;this.removeFeature_(t),this.addFeature_(t)}},t.prototype.handleFeatureRemove_=function(e){var t=e.element;this.removeFeature_(t)},t.prototype.writePointGeometry_=function(e,t){var r=t.getCoordinates(),o={feature:e,geometry:t,segment:[r,r]};this.rBush_.insert(t.getExtent(),o)},t.prototype.writeMultiPointGeometry_=function(e,t){for(var r=t.getCoordinates(),o=0,i=r.length;o<i;++o){var n=r[o],a={feature:e,geometry:t,depth:[o],index:o,segment:[n,n]};this.rBush_.insert(t.getExtent(),a)}},t.prototype.writeLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),o=0,i=r.length-1;o<i;++o){var n=r.slice(o,o+2),a={feature:e,geometry:t,index:o,segment:n};this.rBush_.insert(Da(n),a)}},t.prototype.writeMultiLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),o=0,i=r.length;o<i;++o)for(var n=r[o],a=0,s=n.length-1;a<s;++a){var $=n.slice(a,a+2),p={feature:e,geometry:t,depth:[o],index:a,segment:$};this.rBush_.insert(Da($),p)}},t.prototype.writePolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),o=0,i=r.length;o<i;++o)for(var n=r[o],a=0,s=n.length-1;a<s;++a){var $=n.slice(a,a+2),p={feature:e,geometry:t,depth:[o],index:a,segment:$};this.rBush_.insert(Da($),p)}},t.prototype.writeMultiPolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),o=0,i=r.length;o<i;++o)for(var n=r[o],a=0,s=n.length;a<s;++a)for(var $=n[a],p=0,m=$.length-1;p<m;++p){var u=$.slice(p,p+2),d={feature:e,geometry:t,depth:[a,o],index:p,segment:u};this.rBush_.insert(Da(u),d)}},t.prototype.writeCircleGeometry_=function(e,t){var r=t.getCenter(),o={feature:e,geometry:t,index:sm,segment:[r,r]},i={feature:e,geometry:t,index:Ud,segment:[r,r]},n=[o,i];o.featureSegments=n,i.featureSegments=n,this.rBush_.insert(sd(r),o);var a=t,s=Ra();if(s&&this.getMap()){var $=this.getMap().getView().getProjection();a=a.clone().transform(s,$),a=Id(a).transform($,s)}this.rBush_.insert(a.getExtent(),i)},t.prototype.writeGeometryCollectionGeometry_=function(e,t){for(var r=t.getGeometriesArray(),o=0;o<r.length;++o){var i=r[o];(0,this.SEGMENT_WRITERS_[i.getType()])(e,i)}},t.prototype.createOrUpdateVertexFeature_=function(e){var t=this.vertexFeature_;t?t.getGeometry().setCoordinates(e):(t=new Wa(new gb(e)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t));return t},t.prototype.handleEvent=function(t){return!t.pointerEvent||(this.lastPointerEvent_=t,t.map.getView().getInteracting()||t.type!=na.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(r=!(t.type!=na.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),t.type==na.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),e.prototype.handleEvent.call(this,t)&&!r);var r},t.prototype.handleDragEvent=function(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e);for(var t=e.coordinate,r=0,o=this.dragSegments_.length;r<o;++r){for(var i=this.dragSegments_[r],n=i[0],a=n.depth,s=n.geometry,$=void 0,p=n.segment,m=i[1];t.length<s.getStride();)t.push(p[m][t.length]);switch(s.getType()){case aa.POINT:$=t,p[0]=t,p[1]=t;break;case aa.MULTI_POINT:($=s.getCoordinates())[n.index]=t,p[0]=t,p[1]=t;break;case aa.LINE_STRING:($=s.getCoordinates())[n.index+m]=t,p[m]=t;break;case aa.MULTI_LINE_STRING:case aa.POLYGON:($=s.getCoordinates())[a[0]][n.index+m]=t,p[m]=t;break;case aa.MULTI_POLYGON:($=s.getCoordinates())[a[1]][a[0]][n.index+m]=t,p[m]=t;break;case aa.CIRCLE:if(p[0]=t,p[1]=t,n.index===sm)this.changingFeature_=!0,s.setCenter(t),this.changingFeature_=!1;else{this.changingFeature_=!0;var u=e.map.getView().getProjection(),d=Qe(oa(s.getCenter(),u),oa(t,u)),x=Ra();if(x){var g=s.clone().transform(x,u);g.setRadius(d),d=g.transform(u,x).getRadius()}s.setRadius(d),this.changingFeature_=!1}}$&&this.setGeometryCoordinates_(s,$)}this.createOrUpdateVertexFeature_(t)},t.prototype.handleDownEvent=function(e){if(!this.condition_(e))return!1;var t=e.coordinate;this.handlePointerAtPixel_(e.pixel,e.map,t),this.dragSegments_.length=0,this.modified_=!1;var r=this.vertexFeature_;if(r){var o=e.map.getView().getProjection(),i=[],n=r.getGeometry().getCoordinates(),a=Da([n]),s=this.rBush_.getInExtent(a),$={};s.sort(Dr);for(var p=0,m=s.length;p<m;++p){var u=s[p],d=u.segment,x=da(u.feature),g=u.depth;if(g&&(x+="-"+g.join("-")),$[x]||($[x]=new Array(2)),u.geometry.getType()!==aa.CIRCLE||u.index!==Ud){if(!Za(d[0],n)||$[x][0]){if(!Za(d[1],n)||$[x][1])da(d)in this.vertexSegments_&&!$[x][0]&&!$[x][1]&&this.insertVertexCondition_(e)&&i.push([u,n]);else{if((u.geometry.getType()===aa.LINE_STRING||u.geometry.getType()===aa.MULTI_LINE_STRING)&&$[x][0]&&0===$[x][0].index)continue;this.dragSegments_.push([u,1]),$[x][1]=u}}else this.dragSegments_.push([u,0]),$[x][0]=u;}else{var h=vm(t,u,o);Za(h,n)&&!$[x][0]&&(this.dragSegments_.push([u,0]),$[x][0]=u)}}i.length&&this.willModifyFeatures_(e);for(var l=i.length-1;l>=0;--l)this.insertVertex_.apply(this,i[l])}return!!this.vertexFeature_},t.prototype.handleUpEvent=function(e){for(var t=this.dragSegments_.length-1;t>=0;--t){var r=this.dragSegments_[t][0],o=r.geometry;if(o.getType()===aa.CIRCLE){var i=o.getCenter(),n=r.featureSegments[0],a=r.featureSegments[1];n.segment[0]=i,n.segment[1]=i,a.segment[0]=i,a.segment[1]=i,this.rBush_.update(sd(i),n);var s=o,$=Ra();if($){var p=e.map.getView().getProjection();s=s.clone().transform($,p),s=Id(s).transform(p,$)}this.rBush_.update(s.getExtent(),a)}else this.rBush_.update(Da(r.segment),r)}return this.modified_&&(this.dispatchEvent(new Ef(zi.MODIFYEND,this.features_,e)),this.modified_=!1),!1},t.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map,e.coordinate)},t.prototype.handlePointerAtPixel_=function(e,t,r){var o=r||t.getCoordinateFromPixel(e),i=t.getView().getProjection(),n=Ua(sd(o,tm),i),a=t.getView().getResolution()*this.pixelTolerance_,s=$c(db(n,a,tm),i),$=this.rBush_.getInExtent(s);if($.length>0){$.sort(function(e,t){return um(o,e,i)-um(o,t,i)});var p=$[0],m=p.segment,u=vm(o,p,i),d=t.getPixelFromCoordinate(u),x=Qe(e,d);if(x<=this.pixelTolerance_){var g={};if(p.geometry.getType()===aa.CIRCLE&&p.index===Ud)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(u);else{var h=t.getPixelFromCoordinate(m[0]),l=t.getPixelFromCoordinate(m[1]),c=$a(d,h),_=$a(d,l);x=Math.sqrt(Math.min(c,_)),this.snappedToVertex_=x<=this.pixelTolerance_,this.snappedToVertex_&&(u=c>_?m[1]:m[0]),this.createOrUpdateVertexFeature_(u);for(var v=1,y=$.length;v<y;++v){var q=$[v].segment;if(!(Za(m[0],q[0])&&Za(m[1],q[1])||Za(m[0],q[1])&&Za(m[1],q[0])))break;g[da(q)]=!0}}return g[da(m)]=!0,void(this.vertexSegments_=g)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},t.prototype.insertVertex_=function(e,t){for(var r,o=e.segment,i=e.feature,n=e.geometry,a=e.depth,s=e.index;t.length<n.getStride();)t.push(0);switch(n.getType()){case aa.MULTI_LINE_STRING:case aa.POLYGON:(r=n.getCoordinates())[a[0]].splice(s+1,0,t);break;case aa.MULTI_POLYGON:(r=n.getCoordinates())[a[1]][a[0]].splice(s+1,0,t);break;case aa.LINE_STRING:(r=n.getCoordinates()).splice(s+1,0,t);break;default:return;}this.setGeometryCoordinates_(n,r);var $=this.rBush_;$.remove(e),this.updateSegmentIndices_(n,s,a,1);var p={segment:[o[0],t],feature:i,geometry:n,depth:a,index:s};$.insert(Da(p.segment),p),this.dragSegments_.push([p,1]);var m={segment:[t,o[1]],feature:i,geometry:n,depth:a,index:s+1};$.insert(Da(m.segment),m),this.dragSegments_.push([m,0]),this.ignoreNextSingleClick_=!0},t.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=na.POINTERDRAG){var e=this.lastPointerEvent_;this.willModifyFeatures_(e);var t=this.removeVertex_();return this.dispatchEvent(new Ef(zi.MODIFYEND,this.features_,e)),this.modified_=!1,t}return!1},t.prototype.removeVertex_=function(){var e,t,r,o,i,n,a,s,$,p,m,u=this.dragSegments_,d={},x=!1;for(i=u.length-1;i>=0;--i)p=(r=u[i])[0],m=da(p.feature),p.depth&&(m+="-"+p.depth.join("-")),m in d||(d[m]={}),0===r[1]?(d[m].right=p,d[m].index=p.index):1==r[1]&&(d[m].left=p,d[m].index=p.index+1);for(m in d){switch($=d[m].right,a=d[m].left,(s=(n=d[m].index)-1)<0&&(s=0),e=t=(o=(p=void 0!==a?a:$).geometry).getCoordinates(),x=!1,o.getType()){case aa.MULTI_LINE_STRING:t[p.depth[0]].length>2&&(t[p.depth[0]].splice(n,1),x=!0);break;case aa.LINE_STRING:t.length>2&&(t.splice(n,1),x=!0);break;case aa.MULTI_POLYGON:e=e[p.depth[1]];case aa.POLYGON:(e=e[p.depth[0]]).length>4&&(n==e.length-1&&(n=0),e.splice(n,1),x=!0,0===n&&(e.pop(),e.push(e[0]),s=e.length-1));}if(x){this.setGeometryCoordinates_(o,t);var g=[];if(void 0!==a&&(this.rBush_.remove(a),g.push(a.segment[0])),void 0!==$&&(this.rBush_.remove($),g.push($.segment[1])),void 0!==a&&void 0!==$){var h={depth:p.depth,feature:p.feature,geometry:p.geometry,index:s,segment:g};this.rBush_.insert(Da(h.segment),h)}this.updateSegmentIndices_(o,n,p.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),u.length=0}}return x},t.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},t.prototype.updateSegmentIndices_=function(e,t,r,o){this.rBush_.forEachInExtent(e.getExtent(),function(i){i.geometry===e&&(void 0===r||void 0===i.depth||Vb(i.depth,r))&&i.index>t&&(i.index+=o)})},t}(hb);function Dr(e,t){return e.index-t.index}function um(e,t,r){var o=t.geometry;if(o.getType()===aa.CIRCLE){var i=o;if(t.index===Ud){var n=Ra();n&&(i=i.clone().transform(n,r));var a=$a(i.getCenter(),oa(e,r)),s=Math.sqrt(a)-i.getRadius();return s*s}}var $=oa(e,r);return ld[0]=oa(t.segment[0],r),ld[1]=oa(t.segment[1],r),Re($,ld)}function vm(e,t,r){var o=t.geometry;if(o.getType()===aa.CIRCLE&&t.index===Ud){var i=o,n=Ra();return n&&(i=i.clone().transform(n,r)),Fb(i.getClosestPoint(oa(e,r)),r)}var a=oa(e,r);return ld[0]=oa(t.segment[0],r),ld[1]=oa(t.segment[1],r),Fb(Oe(a,ld),r)}function Er(){var e=Pd();return function(t,r){return e[aa.POINT]}}Df.default=Cr;var Ai={};var wm=Ai&&Ai.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Fr={SELECT:"select"},Gr=function(e){function t(t,r,i,o){var n=e.call(this,t)||this;return n.selected=r,n.deselected=i,n.mapBrowserEvent=o,n}return wm(t,e),t}(Ka),Ff={},Hr=function(e){function t(t){var r,i=e.call(this,{handleEvent:Ir})||this,o=t||{};if(i.boundAddFeature_=i.addFeature_.bind(i),i.boundRemoveFeature_=i.removeFeature_.bind(i),i.condition_=o.condition?o.condition:Bl,i.addCondition_=o.addCondition?o.addCondition:Al,i.removeCondition_=o.removeCondition?o.removeCondition:Al,i.toggleCondition_=o.toggleCondition?o.toggleCondition:lf,i.multi_=!!o.multi&&o.multi,i.filter_=o.filter?o.filter:Xa,i.hitTolerance_=o.hitTolerance?o.hitTolerance:0,i.style_=void 0!==o.style?o.style:Jr(),i.features_=o.features||new Ja,o.layers){if("function"==typeof o.layers)r=o.layers;else{var n=o.layers;r=function(e){return pc(n,e)}}}else r=Xa;return i.layerFilter_=r,i.featureLayerAssociation_={},i}return wm(t,e),t.prototype.addFeatureLayerAssociation_=function(e,t){this.featureLayerAssociation_[da(e)]=t},t.prototype.getFeatures=function(){return this.features_},t.prototype.getHitTolerance=function(){return this.hitTolerance_},t.prototype.getLayer=function(e){return this.featureLayerAssociation_[da(e)]},t.prototype.setHitTolerance=function(e){this.hitTolerance_=e},t.prototype.setMap=function(t){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),e.prototype.setMap.call(this,t),t?(this.features_.addEventListener(Ba.ADD,this.boundAddFeature_),this.features_.addEventListener(Ba.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(Ba.ADD,this.boundAddFeature_),this.features_.removeEventListener(Ba.REMOVE,this.boundRemoveFeature_))},t.prototype.addFeature_=function(e){var t=e.element;this.style_&&this.applySelectedStyle_(t)},t.prototype.removeFeature_=function(e){var t=e.element;this.style_&&this.restorePreviousStyle_(t)},t.prototype.getStyle=function(){return this.style_},t.prototype.applySelectedStyle_=function(e){var t=da(e);t in Ff||(Ff[t]=e.getStyle()),e.setStyle(this.style_)},t.prototype.restorePreviousStyle_=function(e){var r=da(e),i=this.getMap().getInteractions().getArray().filter(function(r){return r instanceof t&&r.getStyle()&&-1!==r.getFeatures().getArray().indexOf(e)});i.length>0?e.setStyle(i[i.length-1].getStyle()):(e.setStyle(Ff[r]),delete Ff[r])},t.prototype.removeFeatureLayerAssociation_=function(e){delete this.featureLayerAssociation_[da(e)]},t}(ac);function Ir(e){if(!this.condition_(e))return!0;var t=this.addCondition_(e),r=this.removeCondition_(e),i=this.toggleCondition_(e),o=!t&&!r&&!i,n=e.map,a=this.getFeatures(),$=[],s=[];if(o){Sb(this.featureLayerAssociation_),n.forEachFeatureAtPixel(e.pixel,function(e,t){if(this.filter_(e,t))return s.push(e),this.addFeatureLayerAssociation_(e,t),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var l=a.getLength()-1;l>=0;--l){var u=a.item(l),p=s.indexOf(u);p>-1?s.splice(p,1):(a.remove(u),$.push(u))}0!==s.length&&a.extend(s)}else{n.forEachFeatureAtPixel(e.pixel,function(e,o){if(this.filter_(e,o))return!t&&!i||pc(a.getArray(),e)?(r||i)&&pc(a.getArray(),e)&&($.push(e),this.removeFeatureLayerAssociation_(e)):(s.push(e),this.addFeatureLayerAssociation_(e,o)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var c=$.length-1;c>=0;--c)a.remove($[c]);a.extend(s)}return(s.length>0||$.length>0)&&this.dispatchEvent(new Gr(Fr.SELECT,s,$,e)),!0}function Jr(){var e=Pd();return bb(e[aa.POLYGON],e[aa.LINE_STRING]),bb(e[aa.GEOMETRY_COLLECTION],e[aa.LINE_STRING]),function(t){return t.getGeometry()?e[t.getGeometry().getType()]:null}}Ai.default=Hr;var Bi={};var Kr=Bi&&Bi.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function xm(e){return e.feature?e.feature:e.element?e.element:void 0}var md=[],Lr=function(e){function t(t){var r=this,n=t||{},o=n;return o.handleDownEvent||(o.handleDownEvent=Xa),o.stopDown||(o.stopDown=oc),(r=e.call(this,o)||this).source_=n.source?n.source:null,r.vertex_=void 0===n.vertex||n.vertex,r.edge_=void 0===n.edge||n.edge,r.features_=n.features?n.features:null,r.featuresListenerKeys_=[],r.featureChangeListenerKeys_={},r.indexedFeaturesExtents_={},r.pendingFeatures_={},r.pixelTolerance_=void 0!==n.pixelTolerance?n.pixelTolerance:10,r.rBush_=new Af,r.SEGMENT_WRITERS_={Point:r.writePointGeometry_.bind(r),LineString:r.writeLineStringGeometry_.bind(r),LinearRing:r.writeLineStringGeometry_.bind(r),Polygon:r.writePolygonGeometry_.bind(r),MultiPoint:r.writeMultiPointGeometry_.bind(r),MultiLineString:r.writeMultiLineStringGeometry_.bind(r),MultiPolygon:r.writeMultiPolygonGeometry_.bind(r),GeometryCollection:r.writeGeometryCollectionGeometry_.bind(r),Circle:r.writeCircleGeometry_.bind(r)},r}return Kr(t,e),t.prototype.addFeature=function(e,t){var r=void 0===t||t,n=da(e),o=e.getGeometry();if(o){var i=this.SEGMENT_WRITERS_[o.getType()];i&&(this.indexedFeaturesExtents_[n]=o.getExtent(Ha()),i(e,o))}r&&(this.featureChangeListenerKeys_[n]=fa(e,ca.CHANGE,this.handleFeatureChange_,this))},t.prototype.forEachFeatureAdd_=function(e){this.addFeature(e)},t.prototype.forEachFeatureRemove_=function(e){this.removeFeature(e)},t.prototype.getFeatures_=function(){var e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e},t.prototype.handleEvent=function(t){var r=this.snapTo(t.pixel,t.coordinate,t.map);return r.snapped&&(t.coordinate=r.vertex.slice(0,2),t.pixel=r.vertexPixel),e.prototype.handleEvent.call(this,t)},t.prototype.handleFeatureAdd_=function(e){var t=xm(e);this.addFeature(t)},t.prototype.handleFeatureRemove_=function(e){var t=xm(e);this.removeFeature(t)},t.prototype.handleFeatureChange_=function(e){var t=e.target;if(this.handlingDownUpSequence){var r=da(t);r in this.pendingFeatures_||(this.pendingFeatures_[r]=t)}else this.updateFeature_(t)},t.prototype.handleUpEvent=function(e){var t=gg(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1},t.prototype.removeFeature=function(e,t){var r=void 0===t||t,n=da(e),o=this.indexedFeaturesExtents_[n];if(o){var i=this.rBush_,a=[];i.forEachInExtent(o,function(t){e===t.feature&&a.push(t)});for(var s=a.length-1;s>=0;--s)i.remove(a[s])}r&&(ra(this.featureChangeListenerKeys_[n]),delete this.featureChangeListenerKeys_[n])},t.prototype.setMap=function(t){var r=this.getMap(),n=this.featuresListenerKeys_,o=this.getFeatures_();r&&(n.forEach(ra),n.length=0,o.forEach(this.forEachFeatureRemove_.bind(this))),e.prototype.setMap.call(this,t),t&&(this.features_?n.push(fa(this.features_,Ba.ADD,this.handleFeatureAdd_,this),fa(this.features_,Ba.REMOVE,this.handleFeatureRemove_,this)):this.source_&&n.push(fa(this.source_,Sa.ADDFEATURE,this.handleFeatureAdd_,this),fa(this.source_,Sa.REMOVEFEATURE,this.handleFeatureRemove_,this)),o.forEach(this.forEachFeatureAdd_.bind(this)))},t.prototype.snapTo=function(e,t,r){var n=r.getCoordinateFromPixel([e[0]-this.pixelTolerance_,e[1]+this.pixelTolerance_]),o=r.getCoordinateFromPixel([e[0]+this.pixelTolerance_,e[1]-this.pixelTolerance_]),i=Da([n,o]),a=this.rBush_.getInExtent(i);this.vertex_&&!this.edge_&&(a=a.filter(function(e){return e.feature.getGeometry().getType()!==aa.CIRCLE}));var s=!1,$=null,p=null;if(0===a.length)return{snapped:s,vertex:$,vertexPixel:p};for(var u,l=r.getView().getProjection(),h=oa(t,l),m=1/0,d=0;d<a.length;++d){var c=a[d];md[0]=oa(c.segment[0],l),md[1]=oa(c.segment[1],l);var g=Re(h,md);g<m&&(u=c,m=g)}var G=u.segment;if(this.vertex_&&!this.edge_){var v=r.getPixelFromCoordinate(G[0]),f=r.getPixelFromCoordinate(G[1]),_=$a(e,v),y=$a(e,f);Math.sqrt(Math.min(_,y))<=this.pixelTolerance_&&(s=!0,$=_>y?G[1]:G[0],p=r.getPixelFromCoordinate($))}else if(this.edge_){var N=u.feature.getGeometry().getType()===aa.CIRCLE;if(N){var W=u.feature.getGeometry(),x=Ra();x&&(W=W.clone().transform(x,l)),$=Fb(Wo(h,W),l)}else md[0]=oa(G[0],l),md[1]=oa(G[1],l),$=Fb(Oe(h,md),l);if(p=r.getPixelFromCoordinate($),Qe(e,p)<=this.pixelTolerance_&&(s=!0,this.vertex_&&!N)){v=r.getPixelFromCoordinate(G[0]),f=r.getPixelFromCoordinate(G[1]),_=$a(p,v),y=$a(p,f);Math.sqrt(Math.min(_,y))<=this.pixelTolerance_&&($=_>y?G[1]:G[0],p=r.getPixelFromCoordinate($))}}return s&&(p=[Math.round(p[0]),Math.round(p[1])]),{snapped:s,vertex:$,vertexPixel:p}},t.prototype.updateFeature_=function(e){this.removeFeature(e,!1),this.addFeature(e,!1)},t.prototype.writeCircleGeometry_=function(e,t){var r=this.getMap().getView().getProjection(),n=t,o=Ra();o&&(n=n.clone().transform(o,r));var i=Id(n);o&&i.transform(r,o);for(var a=i.getCoordinates()[0],s=0,$=a.length-1;s<$;++s){var p=a.slice(s,s+2),u={feature:e,segment:p};this.rBush_.insert(Da(p),u)}},t.prototype.writeGeometryCollectionGeometry_=function(e,t){for(var r=t.getGeometriesArray(),n=0;n<r.length;++n){var o=this.SEGMENT_WRITERS_[r[n].getType()];o&&o(e,r[n])}},t.prototype.writeLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),n=0,o=r.length-1;n<o;++n){var i=r.slice(n,n+2),a={feature:e,segment:i};this.rBush_.insert(Da(i),a)}},t.prototype.writeMultiLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),n=0,o=r.length;n<o;++n)for(var i=r[n],a=0,s=i.length-1;a<s;++a){var $=i.slice(a,a+2),p={feature:e,segment:$};this.rBush_.insert(Da($),p)}},t.prototype.writeMultiPointGeometry_=function(e,t){for(var r=t.getCoordinates(),n=0,o=r.length;n<o;++n){var i=r[n],a={feature:e,segment:[i,i]};this.rBush_.insert(t.getExtent(),a)}},t.prototype.writeMultiPolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),n=0,o=r.length;n<o;++n)for(var i=r[n],a=0,s=i.length;a<s;++a)for(var $=i[a],p=0,u=$.length-1;p<u;++p){var l=$.slice(p,p+2),h={feature:e,segment:l};this.rBush_.insert(Da(l),h)}},t.prototype.writePointGeometry_=function(e,t){var r=t.getCoordinates(),n={feature:e,segment:[r,r]};this.rBush_.insert(t.getExtent(),n)},t.prototype.writePolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),n=0,o=r.length;n<o;++n)for(var i=r[n],a=0,s=i.length-1;a<s;++a){var $=i.slice(a,a+2),p={feature:e,segment:$};this.rBush_.insert(Da($),p)}},t}(hb);Bi.default=Lr;var Gf={};var ym=Gf&&Gf.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function a(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}(),Ci={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"},Hf=function(t){function e(e,r,a,n,o){var i=t.call(this,e)||this;return i.features=r,i.coordinate=a,i.startCoordinate=n,i.mapBrowserEvent=o,i}return ym(e,t),e}(Ka);Gf.TranslateEvent=Hf;var Mr=function(t){function e(e){var r,a=this,n=e||{};if((a=t.call(this,n)||this).lastCoordinate_=null,a.startCoordinate_=null,a.features_=void 0!==n.features?n.features:null,n.layers){if("function"==typeof n.layers)r=n.layers;else{var o=n.layers;r=function(t){return pc(o,t)}}}else r=Xa;return a.layerFilter_=r,a.filter_=n.filter?n.filter:Xa,a.hitTolerance_=n.hitTolerance?n.hitTolerance:0,a.lastFeature_=null,a.addEventListener(xa(hf.ACTIVE),a.handleActiveChanged_),a}return ym(e,t),e.prototype.handleDownEvent=function(t){if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=t.coordinate,this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);var e=this.features_||new Ja([this.lastFeature_]);return this.dispatchEvent(new Hf(Ci.TRANSLATESTART,e,t.coordinate,this.startCoordinate_,t)),!0}return!1},e.prototype.handleUpEvent=function(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);var e=this.features_||new Ja([this.lastFeature_]);return this.dispatchEvent(new Hf(Ci.TRANSLATEEND,e,t.coordinate,this.startCoordinate_,t)),this.startCoordinate_=null,!0}return!1},e.prototype.handleDragEvent=function(t){if(this.lastCoordinate_){var e=t.coordinate,r=e[0]-this.lastCoordinate_[0],a=e[1]-this.lastCoordinate_[1],n=this.features_||new Ja([this.lastFeature_]);n.forEach(function(t){var e=t.getGeometry();e.translate(r,a),t.setGeometry(e)}),this.lastCoordinate_=e,this.dispatchEvent(new Hf(Ci.TRANSLATING,n,e,this.startCoordinate_,t))}},e.prototype.handleMoveEvent=function(t){var e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")},e.prototype.featuresAtPixel_=function(t,e){return e.forEachFeatureAtPixel(t,function(t,e){if(this.filter_(t,e)&&(!this.features_||pc(this.features_.getArray(),t)))return t}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},e.prototype.getHitTolerance=function(){return this.hitTolerance_},e.prototype.setHitTolerance=function(t){this.hitTolerance_=t},e.prototype.setMap=function(e){var r=this.getMap();t.prototype.setMap.call(this,e),this.updateState_(r)},e.prototype.handleActiveChanged_=function(){this.updateState_(null)},e.prototype.updateState_=function(t){var e=this.getMap(),r=this.getActive();e&&r||(e=e||t)&&e.getViewport().classList.remove("ol-grab","ol-grabbing")},e}(hb);Gf.default=Mr;var Nr=Qg&&Qg.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var e in t)t.hasOwnProperty(e)&&(r[e]=t[e])})(t,e)};return function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),zm=function(r){function t(t){return(t=ha({},t)).controls||(t.controls=Xk()),t.interactions||(t.interactions=wl()),r.call(this,t)||this}return Nr(t,r),t.prototype.createRenderer=function(){return new ef(this)},t}(Ye);Qg.default=zm;var If={};var Di={};var Ei={};var Am=.5;var qb=!0;var Fi={};var Gi={};var Or=Gi&&Gi.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Jc=function(t){function e(e,i,r){var n=t.call(this)||this,o=r||{};return n.tileCoord=e,n.state=i,n.interimTile=null,n.hifi=!0,n.key="",n.transition_=void 0===o.transition?250:o.transition,n.transitionStarts_={},n}return Or(e,t),e.prototype.changed=function(){this.dispatchEvent(ca.CHANGE)},e.prototype.release=function(){},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==ba.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==ba.LOADED){t.interimTile=null;break}t.getState()==ba.LOADING?e=t:t.getState()==ba.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){if(this.state!==ba.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},e.prototype.load=function(){ma()},e.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;var r=e-i+1e3/60;return r>=this.transition_?1:yk(r/this.transition_)},e.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(qc);Gi.default=Jc;var Pr=Fi&&Fi.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),Hi=function(t){function e(e,i,s,r,n,a){var o=t.call(this,e,i,a)||this;return o.crossOrigin_=r,o.src_=s,o.image_=new Image,null!==r&&(o.image_.crossOrigin=r),o.unlisten_=null,o.tileLoadFunction_=n,o}return Pr(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.getKey=function(){return this.src_},e.prototype.handleImageError_=function(){this.state=ba.ERROR,this.unlistenImage_(),this.image_=Qr(),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=ba.LOADED:this.state=ba.EMPTY,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==ba.ERROR&&(this.state=ba.IDLE,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==ba.IDLE&&(this.state=ba.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=yf(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(Jc);function Qr(){var t=Ea(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}Fi.default=Hi;var Ii={};var Rr=function(){function e(e){this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return e.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},e.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},e.prototype.containsKey=function(e){return this.entries_.hasOwnProperty(e)},e.prototype.forEach=function(e){for(var t=this.oldest_;t;)e(t.value_,t.key_,this),t=t.newer},e.prototype.get=function(e,t){var r=this.entries_[e];return ea(void 0!==r,15),r===this.newest_?r.value_:(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r,r.value_)},e.prototype.remove=function(e){var t=this.entries_[e];return ea(void 0!==t,15),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_},e.prototype.getCount=function(){return this.count_},e.prototype.getKeys=function(){var e,t=new Array(this.count_),r=0;for(e=this.newest_;e;e=e.older)t[r++]=e.key_;return t},e.prototype.getValues=function(){var e,t=new Array(this.count_),r=0;for(e=this.newest_;e;e=e.older)t[r++]=e.value_;return t},e.prototype.peekLast=function(){return this.oldest_.value_},e.prototype.peekLastKey=function(){return this.oldest_.key_},e.prototype.peekFirstKey=function(){return this.newest_.key_},e.prototype.pop=function(){var e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_},e.prototype.replace=function(e,t){this.get(e),this.entries_[e].value_=t},e.prototype.set=function(e,t){ea(!(e in this.entries_),16);var r={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_},e.prototype.setSize=function(e){this.highWaterMark=e},e}();function Ji(e,t,$,r){return void 0!==r?(r[0]=e,r[1]=t,r[2]=$,r):[e,t,$]}function hc(e,t,$){return e+"/"+t+"/"+$}function Bm(e){return hc(e[0],e[1],e[2])}function Cm(e){return e.split("/").map(Number)}function Ki(e){return(e[1]<<e[0])+e[2]}function Sr(e,t){var $=e[0],r=e[1],a=e[2];if(t.getMinZoom()>$||$>t.getMaxZoom())return!1;var n,o=t.getExtent();return!(n=o?t.getTileRangeForExtentAndZ(o,$):t.getFullTileRange($))||n.containsXY(r,a)}var Tr=Ii&&Ii.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Jf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Tr(t,e),t.prototype.expireCache=function(e){for(;this.canExpireCache();){if(this.peekLast().getKey()in e)break;this.pop().release()}},t.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var e=this.peekFirstKey(),t=Cm(e)[0];this.forEach(function(e){e.tileCoord[0]!==t&&(this.remove(Bm(e.tileCoord)),e.release())}.bind(this))}},t}(Rr);Ii.default=Jf;var Li={};function Kf(e,t,r,a){var o=Tc(r,t,e),$=vg(t,a,r),n=t.getMetersPerUnit();void 0!==n&&($*=n);var i=e.getMetersPerUnit();void 0!==i&&($/=i);var l=e.getExtent();if(!l||tc(l,o)){var s=vg(e,$,o)/$;isFinite(s)&&s>0&&($/=s)}return $}function Mi(e,t,r,a){var o=r-e,$=a-t,n=Math.sqrt(o*o+$*$);return[Math.round(r+o/n),Math.round(a+$/n)]}function Dm(e,t,r,a,o,$,n,i,l,s,c){var p=Ea(Math.round(r*e),Math.round(r*t));if(0===l.length)return p.canvas;p.scale(r,r);var u=Ha();l.forEach(function(e,t,r){Bg(u,e.extent)});var g=la(u),v=va(u),U=Ea(Math.round(r*g/a),Math.round(r*v/a)),m=r/a;l.forEach(function(e,t,r){var a=e.extent[0]-u[0],o=-(e.extent[3]-u[3]),$=la(e.extent),n=va(e.extent);U.drawImage(e.image,s,s,e.image.width-2*s,e.image.height-2*s,a*m,o*m,$*m,n*m)});var h=fb(n);return i.getTriangles().forEach(function(e,t,o){var n=e.source,i=e.target,l=n[0][0],s=n[0][1],c=n[1][0],g=n[1][1],v=n[2][0],m=n[2][1],d=(i[0][0]-h[0])/$,f=-(i[0][1]-h[1])/$,x=(i[1][0]-h[0])/$,P=-(i[1][1]-h[1])/$,C=(i[2][0]-h[0])/$,M=-(i[2][1]-h[1])/$,T=l,E=s;l=0,s=0,c-=T,g-=E,v-=T,m-=E;var j=Rn([[c,g,0,0,x-d],[v,m,0,0,C-d],[0,0,c,g,P-f],[0,0,v,m,M-f]]);if(j){p.save(),p.beginPath();var q=(d+x+C)/3,R=(f+P+M)/3,S=Mi(q,R,d,f),b=Mi(q,R,x,P),k=Mi(q,R,C,M);p.moveTo(b[0],b[1]),p.lineTo(S[0],S[1]),p.lineTo(k[0],k[1]),p.clip(),p.transform(j[0],j[2],j[1],j[3],d,f),p.translate(u[0]-T,u[3]-E),p.scale(a/r,-a/r),p.drawImage(U.canvas,0,0),p.restore()}}),c&&(p.save(),p.strokeStyle="black",p.lineWidth=1,i.getTriangles().forEach(function(e,t,r){var a=e.target,o=(a[0][0]-h[0])/$,n=-(a[0][1]-h[1])/$,i=(a[1][0]-h[0])/$,l=-(a[1][1]-h[1])/$,s=(a[2][0]-h[0])/$,c=-(a[2][1]-h[1])/$;p.beginPath(),p.moveTo(i,l),p.lineTo(o,n),p.lineTo(s,c),p.closePath(),p.stroke()}),p.restore()),p.canvas}var Ur=10,Em=.25,Fm=function(){function t(t,i,r,o,e,s){this.sourceProj_=t,this.targetProj_=i;var a={},n=Cb(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var i=t[0]+"/"+t[1];return a[i]||(a[i]=n(t)),a[i]},this.maxSourceExtent_=o,this.errorThresholdSquared_=e*e,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!o&&!!this.sourceProj_.getExtent()&&la(o)==la(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?la(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?la(this.targetProj_.getExtent()):null;var h=fb(r),$=vc(r),u=uc(r),d=Yb(r),_=this.transformInv_(h),c=this.transformInv_($),l=this.transformInv_(u),p=this.transformInv_(d),m=Ur+(s?Math.max(0,Math.ceil(Math.log2(qe(r)/(s*s*256*256)))):0);if(this.addQuad_(h,$,u,d,_,c,l,p,m),this.wrapsXInSource_){var f=1/0;this.triangles_.forEach(function(t,i,r){f=Math.min(f,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-f>this.sourceWorldWidth_/2){var i=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];i[0][0]-f>this.sourceWorldWidth_/2&&(i[0][0]-=this.sourceWorldWidth_),i[1][0]-f>this.sourceWorldWidth_/2&&(i[1][0]-=this.sourceWorldWidth_),i[2][0]-f>this.sourceWorldWidth_/2&&(i[2][0]-=this.sourceWorldWidth_);var r=Math.min(i[0][0],i[1][0],i[2][0]);Math.max(i[0][0],i[1][0],i[2][0])-r<this.sourceWorldWidth_/2&&(t.source=i)}}.bind(this))}a={}}return t.prototype.addTriangle_=function(t,i,r,o,e,s){this.triangles_.push({source:[o,e,s],target:[t,i,r]})},t.prototype.addQuad_=function(t,i,r,o,e,s,a,n,h){var $=Da([e,s,a,n]),u=this.sourceWorldWidth_?la($)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,_=this.sourceProj_.canWrapX()&&u>.5&&u<1,c=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var l=Da([t,i,r,o]);c=la(l)/this.targetWorldWidth_>Em||c}!_&&this.sourceProj_.isGlobal()&&u&&(c=u>Em||c)}if(c||!this.maxSourceExtent_||ya($,this.maxSourceExtent_)){if(!(c||isFinite(e[0])&&isFinite(e[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(n[0])&&isFinite(n[1]))){if(!(h>0))return;c=!0}if(h>0){if(!c){var p=[(t[0]+r[0])/2,(t[1]+r[1])/2],m=this.transformInv_(p),f=void 0;if(_)f=(cb(e[0],d)+cb(a[0],d))/2-cb(m[0],d);else f=(e[0]+a[0])/2-m[0];var g=(e[1]+a[1])/2-m[1];c=f*f+g*g>this.errorThresholdSquared_}if(c){if(Math.abs(t[0]-r[0])<=Math.abs(t[1]-r[1])){var W=[(i[0]+r[0])/2,(i[1]+r[1])/2],R=this.transformInv_(W),B=[(o[0]+t[0])/2,(o[1]+t[1])/2],Y=this.transformInv_(B);this.addQuad_(t,i,W,B,e,s,R,Y,h-1),this.addQuad_(B,W,r,o,Y,R,a,n,h-1)}else{var v=[(t[0]+i[0])/2,(t[1]+i[1])/2],I=this.transformInv_(v),x=[(r[0]+o[0])/2,(r[1]+o[1])/2],E=this.transformInv_(x);this.addQuad_(t,v,x,o,e,I,E,n,h-1),this.addQuad_(v,i,r,x,I,s,a,E,h-1)}return}}if(_){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(t,r,o,e,a,n),this.addTriangle_(t,i,r,e,s,a)}},t.prototype.calculateSourceExtent=function(){var t=Ha();return this.triangles_.forEach(function(i,r,o){var e=i.source;Vc(t,e[0]),Vc(t,e[1]),Vc(t,e[2])}),t},t.prototype.getTriangles=function(){return this.triangles_},t}();var Vr=Li&&Li.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Gm=function(t){function e(e,r,i,o,l,s,$,n,a,d,p){var u=t.call(this,l,ba.IDLE)||this;u.renderEdges_=void 0!==p&&p,u.pixelRatio_=$,u.gutter_=n,u.canvas_=null,u.sourceTileGrid_=r,u.targetTileGrid_=o,u.wrappedTileCoord_=s||l,u.sourceTiles_=[],u.sourcesListenerKeys_=null,u.sourceZ_=0;var c=o.getTileCoordExtent(u.wrappedTileCoord_),_=u.targetTileGrid_.getExtent(),O=u.sourceTileGrid_.getExtent(),T=_?vb(c,_):c;if(0===qe(T))return u.state=ba.EMPTY,u;var h=e.getExtent();h&&(O=O?vb(O,h):h);var g=o.getResolution(u.wrappedTileCoord_[0]),W=Ma(T),m=Kf(e,i,W,g);if(!isFinite(m)||m<=0)return u.state=ba.EMPTY,u;var f=void 0!==d?d:Am;if(u.triangulation_=new Fm(e,i,T,O,m*f,g),0===u.triangulation_.getTriangles().length)return u.state=ba.EMPTY,u;u.sourceZ_=r.getZForResolution(m);var E=u.triangulation_.calculateSourceExtent();if(O&&(e.canWrapX()?(E[1]=ja(E[1],O[1],O[3]),E[3]=ja(E[3],O[1],O[3])):E=vb(E,O)),qe(E)){for(var v=r.getTileRangeForExtentAndZ(E,u.sourceZ_),S=v.minX;S<=v.maxX;S++)for(var x=v.minY;x<=v.maxY;x++){var y=a(u.sourceZ_,S,x,$);y&&u.sourceTiles_.push(y)}0===u.sourceTiles_.length&&(u.state=ba.EMPTY)}else u.state=ba.EMPTY;return u}return Vr(e,t),e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,r,i){e&&e.getState()==ba.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=ba.ERROR;else{var e=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(e),i="number"==typeof r?r:r[0],o="number"==typeof r?r:r[1],l=this.targetTileGrid_.getResolution(e),s=this.sourceTileGrid_.getResolution(this.sourceZ_),$=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Dm(i,o,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),l,$,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=ba.LOADED}this.changed()},e.prototype.load=function(){if(this.state==ba.IDLE){this.state=ba.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,r,i){var o=e.getState();if(o==ba.IDLE||o==ba.LOADING){t++;var l=fa(e,ca.CHANGE,function(r){var i=e.getState();i!=ba.LOADED&&i!=ba.ERROR&&i!=ba.EMPTY||(ra(l),0===--t&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(l)}}.bind(this)),this.sourceTiles_.forEach(function(t,e,r){t.getState()==ba.IDLE&&t.load()}),0===t&&setTimeout(this.reproject_.bind(this),0)}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(ra),this.sourcesListenerKeys_=null},e}(Jc);Li.default=Gm;var Ni={};function Wr(e,r){var t=/\{z\}/g,p=/\{x\}/g,o=/\{y\}/g,$=/\{-y\}/g;return function(n,a,l){return n?e.replace(t,n[0].toString()).replace(p,n[1].toString()).replace(o,n[2].toString()).replace($,function(){var e=n[0],t=r.getFullTileRange(e);return ea(t,55),(t.getHeight()-n[2]-1).toString()}):void 0}}function Oi(e,r){for(var t=e.length,p=new Array(t),o=0;o<t;++o)p[o]=Wr(e[o],r);return Vd(p)}function Vd(e){return 1===e.length?e[0]:function(r,t,p){if(r){var o=Ki(r),$=cb(o,e.length);return e[$](r,t,p)}}}function Pi(e,r,t){}function Qi(e){var r=[],t=/\{([a-z])-([a-z])\}/.exec(e);if(t){var p=t[1].charCodeAt(0),o=t[2].charCodeAt(0),$=void 0;for($=p;$<=o;++$)r.push(e.replace(t[0],String.fromCharCode($)));return r}if(t=/\{(\d+)-(\d+)\}/.exec(e)){for(var n=parseInt(t[2],10),a=parseInt(t[1],10);a<=n;a++)r.push(e.replace(t[0],a.toString()));return r}return r.push(e),r}var Lf={};function Hm(e){var r=e.getDefaultTileGrid();return r||(r=Jm(e),e.setDefaultTileGrid(r)),r}function Xr(e,r,t){var x=r[0],o=e.getTileCoordCenter(r),$=Kc(t);if(tc($,o))return r;var i=la($),n=Math.ceil(($[0]-o[0])/i);return o[0]+=i*n,e.getTileCoordForCoordAndZ(o,x)}function Yr(e,r,t,x){var o=void 0!==x?x:ud.TOP_LEFT,$=Im(e,r,t);return new Xd({extent:e,origin:go(e,o),resolutions:$,tileSize:t})}function Wd(e){var r=e||{},t=r.extent||pa("EPSG:3857").getExtent(),x={extent:t,minZoom:r.minZoom,tileSize:r.tileSize,resolutions:Im(t,r.maxZoom,r.tileSize,r.maxResolution)};return new Xd(x)}function Im(e,r,t,x){for(var o=void 0!==r?r:Vo,$=va(e),i=la(e),n=Oa(void 0!==t?t:Bc),E=x>0?x:Math.max(i/n[0],$/n[1]),p=o+1,R=new Array(p),a=0;a<p;++a)R[a]=E/Math.pow(2,a);return R}function Jm(e,r,t,x){return Yr(Kc(e),r,t,x)}function Kc(e){var r=(e=pa(e)).getExtent();if(!r){var t=180*ob[Qa.DEGREES]/e.getMetersPerUnit();r=nb(-t,-t,t,t)}return r}var Zr=[0,0,0],Xd=function(){function t(t){var i;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,ea(Ln(this.resolutions_,function(t,i){return i-t},!0),17),!t.origins)for(var e=0,o=this.resolutions_.length-1;e<o;++e)if(i){if(this.resolutions_[e]/this.resolutions_[e+1]!==i){i=void 0;break}}else i=this.resolutions_[e]/this.resolutions_[e+1];this.zoomFactor_=i,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,ea(this.origins_.length==this.resolutions_.length,20));var r=t.extent;void 0===r||this.origin_||this.origins_||(this.origin_=fb(r)),ea(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,ea(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:Bc,ea(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==r?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(function(t,i){return new Fg(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))},this):r&&this.calculateTileRanges_(r)}return t.prototype.forEachTileCoord=function(t,i,e){for(var o=this.getTileRangeForExtentAndZ(t,i),r=o.minX,n=o.maxX;r<=n;++r)for(var s=o.minY,l=o.maxY;s<=l;++s)e([i,r,s])},t.prototype.forEachTileCoordParentTileRange=function(t,i,e,o){var r,n,s,l=null,p=t[0]-1;for(2===this.zoomFactor_?(n=t[1],s=t[2]):l=this.getTileCoordExtent(t,o);p>=this.minZoom;){if(2===this.zoomFactor_?(n=Math.floor(n/2),s=Math.floor(s/2),r=Gg(n,n,s,s,e)):r=this.getTileRangeForExtentAndZ(l,p,e),i(p,r))return!0;--p}return!1},t.prototype.getExtent=function(){return this.extent_},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},t.prototype.getResolution=function(t){return this.resolutions_[t]},t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.getTileCoordChildTileRange=function(t,i,e){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var o=2*t[1],r=2*t[2];return Gg(o,o+1,r,r+1,i)}var n=this.getTileCoordExtent(t,e);return this.getTileRangeForExtentAndZ(n,t[0]+1,i)}return null},t.prototype.getTileRangeExtent=function(t,i,e){var o=this.getOrigin(t),r=this.getResolution(t),n=Oa(this.getTileSize(t),this.tmpSize_),s=o[0]+i.minX*n[0]*r,l=o[0]+(i.maxX+1)*n[0]*r,p=o[1]+i.minY*n[1]*r,h=o[1]+(i.maxY+1)*n[1]*r;return nb(s,p,l,h,e)},t.prototype.getTileRangeForExtentAndZ=function(t,i,e){var o=Zr;this.getTileCoordForXYAndZ_(t[0],t[3],i,!1,o);var r=o[1],n=o[2];return this.getTileCoordForXYAndZ_(t[2],t[1],i,!0,o),Gg(r,o[1],n,o[2],e)},t.prototype.getTileCoordCenter=function(t){var i=this.getOrigin(t[0]),e=this.getResolution(t[0]),o=Oa(this.getTileSize(t[0]),this.tmpSize_);return[i[0]+(t[1]+.5)*o[0]*e,i[1]-(t[2]+.5)*o[1]*e]},t.prototype.getTileCoordExtent=function(t,i){var e=this.getOrigin(t[0]),o=this.getResolution(t[0]),r=Oa(this.getTileSize(t[0]),this.tmpSize_),n=e[0]+t[1]*r[0]*o,s=e[1]-(t[2]+1)*r[1]*o,l=n+r[0]*o,p=s+r[1]*o;return nb(n,s,l,p,i)},t.prototype.getTileCoordForCoordAndResolution=function(t,i,e){return this.getTileCoordForXYAndResolution_(t[0],t[1],i,!1,e)},t.prototype.getTileCoordForXYAndResolution_=function(t,i,e,o,r){var n=this.getZForResolution(e),s=e/this.getResolution(n),l=this.getOrigin(n),p=Oa(this.getTileSize(n),this.tmpSize_),h=o?.5:0,a=o?.5:0,u=Math.floor((t-l[0])/e+h),$=Math.floor((l[1]-i)/e+a),g=s*u/p[0],d=s*$/p[1];return o?(g=Math.ceil(g)-1,d=Math.ceil(d)-1):(g=Math.floor(g),d=Math.floor(d)),Ji(n,g,d,r)},t.prototype.getTileCoordForXYAndZ_=function(t,i,e,o,r){var n=this.getOrigin(e),s=this.getResolution(e),l=Oa(this.getTileSize(e),this.tmpSize_),p=o?.5:0,h=o?.5:0,a=Math.floor((t-n[0])/s+p),u=Math.floor((n[1]-i)/s+h),$=a/l[0],g=u/l[1];return o?($=Math.ceil($)-1,g=Math.ceil(g)-1):($=Math.floor($),g=Math.floor(g)),Ji(e,$,g,r)},t.prototype.getTileCoordForCoordAndZ=function(t,i,e){return this.getTileCoordForXYAndZ_(t[0],t[1],i,!1,e)},t.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},t.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},t.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},t.prototype.getZForResolution=function(t,i){var e=pd(this.resolutions_,t,i||0);return ja(e,this.minZoom,this.maxZoom)},t.prototype.calculateTileRanges_=function(t){for(var i=this.resolutions_.length,e=new Array(i),o=this.minZoom;o<i;++o)e[o]=this.getTileRangeForExtentAndZ(t,o);this.fullTileRanges_=e},t}();var Km=Lf&&Lf.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Mf=function(e){function t(t){var i=e.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX})||this;i.opaque_=void 0!==t.opaque&&t.opaque,i.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,i.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;var r=[256,256],o=t.tileGrid;o&&Oa(o.getTileSize(o.getMinZoom()),r);var n="undefined"!=typeof screen,a=n?screen.availWidth||screen.width:1920,p=n?screen.availHeight||screen.height:1080,c=4*Math.ceil(a/r[0])*Math.ceil(p/r[1]);return i.tileCache=new Jf(Math.max(c,t.cacheSize||0)),i.tmpSize=[0,0],i.key_=t.key||"",i.tileOptions={transition:t.transition},i.zDirection=t.zDirection?t.zDirection:0,i}return Km(t,e),t.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},t.prototype.expireCache=function(e,t){var i=this.getTileCacheForProjection(e);i&&i.expireCache(t)},t.prototype.forEachLoadedTile=function(e,t,i,r){var o=this.getTileCacheForProjection(e);if(!o)return!1;for(var n,a,p,c=!0,l=i.minX;l<=i.maxX;++l)for(var $=i.minY;$<=i.maxY;++$)a=hc(t,l,$),p=!1,o.containsKey(a)&&(p=(n=o.get(a)).getState()===ba.LOADED)&&(p=!1!==r(n)),p||(c=!1);return c},t.prototype.getGutterForProjection=function(e){return 0},t.prototype.getKey=function(){return this.key_},t.prototype.setKey=function(e){this.key_!==e&&(this.key_=e,this.changed())},t.prototype.getOpaque=function(e){return this.opaque_},t.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},t.prototype.getTile=function(e,t,i,r,o){return ma()},t.prototype.getTileGrid=function(){return this.tileGrid},t.prototype.getTileGridForProjection=function(e){return this.tileGrid?this.tileGrid:Hm(e)},t.prototype.getTileCacheForProjection=function(e){var t=this.getProjection();return t&&!lb(t,e)?null:this.tileCache},t.prototype.getTilePixelRatio=function(e){return this.tilePixelRatio_},t.prototype.getTilePixelSize=function(e,t,i){var r=this.getTileGridForProjection(i),o=this.getTilePixelRatio(t),n=Oa(r.getTileSize(e),this.tmpSize);return 1==o?n:th(n,o,this.tmpSize)},t.prototype.getTileCoordForTileUrlFunction=function(e,t){var i=void 0!==t?t:this.getProjection(),r=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=Xr(r,e,i)),Sr(e,r)?e:null},t.prototype.clear=function(){this.tileCache.clear()},t.prototype.refresh=function(){this.clear(),e.prototype.refresh.call(this)},t.prototype.useTile=function(e,t,i,r){},t}(jd),Lm=function(e){function t(t,i){var r=e.call(this,t)||this;return r.tile=i,r}return Km(t,e),t}(Ka);Lf.TileSourceEvent=Lm,Lf.default=Mf;var Ri={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};var $r=Ni&&Ni.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Si=function(t){function e(e){var i=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;return i.generateTileUrlFunction_=!e.tileUrlFunction,i.tileLoadFunction=e.tileLoadFunction,i.tileUrlFunction=e.tileUrlFunction?e.tileUrlFunction.bind(i):Pi,i.urls=null,e.urls?i.setUrls(e.urls):e.url&&i.setUrl(e.url),i.tileLoadingKeys_={},i}return $r(e,t),e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var e,i=t.target,r=da(i),n=i.getState();n==ba.LOADING?(this.tileLoadingKeys_[r]=!0,e=Ri.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],e=n==ba.ERROR?Ri.TILELOADERROR:n==ba.LOADED?Ri.TILELOADEND:void 0),null!=e&&this.dispatchEvent(new Lm(e,i))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},e.prototype.setUrl=function(t){var e=Qi(t);this.urls=e,this.setUrls(e)},e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(Oi(t,this.tileGrid),e):this.setKey(e)},e.prototype.useTile=function(t,e,i){var r=hc(t,e,i);this.tileCache.containsKey(r)&&this.tileCache.get(r)},e}(Mf);Ni.default=Si;var _r=Ei&&Ei.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Qb=function(e){function t(t){var i=e.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:as,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})||this;return i.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,i.tileClass=void 0!==t.tileClass?t.tileClass:Hi,i.tileCacheForProjection={},i.tileGridForProjection={},i.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,i.renderReprojectionEdges_=!1,i}return _r(t,e),t.prototype.canExpireCache=function(){if(!qb)return e.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},t.prototype.expireCache=function(t,i){if(qb){var r=this.getTileCacheForProjection(t);for(var o in this.tileCache.expireCache(this.tileCache==r?i:{}),this.tileCacheForProjection){var n=this.tileCacheForProjection[o];n.expireCache(n==r?i:{})}}else e.prototype.expireCache.call(this,t,i)},t.prototype.getGutterForProjection=function(e){return qb&&this.getProjection()&&e&&!lb(this.getProjection(),e)?0:this.getGutter()},t.prototype.getGutter=function(){return 0},t.prototype.getOpaque=function(t){return!(qb&&this.getProjection()&&t&&!lb(this.getProjection(),t))&&e.prototype.getOpaque.call(this,t)},t.prototype.getTileGridForProjection=function(t){if(!qb)return e.prototype.getTileGridForProjection.call(this,t);var i=this.getProjection();if(!this.tileGrid||i&&!lb(i,t)){var r=da(t);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=Hm(t)),this.tileGridForProjection[r]}return this.tileGrid},t.prototype.getTileCacheForProjection=function(t){if(!qb)return e.prototype.getTileCacheForProjection.call(this,t);var i=this.getProjection();if(!i||lb(i,t))return this.tileCache;var r=da(t);return r in this.tileCacheForProjection||(this.tileCacheForProjection[r]=new Jf(this.tileCache.highWaterMark)),this.tileCacheForProjection[r]},t.prototype.createTile_=function(e,t,i,r,o,n){var l=[e,t,i],c=this.getTileCoordForTileUrlFunction(l,o),a=c?this.tileUrlFunction(c,r,o):void 0,u=new this.tileClass(l,void 0!==a?ba.IDLE:ba.EMPTY,void 0!==a?a:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=n,u.addEventListener(ca.CHANGE,this.handleTileChange.bind(this)),u},t.prototype.getTile=function(e,t,i,r,o){var n=this.getProjection();if(qb&&n&&o&&!lb(n,o)){var l=this.getTileCacheForProjection(o),c=[e,t,i],a=void 0,u=Bm(c);l.containsKey(u)&&(a=l.get(u));var s=this.getKey();if(a&&a.key==s)return a;var $=this.getTileGridForProjection(n),p=this.getTileGridForProjection(o),h=this.getTileCoordForTileUrlFunction(c,o),d=new Gm(n,$,o,p,c,h,this.getTilePixelRatio(r),this.getGutter(),function(e,t,i,r){return this.getTileInternal(e,t,i,r,n)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return d.key=s,a?(d.interimTile=a,d.refreshInterimChain(),l.replace(u,d)):l.set(u,d),d}return this.getTileInternal(e,t,i,r,n||o)},t.prototype.getTileInternal=function(e,t,i,r,o){var n=null,l=hc(e,t,i),c=this.getKey();if(this.tileCache.containsKey(l)){if((n=this.tileCache.get(l)).key!=c){var a=n;n=this.createTile_(e,t,i,r,o,c),a.getState()==ba.IDLE?n.interimTile=a.interimTile:n.interimTile=a,n.refreshInterimChain(),this.tileCache.replace(l,n)}}else n=this.createTile_(e,t,i,r,o,c),this.tileCache.set(l,n);return n},t.prototype.setRenderReprojectionEdges=function(e){if(qb&&this.renderReprojectionEdges_!=e){for(var t in this.renderReprojectionEdges_=e,this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}},t.prototype.setTileGridForProjection=function(e,t){if(qb){var i=pa(e);if(i){var r=da(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}},t}(Si);function as(e,t){e.getImage().src=t}Ei.default=Qb;var bs=Di&&Di.__extends||function(){var t=function(o,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var r in o)o.hasOwnProperty(r)&&(t[r]=o[r])})(o,r)};return function(o,r){function e(){this.constructor=o}t(o,r),o.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}(),rb=function(t){function o(o){var r=o||{},e=void 0!==r.projection?r.projection:"EPSG:3857",i=void 0!==r.tileGrid?r.tileGrid:Wd({extent:Kc(e),maxResolution:r.maxResolution,maxZoom:r.maxZoom,minZoom:r.minZoom,tileSize:r.tileSize});return t.call(this,{attributions:r.attributions,cacheSize:r.cacheSize,crossOrigin:r.crossOrigin,opaque:r.opaque,projection:e,reprojectionErrorThreshold:r.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:r.tileLoadFunction,tilePixelRatio:r.tilePixelRatio,tileUrlFunction:r.tileUrlFunction,url:r.url,urls:r.urls,wrapX:void 0===r.wrapX||r.wrapX,transition:r.transition,attributionsCollapsible:r.attributionsCollapsible,zDirection:r.zDirection})||this}return bs(o,t),o}(Qb);Di.default=rb;var cs=If&&If.__extends||function(){var t=function(r,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])})(r,o)};return function(r,o){function e(){this.constructor=r}t(r,o),r.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}}(),Mm="&#169; <a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">OpenStreetMap</a> contributors.";If.ATTRIBUTION=Mm;var Nm=function(t){function r(r){var o,e=r||{};o=void 0!==e.attributions?e.attributions:[Mm];var n=void 0!==e.crossOrigin?e.crossOrigin:"anonymous",i=void 0!==e.url?e.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";return t.call(this,{attributions:o,cacheSize:e.cacheSize,crossOrigin:n,opaque:void 0===e.opaque||e.opaque,maxZoom:void 0!==e.maxZoom?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,url:i,wrapX:e.wrapX,attributionsCollapsible:!1})||this}return cs(r,t),r}(rb);If.default=Nm;var Lc={};var ds=Lc&&Lc.__extends||function(){var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(o,e)};return function(o,e){function i(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ti=0,Om=function(t){function o(o){var e=t.call(this)||this,i=ha({},o);return e.hints_=[0,0],e.animations_=[],e.updateAnimationKey_,e.projection_=Sc(i.projection,"EPSG:3857"),e.viewportSize_=[100,100],e.targetCenter_=null,e.targetResolution_,e.targetRotation_,e.cancelAnchor_=void 0,i.center&&(i.center=oa(i.center,e.projection_)),i.extent&&(i.extent=Ua(i.extent,e.projection_)),e.applyOptions_(i),e}return ds(o,t),o.prototype.applyOptions_=function(t){var o=Qm(t);this.maxResolution_=o.maxResolution,this.minResolution_=o.minResolution,this.zoomFactor_=o.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=o.minZoom;var e=Pm(t),i=o.constraint,n=Rm(t);this.constraints_={center:e,resolution:i,rotation:n},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom),this.setProperties({}),this.options_=t},o.prototype.getUpdatedOptions_=function(t){var o=ha({},this.options_);return void 0!==o.resolution?o.resolution=this.getResolution():o.zoom=this.getZoom(),o.center=this.getCenterInternal(),o.rotation=this.getRotation(),ha({},o,t)},o.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var o=new Array(arguments.length),e=0;e<o.length;++e){var i=arguments[e];i.center&&((i=ha({},i)).center=oa(i.center,this.getProjection())),i.anchor&&((i=ha({},i)).anchor=oa(i.anchor,this.getProjection())),o[e]=i}this.animateInternal.apply(this,o)},o.prototype.animateInternal=function(t){var o,e=arguments.length;if(e>1&&"function"==typeof arguments[e-1]&&(o=arguments[e-1],--e),!this.isDef()){var i=arguments[e-1];return i.center&&this.setCenterInternal(i.center),void 0!==i.zoom&&this.setZoom(i.zoom),void 0!==i.rotation&&this.setRotation(i.rotation),void(o&&Nf(o,!0))}for(var n=Date.now(),r=this.targetCenter_.slice(),s=this.targetResolution_,a=this.targetRotation_,p=[],$=0;$<e;++$){var u=arguments[$],h={start:n,complete:!1,anchor:u.anchor,duration:void 0!==u.duration?u.duration:1e3,easing:u.easing||zk,callback:o};if(u.center&&(h.sourceCenter=r,h.targetCenter=u.center.slice(),r=h.targetCenter),void 0!==u.zoom?(h.sourceResolution=s,h.targetResolution=this.getResolutionForZoom(u.zoom),s=h.targetResolution):u.resolution&&(h.sourceResolution=s,h.targetResolution=u.resolution,s=h.targetResolution),void 0!==u.rotation){h.sourceRotation=a;var l=cb(u.rotation-a+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=a+l,a=h.targetRotation}Sm(h)?h.complete=!0:n+=h.duration,p.push(h)}this.animations_.push(p),this.setHint(qa.ANIMATING,1),this.updateAnimations_()},o.prototype.getAnimating=function(){return this.hints_[qa.ANIMATING]>0},o.prototype.getInteracting=function(){return this.hints_[qa.INTERACTING]>0},o.prototype.cancelAnimations=function(){var t;this.setHint(qa.ANIMATING,-this.hints_[qa.ANIMATING]);for(var o=0,e=this.animations_.length;o<e;++o){var i=this.animations_[o];if(i[0].callback&&Nf(i[0].callback,!1),!t)for(var n=0,r=i.length;n<r;++n){var s=i[n];if(!s.complete){t=s.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t},o.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),o=!1,e=this.animations_.length-1;e>=0;--e){for(var i=this.animations_[e],n=!0,r=0,s=i.length;r<s;++r){var a=i[r];if(!a.complete){var p=t-a.start,$=a.duration>0?p/a.duration:1;$>=1?(a.complete=!0,$=1):n=!1;var u=a.easing($);if(a.sourceCenter){var h=a.sourceCenter[0],l=a.sourceCenter[1],c=h+u*(a.targetCenter[0]-h),m=l+u*(a.targetCenter[1]-l);this.targetCenter_=[c,m]}if(a.sourceResolution&&a.targetResolution){var g=1===u?a.targetResolution:a.sourceResolution+u*(a.targetResolution-a.sourceResolution);if(a.anchor){var Z=this.getViewportSize_(this.getRotation()),O=this.constraints_.resolution(g,0,Z,!0);this.targetCenter_=this.calculateCenterZoom(O,a.anchor)}this.targetResolution_=g,this.applyTargetState_(!0)}if(void 0!==a.sourceRotation&&void 0!==a.targetRotation){var _=1===u?cb(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+u*(a.targetRotation-a.sourceRotation);if(a.anchor){var R=this.constraints_.rotation(_,!0);this.targetCenter_=this.calculateCenterRotate(R,a.anchor)}this.targetRotation_=_}if(this.applyTargetState_(!0),o=!0,!a.complete)break}}if(n){this.animations_[e]=null,this.setHint(qa.ANIMATING,-1);var v=i[0].callback;v&&Nf(v,!0)}}this.animations_=this.animations_.filter(Boolean),o&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},o.prototype.calculateCenterRotate=function(t,o){var e,i=this.getCenterInternal();return void 0!==i&&(e=[i[0]-o[0],i[1]-o[1]],Pe(e,t-this.getRotation()),ah(e,o)),e},o.prototype.calculateCenterZoom=function(t,o){var e,i=this.getCenterInternal(),n=this.getResolution();void 0!==i&&void 0!==n&&(e=[o[0]-t*(o[0]-i[0])/n,o[1]-t*(o[1]-i[1])/n]);return e},o.prototype.getViewportSize_=function(t){var o=this.viewportSize_;if(t){var e=o[0],i=o[1];return[Math.abs(e*Math.cos(t))+Math.abs(i*Math.sin(t)),Math.abs(e*Math.sin(t))+Math.abs(i*Math.cos(t))]}return o},o.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.resolveConstraints(0)},o.prototype.getCenter=function(){var t=this.getCenterInternal();return t?Fb(t,this.getProjection()):t},o.prototype.getCenterInternal=function(){return this.get(Ca.CENTER)},o.prototype.getConstraints=function(){return this.constraints_},o.prototype.getConstrainResolution=function(){return this.options_.constrainResolution},o.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},o.prototype.calculateExtent=function(t){var o=this.calculateExtentInternal(t);return $c(o,this.getProjection())},o.prototype.calculateExtentInternal=function(t){var o=t||this.getViewportSize_(),e=this.getCenterInternal();ea(e,1);var i=this.getResolution();ea(void 0!==i,2);var n=this.getRotation();return ea(void 0!==n,3),Wc(e,i,n,o)},o.prototype.getMaxResolution=function(){return this.maxResolution_},o.prototype.getMinResolution=function(){return this.minResolution_},o.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},o.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},o.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},o.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},o.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},o.prototype.getProjection=function(){return this.projection_},o.prototype.getResolution=function(){return this.get(Ca.RESOLUTION)},o.prototype.getResolutions=function(){return this.resolutions_},o.prototype.getResolutionForExtent=function(t,o){return this.getResolutionForExtentInternal(Ua(t,this.getProjection()),o)},o.prototype.getResolutionForExtentInternal=function(t,o){var e=o||this.getViewportSize_(),i=la(t)/e[0],n=va(t)/e[1];return Math.max(i,n)},o.prototype.getResolutionForValueFunction=function(t){var o=t||2,e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(e/i)/Math.log(o);return function(t){return e/Math.pow(o,t*n)}},o.prototype.getRotation=function(){return this.get(Ca.ROTATION)},o.prototype.getValueForResolutionFunction=function(t){var o=Math.log(t||2),e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(e/i)/o;return function(t){return Math.log(e/t)/o/n}},o.prototype.getState=function(){var t=this.getCenterInternal(),o=this.getProjection(),e=this.getResolution(),i=this.getRotation();return{center:t.slice(0),projection:void 0!==o?o:null,resolution:e,rotation:i,zoom:this.getZoom()}},o.prototype.getZoom=function(){var t,o=this.getResolution();return void 0!==o&&(t=this.getZoomForResolution(o)),t},o.prototype.getZoomForResolution=function(t){var o,e,i=this.minZoom_||0;if(this.resolutions_){var n=pd(this.resolutions_,t,1);i=n,o=this.resolutions_[n],e=n==this.resolutions_.length-1?2:o/this.resolutions_[n+1]}else o=this.maxResolution_,e=this.zoomFactor_;return i+Math.log(o/t)/Math.log(e)},o.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var o=ja(Math.floor(t),0,this.resolutions_.length-2),e=this.resolutions_[o]/this.resolutions_[o+1];return this.resolutions_[o]/Math.pow(e,ja(t-o,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},o.prototype.fit=function(t,o){var e,i=ha({size:this.getViewportSize_()},o||{});if(ea(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t)){ea(!wc(t),25);var n=Ua(t,this.getProjection());e=Lb(n)}else if(t.getType()===aa.CIRCLE){n=Ua(t.getExtent(),this.getProjection());(e=Lb(n)).rotate(this.getRotation(),Ma(n))}else{var r=Ra();e=r?t.clone().transform(r,this.getProjection()):t}this.fitInternal(e,i)},o.prototype.fitInternal=function(t,o){var e=o||{},i=e.size;i||(i=this.getViewportSize_());var n,r=void 0!==e.padding?e.padding:[0,0,0,0],s=void 0!==e.nearest&&e.nearest;n=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;for(var a=t.getFlatCoordinates(),p=this.getRotation(),$=Math.cos(-p),u=Math.sin(-p),h=1/0,l=1/0,c=-1/0,m=-1/0,g=t.getStride(),Z=0,O=a.length;Z<O;Z+=g){var _=a[Z]*$-a[Z+1]*u,R=a[Z]*u+a[Z+1]*$;h=Math.min(h,_),l=Math.min(l,R),c=Math.max(c,_),m=Math.max(m,R)}var v=this.getResolutionForExtentInternal([h,l,c,m],[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);v=isNaN(v)?n:Math.max(v,n),v=this.getConstrainedResolution(v,s?0:1),u=-u;var f=(h+c)/2,d=(l+m)/2,X=[(f+=(r[1]-r[3])/2*v)*$-(d+=(r[0]-r[2])/2*v)*u,d*$+f*u],y=e.callback?e.callback:tb;void 0!==e.duration?this.animateInternal({resolution:v,center:this.getConstrainedCenter(X,v),duration:e.duration,easing:e.easing},y):(this.targetResolution_=v,this.targetCenter_=X,this.applyTargetState_(!1,!0),Nf(y,!0))},o.prototype.centerOn=function(t,o,e){this.centerOnInternal(oa(t,this.getProjection()),o,e)},o.prototype.centerOnInternal=function(t,o,e){var i=this.getRotation(),n=Math.cos(-i),r=Math.sin(-i),s=t[0]*n-t[1]*r,a=t[1]*n+t[0]*r,p=this.getResolution(),$=(s+=(o[0]/2-e[0])*p)*n-(a+=(e[1]-o[1]/2)*p)*(r=-r),u=a*n+s*r;this.setCenterInternal([$,u])},o.prototype.isDef=function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()},o.prototype.adjustCenter=function(t){var o=Fb(this.targetCenter_,this.getProjection());this.setCenter([o[0]+t[0],o[1]+t[1]])},o.prototype.adjustCenterInternal=function(t){var o=this.targetCenter_;this.setCenterInternal([o[0]+t[0],o[1]+t[1]])},o.prototype.adjustResolution=function(t,o){var e=o&&oa(o,this.getProjection());this.adjustResolutionInternal(t,e)},o.prototype.adjustResolutionInternal=function(t,o){var e=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),n=this.constraints_.resolution(this.targetResolution_*t,0,i,e);o&&(this.targetCenter_=this.calculateCenterZoom(n,o)),this.targetResolution_*=t,this.applyTargetState_()},o.prototype.adjustZoom=function(t,o){this.adjustResolution(Math.pow(this.zoomFactor_,-t),o)},o.prototype.adjustRotation=function(t,o){o&&(o=oa(o,this.getProjection())),this.adjustRotationInternal(t,o)},o.prototype.adjustRotationInternal=function(t,o){var e=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+t,e);o&&(this.targetCenter_=this.calculateCenterRotate(i,o)),this.targetRotation_+=t,this.applyTargetState_()},o.prototype.setCenter=function(t){this.setCenterInternal(oa(t,this.getProjection()))},o.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},o.prototype.setHint=function(t,o){return this.hints_[t]+=o,this.changed(),this.hints_[t]},o.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},o.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},o.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},o.prototype.applyTargetState_=function(t,o){var e=this.getAnimating()||this.getInteracting()||o,i=this.constraints_.rotation(this.targetRotation_,e),n=this.getViewportSize_(i),r=this.constraints_.resolution(this.targetResolution_,0,n,e),s=this.constraints_.center(this.targetCenter_,r,n,e);this.get(Ca.ROTATION)!==i&&this.set(Ca.ROTATION,i),this.get(Ca.RESOLUTION)!==r&&this.set(Ca.RESOLUTION,r),this.get(Ca.CENTER)&&Za(this.get(Ca.CENTER),s)||this.set(Ca.CENTER,s),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0},o.prototype.resolveConstraints=function(t,o,e){var i=void 0!==t?t:200,n=o||0,r=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(r),a=this.constraints_.resolution(this.targetResolution_,n,s),p=this.constraints_.center(this.targetCenter_,a,s);if(0===i&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=r,this.targetCenter_=p,void this.applyTargetState_();var $=e||(0===i?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,this.getResolution()===a&&this.getRotation()===r&&this.getCenterInternal()&&Za(this.getCenterInternal(),p)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:p,resolution:a,duration:i,easing:$b,anchor:$}))},o.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(qa.INTERACTING,1)},o.prototype.endInteraction=function(t,o,e){var i=e&&oa(e,this.getProjection());this.endInteractionInternal(t,o,i)},o.prototype.endInteractionInternal=function(t,o,e){this.setHint(qa.INTERACTING,-1),this.resolveConstraints(t,o,e)},o.prototype.getConstrainedCenter=function(t,o){var e=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,o||this.getResolution(),e)},o.prototype.getConstrainedZoom=function(t,o){var e=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(e,o))},o.prototype.getConstrainedResolution=function(t,o){var e=o||0,i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)},o}(Ta);function Nf(t,o){setTimeout(function(){t(o)},0)}function Pm(t){if(void 0!==t.extent){var o=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return Ke(t.extent,t.constrainOnlyCenter,o)}var e=Sc(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){var i=e.getExtent().slice();return i[0]=-1/0,i[2]=1/0,Ke(i,!1,!1)}return pk}function Qm(t){var o,e,i,n=void 0!==t.minZoom?t.minZoom:Ti,r=void 0!==t.maxZoom?t.maxZoom:28,s=void 0!==t.zoomFactor?t.zoomFactor:2,a=void 0!==t.multiWorld&&t.multiWorld,p=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,$=void 0!==t.showFullExtent&&t.showFullExtent,u=Sc(t.projection,"EPSG:3857"),h=u.getExtent(),l=t.constrainOnlyCenter,c=t.extent;if(a||c||!u.isGlobal()||(l=!1,c=h),void 0!==t.resolutions){var m=t.resolutions;e=m[n],i=void 0!==m[r]?m[r]:m[m.length-1],o=t.constrainResolution?qk(m,p,!l&&c,$):Le(e,i,p,!l&&c,$)}else{var g=(h?Math.max(la(h),va(h)):360*ob[Qa.DEGREES]/u.getMetersPerUnit())/Bc/Math.pow(2,Ti),Z=g/Math.pow(2,28-Ti);void 0!==(e=t.maxResolution)?n=0:e=g/Math.pow(s,n),void 0===(i=t.minResolution)&&(i=void 0!==t.maxZoom?void 0!==t.maxResolution?e/Math.pow(s,r):g/Math.pow(s,r):Z),r=n+Math.floor(Math.log(e/i)/Math.log(s)),i=e/Math.pow(s,r-n),o=t.constrainResolution?rk(s,e,i,p,!l&&c,$):Le(e,i,p,!l&&c,$)}return{constraint:o,maxResolution:e,minResolution:i,minZoom:n,zoomFactor:s}}function Rm(t){if(void 0===t.enableRotation||t.enableRotation){var o=t.constrainRotation;return void 0===o||!0===o?tk():!1===o?Ne:"number"==typeof o?sk(o):Ne}return Me}function Sm(t){return!(t.sourceCenter&&t.targetCenter&&!Za(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}Lc.createCenterConstraint=Pm,Lc.createResolutionConstraint=Qm,Lc.createRotationConstraint=Rm,Lc.isNoopAnimation=Sm,Lc.default=Om;var Ui={};var Tm=Ui&&Ui.__extends||function(){var t=function(i,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])})(i,r)};return function(i,r){function e(){this.constructor=i}t(i,r),i.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}(),za={ACCURACY:"accuracy",ACCURACY_GEOMETRY:"accuracyGeometry",ALTITUDE:"altitude",ALTITUDE_ACCURACY:"altitudeAccuracy",HEADING:"heading",POSITION:"position",PROJECTION:"projection",SPEED:"speed",TRACKING:"tracking",TRACKING_OPTIONS:"trackingOptions"},es=function(t){function i(i){var r=t.call(this,ca.ERROR)||this;return r.code=i.code,r.message=i.message,r}return Tm(i,t),i}(Ka),fs=function(t){function i(i){var r=t.call(this)||this,e=i||{};return r.position_=null,r.transform_=ug,r.watchId_=void 0,r.addEventListener(xa(za.PROJECTION),r.handleProjectionChanged_),r.addEventListener(xa(za.TRACKING),r.handleTrackingChanged_),void 0!==e.projection&&r.setProjection(e.projection),void 0!==e.trackingOptions&&r.setTrackingOptions(e.trackingOptions),r.setTracking(void 0!==e.tracking&&e.tracking),r}return Tm(i,t),i.prototype.disposeInternal=function(){this.setTracking(!1),t.prototype.disposeInternal.call(this)},i.prototype.handleProjectionChanged_=function(){var t=this.getProjection();t&&(this.transform_=mb(pa("EPSG:4326"),t),this.position_&&this.set(za.POSITION,this.transform_(this.position_)))},i.prototype.handleTrackingChanged_=function(){if("geolocation"in navigator){var t=this.getTracking();t&&void 0===this.watchId_?this.watchId_=navigator.geolocation.watchPosition(this.positionChange_.bind(this),this.positionError_.bind(this),this.getTrackingOptions()):t||void 0===this.watchId_||(navigator.geolocation.clearWatch(this.watchId_),this.watchId_=void 0)}},i.prototype.positionChange_=function(t){var i=t.coords;this.set(za.ACCURACY,i.accuracy),this.set(za.ALTITUDE,null===i.altitude?void 0:i.altitude),this.set(za.ALTITUDE_ACCURACY,null===i.altitudeAccuracy?void 0:i.altitudeAccuracy),this.set(za.HEADING,null===i.heading?void 0:ub(i.heading)),this.position_?(this.position_[0]=i.longitude,this.position_[1]=i.latitude):this.position_=[i.longitude,i.latitude];var r=this.transform_(this.position_);this.set(za.POSITION,r),this.set(za.SPEED,null===i.speed?void 0:i.speed);var e=Qk(this.position_,i.accuracy);e.applyTransform(this.transform_),this.set(za.ACCURACY_GEOMETRY,e),this.changed()},i.prototype.positionError_=function(t){this.setTracking(!1),this.dispatchEvent(new es(t))},i.prototype.getAccuracy=function(){return this.get(za.ACCURACY)},i.prototype.getAccuracyGeometry=function(){return this.get(za.ACCURACY_GEOMETRY)||null},i.prototype.getAltitude=function(){return this.get(za.ALTITUDE)},i.prototype.getAltitudeAccuracy=function(){return this.get(za.ALTITUDE_ACCURACY)},i.prototype.getHeading=function(){return this.get(za.HEADING)},i.prototype.getPosition=function(){return this.get(za.POSITION)},i.prototype.getProjection=function(){return this.get(za.PROJECTION)},i.prototype.getSpeed=function(){return this.get(za.SPEED)},i.prototype.getTracking=function(){return this.get(za.TRACKING)},i.prototype.getTrackingOptions=function(){return this.get(za.TRACKING_OPTIONS)},i.prototype.setProjection=function(t){this.set(za.PROJECTION,pa(t))},i.prototype.setTracking=function(t){this.set(za.TRACKING,t)},i.prototype.setTrackingOptions=function(t){this.set(za.TRACKING_OPTIONS,t)},i}(Ta);Ui.default=fs;var Vi={};function Um($,r,t){for(var o,a,e,i,c,n,p=[],s=$(0),w=$(1),m=r(s),u=r(w),h=[w,s],l=[u,m],g=[1,0],M={},f=1e5;--f>0&&g.length>0;)e=g.pop(),s=h.pop(),m=l.pop(),(n=e.toString())in M||(p.push(m[0],m[1]),M[n]=!0),i=g.pop(),w=h.pop(),u=l.pop(),a=r(o=$(c=(e+i)/2)),Jj(a[0],a[1],m[0],m[1],u[0],u[1])<t?(p.push(u[0],u[1]),M[n=i.toString()]=!0):(g.push(i,c,c,e),l.push(u,a,a,m),h.push(w,o,o,s));return p}function gs($,r,t,o,a){var e=pa("EPSG:4326");return Um(function(o){return[$,r+(t-r)*o]},Cb(e,o),a)}function hs($,r,t,o,a){var e=pa("EPSG:4326");return Um(function(o){return[r+(t-r)*o,$]},Cb(e,o),a)}var is=Vi&&Vi.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function a(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),js=new Nb({color:"rgba(0,0,0,0.2)"}),ks=[90,45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001],ls=function(t){function e(e){var i=this,a=e||{},r=ha({updateWhileAnimating:!0,updateWhileInteracting:!0,renderBuffer:0},a);return delete r.maxLines,delete r.strokeStyle,delete r.targetSize,delete r.showLabels,delete r.lonLabelFormatter,delete r.latLabelFormatter,delete r.lonLabelPosition,delete r.latLabelPosition,delete r.lonLabelStyle,delete r.latLabelStyle,delete r.intervals,(i=t.call(this,r)||this).projection_=null,i.maxLat_=1/0,i.maxLon_=1/0,i.minLat_=-1/0,i.minLon_=-1/0,i.maxX_=1/0,i.maxY_=1/0,i.minX_=-1/0,i.minY_=-1/0,i.targetSize_=void 0!==a.targetSize?a.targetSize:100,i.maxLines_=void 0!==a.maxLines?a.maxLines:100,i.meridians_=[],i.parallels_=[],i.strokeStyle_=void 0!==a.strokeStyle?a.strokeStyle:js,i.fromLonLatTransform_=void 0,i.toLonLatTransform_=void 0,i.projectionCenterLonLat_=null,i.bottomLeft_=null,i.bottomRight_=null,i.topLeft_=null,i.topRight_=null,i.meridiansLabels_=null,i.parallelsLabels_=null,a.showLabels&&(i.lonLabelFormatter_=null==a.lonLabelFormatter?uk.bind(i,"EW"):a.lonLabelFormatter,i.latLabelFormatter_=null==a.latLabelFormatter?uk.bind(i,"NS"):a.latLabelFormatter,i.lonLabelPosition_=null==a.lonLabelPosition?0:a.lonLabelPosition,i.latLabelPosition_=null==a.latLabelPosition?1:a.latLabelPosition,i.lonLabelStyleBase_=new pb({text:void 0!==a.lonLabelStyle?a.lonLabelStyle.clone():new im({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new bc({color:"rgba(0,0,0,1)"}),stroke:new Nb({color:"rgba(255,255,255,1)",width:3})})}),i.lonLabelStyle_=function(t){var e=t.get("graticule_label");return this.lonLabelStyleBase_.getText().setText(e),this.lonLabelStyleBase_}.bind(i),i.latLabelStyleBase_=new pb({text:void 0!==a.latLabelStyle?a.latLabelStyle.clone():new im({font:"12px Calibri,sans-serif",textAlign:"right",fill:new bc({color:"rgba(0,0,0,1)"}),stroke:new Nb({color:"rgba(255,255,255,1)",width:3})})}),i.latLabelStyle_=function(t){var e=t.get("graticule_label");return this.latLabelStyleBase_.getText().setText(e),this.latLabelStyleBase_}.bind(i),i.meridiansLabels_=[],i.parallelsLabels_=[],i.addEventListener(Wb.POSTRENDER,i.drawLabels_.bind(i))),i.intervals_=void 0!==a.intervals?a.intervals:ks,i.setSource(new gc({loader:i.loaderFunction.bind(i),strategy:i.strategyFunction.bind(i),features:new Ja,overlaps:!1,useSpatialIndex:!1,wrapX:a.wrapX})),i.featurePool_=[],i.lineStyle_=new pb({stroke:i.strokeStyle_}),i.loadedExtent_=null,i.renderedExtent_=null,i.setRenderOrder(null),i}return is(e,t),e.prototype.strategyFunction=function(t,e){var i=t.slice();return this.projection_&&this.getSource().getWrapX()&&Qj(i,this.projection_),this.loadedExtent_&&(co(this.loadedExtent_,i,e)?i=this.loadedExtent_.slice():this.getSource().removeLoadedExtent(this.loadedExtent_)),[i]},e.prototype.loaderFunction=function(t,e,i){this.loadedExtent_=t;var a=this.getSource(),r=this.getExtent()||[-1/0,-1/0,1/0,1/0],s=vb(r,t);if(!(this.renderedExtent_&&eb(this.renderedExtent_,s)||(this.renderedExtent_=s,wc(s)))){var o=Ma(s),n=e*e/4;(!this.projection_||!lb(this.projection_,i))&&this.updateProjectionInfo_(i),this.createGraticule_(s,o,e,n);var l,$=this.meridians_.length+this.parallels_.length;for(this.meridiansLabels_&&($+=this.meridians_.length),this.parallelsLabels_&&($+=this.parallels_.length);$>this.featurePool_.length;)l=new Wa,this.featurePool_.push(l);var h=a.getFeaturesCollection();h.clear();var m,_,p=0;for(m=0,_=this.meridians_.length;m<_;++m)(l=this.featurePool_[p++]).setGeometry(this.meridians_[m]),l.setStyle(this.lineStyle_),h.push(l);for(m=0,_=this.parallels_.length;m<_;++m)(l=this.featurePool_[p++]).setGeometry(this.parallels_[m]),l.setStyle(this.lineStyle_),h.push(l)}},e.prototype.addMeridian_=function(t,e,i,a,r,s){var o=this.getMeridian_(t,e,i,a,s);if(ya(o.getExtent(),r)){if(this.meridiansLabels_){var n=this.lonLabelFormatter_(t);s in this.meridiansLabels_?this.meridiansLabels_[s].text=n:this.meridiansLabels_[s]={geom:new gb([]),text:n}}this.meridians_[s++]=o}return s},e.prototype.addParallel_=function(t,e,i,a,r,s){var o=this.getParallel_(t,e,i,a,s);if(ya(o.getExtent(),r)){if(this.parallelsLabels_){var n=this.latLabelFormatter_(t);s in this.parallelsLabels_?this.parallelsLabels_[s].text=n:this.parallelsLabels_[s]={geom:new gb([]),text:n}}this.parallels_[s++]=o}return s},e.prototype.drawLabels_=function(t){var e=t.frameState.viewState.rotation,i=t.frameState.extent,a=Ma(i),r=i;if(e){var s=la(i),o=va(i),n=Math.abs(Math.cos(e)),l=Math.abs(Math.sin(e)),$=(l*o-n*s)/(l*l-n*n),h=(l*s-n*o)/(l*l-n*n);r=[a[0]-$/2,a[1]-h/2,a[0]+$/2,a[1]+h/2]}var m=0,_=0,p=this.latLabelPosition_<.5,L=this.projection_.getExtent(),d=la(L);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!La(L,i)&&(m=Math.floor((i[0]-L[0])/d),_=Math.ceil((i[2]-L[2])/d),p=p!==Math.abs(e)>Math.PI/2);for(var c=Np(t),w=m;w<=_;++w){var u=this.meridians_.length+this.parallels_.length,X=void 0,g=void 0,f=void 0,b=void 0;if(this.meridiansLabels_)for(g=0,f=this.meridiansLabels_.length;g<f;++g){var x=this.meridians_[g];if(e||0!==w)(v=x.clone()).translate(w*d,0),v.rotate(-e,a),(b=this.getMeridianPoint_(v,r,g)).rotate(e,a);else b=this.getMeridianPoint_(x,i,g);(X=this.featurePool_[u++]).setGeometry(b),X.set("graticule_label",this.meridiansLabels_[g].text),c.drawFeature(X,this.lonLabelStyle_(X))}if(this.parallelsLabels_&&(w===m&&p||w===_&&!p))for(g=0,f=this.parallels_.length;g<f;++g){var v;x=this.parallels_[g];if(e||0!==w)(v=x.clone()).translate(w*d,0),v.rotate(-e,a),(b=this.getParallelPoint_(v,r,g)).rotate(e,a);else b=this.getParallelPoint_(x,i,g);(X=this.featurePool_[u++]).setGeometry(b),X.set("graticule_label",this.parallelsLabels_[g].text),c.drawFeature(X,this.latLabelStyle_(X))}}},e.prototype.createGraticule_=function(t,e,i,a){var r=this.getInterval_(i);if(-1==r)return this.meridians_.length=0,this.parallels_.length=0,this.meridiansLabels_&&(this.meridiansLabels_.length=0),void(this.parallelsLabels_&&(this.parallelsLabels_.length=0));var s=!1,o=this.projection_.getExtent(),n=la(o);this.getSource().getWrapX()&&this.projection_.canWrapX()&&!La(o,t)&&(la(t)>=n?(t[0]=o[0],t[2]=o[2]):s=!0);var l=[ja(e[0],this.minX_,this.maxX_),ja(e[1],this.minY_,this.maxY_)],$=this.toLonLatTransform_(l);isNaN($[1])&&($[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_);var h,m,_,p,L=ja($[0],this.minLon_,this.maxLon_),d=ja($[1],this.minLat_,this.maxLat_),c=this.maxLines_,w=t;s||(w=[ja(t[0],this.minX_,this.maxX_),ja(t[1],this.minY_,this.maxY_),ja(t[2],this.minX_,this.maxX_),ja(t[3],this.minY_,this.maxY_)]);var u=Xc(w,this.toLonLatTransform_,void 0,8),X=u[3],g=u[2],f=u[1],b=u[0];if(s||(tc(w,this.bottomLeft_)&&(b=this.minLon_,f=this.minLat_),tc(w,this.bottomRight_)&&(g=this.maxLon_,f=this.minLat_),tc(w,this.topLeft_)&&(b=this.minLon_,X=this.maxLat_),tc(w,this.topRight_)&&(g=this.maxLon_,X=this.maxLat_),X=ja(X,d,this.maxLat_),g=ja(g,L,this.maxLon_),f=ja(f,this.minLat_,d),b=ja(b,this.minLon_,L)),L=Math.floor(L/r)*r,p=ja(L,this.minLon_,this.maxLon_),m=this.addMeridian_(p,f,X,a,t,0),h=0,s)for(;(p-=r)>=b&&h++<c;)m=this.addMeridian_(p,f,X,a,t,m);else for(;p!=this.minLon_&&h++<c;)p=Math.max(p-r,this.minLon_),m=this.addMeridian_(p,f,X,a,t,m);if(p=ja(L,this.minLon_,this.maxLon_),h=0,s)for(;(p+=r)<=g&&h++<c;)m=this.addMeridian_(p,f,X,a,t,m);else for(;p!=this.maxLon_&&h++<c;)p=Math.min(p+r,this.maxLon_),m=this.addMeridian_(p,f,X,a,t,m);for(this.meridians_.length=m,this.meridiansLabels_&&(this.meridiansLabels_.length=m),d=Math.floor(d/r)*r,_=ja(d,this.minLat_,this.maxLat_),m=this.addParallel_(_,b,g,a,t,0),h=0;_!=this.minLat_&&h++<c;)_=Math.max(_-r,this.minLat_),m=this.addParallel_(_,b,g,a,t,m);for(_=ja(d,this.minLat_,this.maxLat_),h=0;_!=this.maxLat_&&h++<c;)_=Math.min(_+r,this.maxLat_),m=this.addParallel_(_,b,g,a,t,m);this.parallels_.length=m,this.parallelsLabels_&&(this.parallelsLabels_.length=m)},e.prototype.getInterval_=function(t){for(var e=this.projectionCenterLonLat_[0],i=this.projectionCenterLonLat_[1],a=-1,r=Math.pow(this.targetSize_*t,2),s=[],o=[],n=0,l=this.intervals_.length;n<l;++n){var $=ja(this.intervals_[n]/2,0,90),h=ja(i,-90+$,90-$);if(s[0]=e-$,s[1]=h-$,o[0]=e+$,o[1]=h+$,this.fromLonLatTransform_(s,s),this.fromLonLatTransform_(o,o),Math.pow(o[0]-s[0],2)+Math.pow(o[1]-s[1],2)<=r)break;a=this.intervals_[n]}return a},e.prototype.getMeridian_=function(t,e,i,a,r){var s=gs(t,e,i,this.projection_,a),o=this.meridians_[r];return o?(o.setFlatCoordinates(wa.XY,s),o.changed()):(o=new Mb(s,wa.XY),this.meridians_[r]=o),o},e.prototype.getMeridianPoint_=function(t,e,i){var a=t.getFlatCoordinates(),r=1,s=a.length-1;a[r]>a[s]&&(r=s,s=1);var o=Math.max(e[1],a[r]),n=Math.min(e[3],a[s]),l=ja(e[1]+Math.abs(e[1]-e[3])*this.lonLabelPosition_,o,n),$=[a[r-1]+(a[s-1]-a[r-1])*(l-a[r])/(a[s]-a[r]),l],h=this.meridiansLabels_[i].geom;return h.setCoordinates($),h},e.prototype.getMeridians=function(){return this.meridians_},e.prototype.getParallel_=function(t,e,i,a,r){var s=hs(t,e,i,this.projection_,a),o=this.parallels_[r];return o?(o.setFlatCoordinates(wa.XY,s),o.changed()):o=new Mb(s,wa.XY),o},e.prototype.getParallelPoint_=function(t,e,i){var a=t.getFlatCoordinates(),r=0,s=a.length-2;a[r]>a[s]&&(r=s,s=0);var o=Math.max(e[0],a[r]),n=Math.min(e[2],a[s]),l=ja(e[0]+Math.abs(e[0]-e[2])*this.latLabelPosition_,o,n),$=[l,a[r+1]+(a[s+1]-a[r+1])*(l-a[r])/(a[s]-a[r])],h=this.parallelsLabels_[i].geom;return h.setCoordinates($),h},e.prototype.getParallels=function(){return this.parallels_},e.prototype.updateProjectionInfo_=function(t){var e=pa("EPSG:4326"),i=t.getWorldExtent();this.maxLat_=i[3],this.maxLon_=i[2],this.minLat_=i[1],this.minLon_=i[0];var a=Cb(t,e);if(this.minLon_<this.maxLon_)this.toLonLatTransform_=a;else{var r=this.minLon_+this.maxLon_/2;this.maxLon_+=360,this.toLonLatTransform_=function(t,e,i){for(var s=i||2,o=a(t,e,s),n=0,l=o.length;n<l;n+=s)o[n]<r&&(o[n]+=360);return o}}this.fromLonLatTransform_=Cb(e,t);var s=Xc([this.minLon_,this.minLat_,this.maxLon_,this.maxLat_],this.fromLonLatTransform_,void 0,8);this.minX_=s[0],this.maxX_=s[2],this.minY_=s[1],this.maxY_=s[3],this.bottomLeft_=this.fromLonLatTransform_([this.minLon_,this.minLat_]),this.bottomRight_=this.fromLonLatTransform_([this.maxLon_,this.minLat_]),this.topLeft_=this.fromLonLatTransform_([this.minLon_,this.maxLat_]),this.topRight_=this.fromLonLatTransform_([this.maxLon_,this.maxLat_]),this.projectionCenterLonLat_=this.toLonLatTransform_(Ma(t.getExtent())),isNaN(this.projectionCenterLonLat_[1])&&(this.projectionCenterLonLat_[1]=Math.abs(this.maxLat_)>=Math.abs(this.minLat_)?this.maxLat_:this.minLat_),this.projection_=t},e}(fc);Vi.default=ls;var Wi={};var ms=Wi&&Wi.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Of=function(t){function e(e,r,o,a,n){var $=this,i=void 0!==n?ia.IDLE:ia.LOADED;return($=t.call(this,e,r,o,i)||this).loader_=void 0!==n?n:null,$.canvas_=a,$.error_=null,$}return ms(e,t),e.prototype.getError=function(){return this.error_},e.prototype.handleLoad_=function(t){t?(this.error_=t,this.state=ia.ERROR):this.state=ia.LOADED,this.changed()},e.prototype.load=function(){this.state==ia.IDLE&&(this.state=ia.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))},e.prototype.getImage=function(){return this.canvas_},e}(xf);Wi.default=Of;var Xi={};var ns=Xi&&Xi.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var e in t)t.hasOwnProperty(e)&&(r[e]=t[e])})(t,e)};return function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),os=function(r){function t(t){return(t=ha({},t)).controls||(t.controls=Xk()),t.interactions||(t.interactions=wl()),r.call(this,t)||this}return ns(t,r),t.prototype.createRenderer=function(){return new ef(this)},t}(Ye);Xi.default=os;var Yi={};var ps=Yi&&Yi.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Vm=[],Wm=function(e){function t(t,r,o,n){var i=e.call(this,t,r,{transition:0})||this;return i.context_={},i.executorGroups={},i.loadingSourceTiles=0,i.errorSourceTileKeys={},i.hitDetectionImageData={},i.replayState_={},i.sourceTiles=null,i.wantedResolution,i.getSourceTiles=n.bind(void 0,i),i.sourceZ=-1,i.hifi=!1,i.wrappedTileCoord=o,i}return ps(t,e),t.prototype.getContext=function(e){var t=da(e);return t in this.context_||(this.context_[t]=Ea(1,1,Vm)),this.context_[t]},t.prototype.hasContext=function(e){return da(e)in this.context_},t.prototype.getImage=function(e){return this.hasContext(e)?this.getContext(e).canvas:null},t.prototype.getReplayState=function(e){var t=da(e);return t in this.replayState_||(this.replayState_[t]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedZ:-1,renderedTileZ:-1}),this.replayState_[t]},t.prototype.load=function(){this.getSourceTiles()},t.prototype.release=function(){for(var t in this.context_)Vm.push(this.context_[t].canvas);e.prototype.release.call(this)},t}(Jc);Yi.default=Wm;var Zi={};var qs=Zi&&Zi.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),Xm=function(t){function e(e,o,r,n,i,s){var u=t.call(this,e,o,s)||this;return u.extent=null,u.format_=n,u.features_=null,u.loader_,u.projection=null,u.resolution,u.tileLoadFunction_=i,u.url_=r,u}return qs(e,t),e.prototype.getFormat=function(){return this.format_},e.prototype.getFeatures=function(){return this.features_},e.prototype.getKey=function(){return this.url_},e.prototype.load=function(){this.state==ba.IDLE&&(this.setState(ba.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))},e.prototype.onLoad=function(t,e){this.setFeatures(t)},e.prototype.onError=function(){this.setState(ba.ERROR)},e.prototype.setFeatures=function(t){this.features_=t,this.setState(ba.LOADED)},e.prototype.setLoader=function(t){this.loader_=t},e}(Jc);Zi.default=Xm;var ab={};var $i={};var rs=$i&&$i.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Ym=function(e){function t(t){var r=e.call(this)||this;return r.geometries_=t||null,r.changeEventsKeys_=[],r.listenGeometriesChange_(),r}return rs(t,e),t.prototype.unlistenGeometriesChange_=function(){this.changeEventsKeys_.forEach(ra),this.changeEventsKeys_.length=0},t.prototype.listenGeometriesChange_=function(){if(this.geometries_)for(var e=0,t=this.geometries_.length;e<t;++e)this.changeEventsKeys_.push(fa(this.geometries_[e],ca.CHANGE,this.changed,this))},t.prototype.clone=function(){var e=new t(null);return e.setGeometries(this.geometries_),e},t.prototype.closestPointXY=function(e,t,r,i){if(i<sc(this.getExtent(),e,t))return i;for(var o=this.geometries_,n=0,s=o.length;n<s;++n)i=o[n].closestPointXY(e,t,r,i);return i},t.prototype.containsXY=function(e,t){for(var r=this.geometries_,i=0,o=r.length;i<o;++i)if(r[i].containsXY(e,t))return!0;return!1},t.prototype.computeExtent=function(e){Uc(e);for(var t=this.geometries_,r=0,i=t.length;r<i;++r)Bg(e,t[r].getExtent());return e},t.prototype.getGeometries=function(){return Zm(this.geometries_)},t.prototype.getGeometriesArray=function(){return this.geometries_},t.prototype.getGeometriesArrayRecursive=function(){for(var e=[],t=this.geometries_,r=0,i=t.length;r<i;++r)t[r].getType()===this.getType()?e=e.concat(t[r].getGeometriesArrayRecursive()):e.push(t[r]);return e},t.prototype.getSimplifiedGeometry=function(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var r=[],i=this.geometries_,o=!1,n=0,s=i.length;n<s;++n){var p=i[n],a=p.getSimplifiedGeometry(e);r.push(a),a!==p&&(o=!0)}if(o){var h=new t(null);return h.setGeometriesArray(r),h}return this.simplifiedGeometryMaxMinSquaredTolerance=e,this},t.prototype.getType=function(){return aa.GEOMETRY_COLLECTION},t.prototype.intersectsExtent=function(e){for(var t=this.geometries_,r=0,i=t.length;r<i;++r)if(t[r].intersectsExtent(e))return!0;return!1},t.prototype.isEmpty=function(){return 0===this.geometries_.length},t.prototype.rotate=function(e,t){for(var r=this.geometries_,i=0,o=r.length;i<o;++i)r[i].rotate(e,t);this.changed()},t.prototype.scale=function(e,t,r){var i=r;i||(i=Ma(this.getExtent()));for(var o=this.geometries_,n=0,s=o.length;n<s;++n)o[n].scale(e,t,i);this.changed()},t.prototype.setGeometries=function(e){this.setGeometriesArray(Zm(e))},t.prototype.setGeometriesArray=function(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()},t.prototype.applyTransform=function(e){for(var t=this.geometries_,r=0,i=t.length;r<i;++r)t[r].applyTransform(e);this.changed()},t.prototype.translate=function(e,t){for(var r=this.geometries_,i=0,o=r.length;i<o;++i)r[i].translate(e,t);this.changed()},t.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),e.prototype.disposeInternal.call(this)},t}(Se);function Zm(e){for(var t=[],r=0,i=e.length;r<i;++r)t.push(e[r].clone());return t}$i.default=Ym;ab.Circle=Od,ab.Geometry=Se,ab.GeometryCollection=Ym,ab.LineString=Mb,ab.MultiLineString=bi,ab.MultiPoint=rf,ab.MultiPolygon=ei,ab.Point=gb,ab.Polygon=xb,ab.LinearRing=Ve;var Pf={};function Qf(e,t,n,o){var r=document.createElement("script"),i="olc_"+da(t);function c(){delete window[i],r.parentNode.removeChild(r)}r.async=!0,r.src=e+(-1==e.indexOf("?")?"?":"&")+(o||"callback")+"="+i;var $=setTimeout(function(){c(),n&&n()},1e4);window[i]=function(e){clearTimeout($),c(),t(e)},document.getElementsByTagName("head")[0].appendChild(r)}var ss=Pf&&Pf.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();function $m(e){var t,r,i=e[0],o=new Array(i),a=1<<i-1;for(t=0;t<i;++t)r=48,e[1]&a&&(r+=1),e[2]&a&&(r+=2),o[t]=String.fromCharCode(r),a>>=1;return o.join("")}Pf.quadKey=$m;var ts="<a class=\"ol-attribution-bing-tos\" href=\"https://www.microsoft.com/maps/product/terms.html\" target=\"_blank\">Terms of Use</a>",us=function(e){function t(t){var r=this,i=void 0!==t.hidpi&&t.hidpi;(r=e.call(this,{cacheSize:t.cacheSize,crossOrigin:"anonymous",opaque:!0,projection:pa("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:Aa.LOADING,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:i?2:1,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition})||this).hidpi_=i,r.culture_=void 0!==t.culture?t.culture:"en-us",r.maxZoom_=void 0!==t.maxZoom?t.maxZoom:-1,r.apiKey_=t.key,r.imagerySet_=t.imagerySet;var o="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+r.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+r.apiKey_+"&c="+r.culture_;return Qf(o,r.handleImageryMetadataResponse.bind(r),void 0,"jsonp"),r}return ss(t,e),t.prototype.getApiKey=function(){return this.apiKey_},t.prototype.getImagerySet=function(){return this.imagerySet_},t.prototype.handleImageryMetadataResponse=function(e){if(200==e.statusCode&&"OK"==e.statusDescription&&"ValidCredentials"==e.authenticationResultCode&&1==e.resourceSets.length&&1==e.resourceSets[0].resources.length){var t=e.resourceSets[0].resources[0],r=-1==this.maxZoom_?t.zoomMax:this.maxZoom_,i=this.getProjection(),o=Kc(i),a=this.hidpi_?2:1,n=t.imageWidth==t.imageHeight?t.imageWidth/a:[t.imageWidth/a,t.imageHeight/a],s=Wd({extent:o,minZoom:t.zoomMin,maxZoom:r,tileSize:n});this.tileGrid=s;var $=this.culture_,u=this.hidpi_;if(this.tileUrlFunction=Vd(t.imageUrlSubdomains.map(function(e){var r=[0,0,0],i=t.imageUrl.replace("{subdomain}",e).replace("{culture}",$);return function(e,t,o){if(e){Ji(e[0],e[1],e[2],r);var a=i;return u&&(a+="&dpi=d1&device=mobile"),a.replace("{quadkey}",$m(r))}}})),t.imageryProviders){var c=mb(pa("EPSG:4326"),this.getProjection());this.setAttributions(function(e){var r=[],i=e.viewState,o=this.getTileGrid(),a=o.getZForResolution(i.resolution,this.zDirection),n=o.getTileCoordForCoordAndZ(i.center,a)[0];return t.imageryProviders.map(function(t){for(var i=!1,o=t.coverageAreas,a=0,s=o.length;a<s;++a){var $=o[a];if(n>=$.zoomMin&&n<=$.zoomMax){var u=$.bbox,p=[u[1],u[0],u[3],u[2]],m=Xc(p,c);if(ya(m,e.extent)){i=!0;break}}}i&&r.push(t.attribution)}),r.push(ts),r}.bind(this))}this.setState(Aa.READY)}else this.setState(Aa.ERROR)},t}(Qb);Pf.default=us;var _i={};var vs=_i&&_i.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ws=function(t){function e(e){var r=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,maxZoom:void 0!==e.maxZoom?e.maxZoom:18,minZoom:e.minZoom,projection:e.projection,wrapX:e.wrapX})||this;return r.account_=e.account,r.mapId_=e.map||"",r.config_=e.config||{},r.templateCache_={},r.initializeMap_(),r}return vs(e,t),e.prototype.getConfig=function(){return this.config_},e.prototype.updateConfig=function(t){ha(this.config_,t),this.initializeMap_()},e.prototype.setConfig=function(t){this.config_=t||{},this.initializeMap_()},e.prototype.initializeMap_=function(){var t=JSON.stringify(this.config_);if(this.templateCache_[t])this.applyTemplate_(this.templateCache_[t]);else{var e="https://"+this.account_+".carto.com/api/v1/map";this.mapId_&&(e+="/named/"+this.mapId_);var r=new XMLHttpRequest;r.addEventListener("load",this.handleInitResponse_.bind(this,t)),r.addEventListener("error",this.handleInitError_.bind(this)),r.open("POST",e),r.setRequestHeader("Content-type","application/json"),r.send(JSON.stringify(this.config_))}},e.prototype.handleInitResponse_=function(t,e){var r=e.target;if(!r.status||r.status>=200&&r.status<300){var i=void 0;try{i=JSON.parse(r.responseText)}catch(o){return void this.setState(Aa.ERROR)}this.applyTemplate_(i),this.templateCache_[t]=i,this.setState(Aa.READY)}else this.setState(Aa.ERROR)},e.prototype.handleInitError_=function(t){this.setState(Aa.ERROR)},e.prototype.applyTemplate_=function(t){var e="https://"+t.cdn_url.https+"/"+this.account_+"/api/v1/map/"+t.layergroupid+"/{z}/{x}/{y}.png";this.setUrl(e)},e}(rb);_i.default=ws;var aj={};var xs=aj&&aj.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function s(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(s.prototype=r.prototype,new s)}}(),ys=function(e){function t(t){var r=e.call(this,{attributions:t.attributions,wrapX:t.wrapX})||this;return r.resolution=void 0,r.distance=void 0!==t.distance?t.distance:20,r.features=[],r.geometryFunction=t.geometryFunction||function(e){var t=e.getGeometry();return ea(t.getType()==aa.POINT,10),t},r.boundRefresh_=r.refresh.bind(r),r.setSource(t.source||null),r}return xs(t,e),t.prototype.clear=function(t){this.features.length=0,e.prototype.clear.call(this,t)},t.prototype.getDistance=function(){return this.distance},t.prototype.getSource=function(){return this.source},t.prototype.loadFeatures=function(e,t,r){this.source.loadFeatures(e,t,r),t!==this.resolution&&(this.clear(),this.resolution=t,this.cluster(),this.addFeatures(this.features))},t.prototype.setDistance=function(e){this.distance=e,this.refresh()},t.prototype.setSource=function(e){this.source&&this.source.removeEventListener(ca.CHANGE,this.boundRefresh_),this.source=e,e&&e.addEventListener(ca.CHANGE,this.boundRefresh_),this.refresh()},t.prototype.refresh=function(){this.clear(),this.cluster(),this.addFeatures(this.features)},t.prototype.cluster=function(){if(void 0!==this.resolution&&this.source)for(var e=Ha(),t=this.distance*this.resolution,r=this.source.getFeatures(),s={},o=0,i=r.length;o<i;o++){var n=r[o];if(!(da(n)in s)){var u=this.geometryFunction(n);if(u){var a=u.getCoordinates();sd(a,e),db(e,t,e);var $=this.source.getFeaturesInExtent(e);$=$.filter(function(e){var t=da(e);return!(t in s)&&(s[t]=!0,!0)}),this.features.push(this.createCluster($))}}}},t.prototype.createCluster=function(e){for(var t=[0,0],r=e.length-1;r>=0;--r){var s=this.geometryFunction(e[r]);s?ah(t,s.getCoordinates()):e.splice(r,1)}vk(t,1/e.length);var o=new Wa(new gb(t));return o.set("features",e),o},t}(gc);aj.default=ys;var bj={};var Rf={};var _m=Rf&&Rf.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function i(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),cj={DEFAULT:"default",TRUNCATED:"truncated"},dj=function(e){function r(r,t,i,a,o,n,$){var l=e.call(this,t,i,a,o,n,$)||this;return l.zoomifyImage_=null,l.tileSize_=r,l}return _m(r,e),r.prototype.getImage=function(){if(this.zoomifyImage_)return this.zoomifyImage_;var r=e.prototype.getImage.call(this);if(this.state==ba.LOADED){var t=this.tileSize_;if(r.width==t[0]&&r.height==t[1])return this.zoomifyImage_=r,r;var i=Ea(t[0],t[1]);return i.drawImage(r,0,0),this.zoomifyImage_=i.canvas,i.canvas}return r},r}(Hi);Rf.CustomTile=dj;var zs=function(e){function r(r){var t=this,i=r,a=i.size,o=void 0!==i.tierSizeCalculation?i.tierSizeCalculation:cj.DEFAULT,n=i.tilePixelRatio||1,$=a[0],l=a[1],s=[],u=i.tileSize||Bc,h=u*n;switch(o){case cj.DEFAULT:for(;$>h||l>h;)s.push([Math.ceil($/h),Math.ceil(l/h)]),h+=h;break;case cj.TRUNCATED:for(var c=$,p=l;c>h||p>h;)s.push([Math.ceil(c/h),Math.ceil(p/h)]),c>>=1,p>>=1;break;default:ea(!1,53);}s.push([1,1]),s.reverse();for(var D=[n],f=[0],m=1,d=s.length;m<d;m++)D.push(n<<m),f.push(s[m-1][0]*s[m-1][1]+f[m-1]);D.reverse();var T=new Xd({tileSize:u,extent:i.extent||[0,-l,$,0],resolutions:D}),v=i.url;v&&-1==v.indexOf("{TileGroup}")&&-1==v.indexOf("{tileIndex}")&&(v+="{TileGroup}/{z}-{x}-{y}.jpg");var g=Qi(v),x=u*n;var _=Vd(g.map(function(e){return function(r,t,i){if(r){var a=r[0],o=r[1],n=r[2],$=o+n*s[a][0],l={z:a,x:o,y:n,tileIndex:$,TileGroup:"TileGroup"+(($+f[a])/x|0)};return e.replace(/\{(\w+?)\}/g,function(e,r){return l[r]})}}})),z=dj.bind(null,Oa(u*n));(t=e.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,projection:i.projection,tilePixelRatio:n,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileClass:z,tileGrid:T,tileUrlFunction:_,transition:i.transition})||this).zDirection=i.zDirection;var C=_(T.getTileCoordForCoordAndResolution(Ma(T.getExtent()),D[D.length-1]),1,null),j=new Image;return j.addEventListener("error",function(){x=u,this.changed()}.bind(t)),j.src=C,t}return _m(r,e),r}(Qb);Rf.default=zs;var Ga={VERSION1:"version1",VERSION2:"version2",VERSION3:"version3"},Mc={};Mc[Ga.VERSION1]={level0:{supports:[],formats:[],qualities:["native"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["native"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["native","color","grey","bitonal"]}},Mc[Ga.VERSION2]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByDistortedWh","sizeByWh"],formats:["jpg","png"],qualities:["default","bitonal"]}},Mc[Ga.VERSION3]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","regionSquare","sizeByW","sizeByH","sizeByWh"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionSquare","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["default"]}},Mc.none={none:{supports:[],formats:[],qualities:[]}};var As=new RegExp("^https?://library.stanford.edu/iiif/image-api/(1.1/)?compliance.html#level[0-2]$"),an=new RegExp("^https?://iiif.io/api/image/2/level[0-2](.json)?$"),Bs=new RegExp("(^https?://iiif.io/api/image/3/level[0-2](.json)?$)|(^level[0-2]$)");function Cs(e){var i=e.getComplianceLevelSupportedFeatures();return void 0===i&&(i=Mc[Ga.VERSION1].level0),{url:void 0===e.imageInfo["@id"]?void 0:e.imageInfo["@id"].replace(/\/?(info.json)?$/g,""),supports:i.supports,formats:i.formats.concat([void 0===e.imageInfo.formats?[]:e.imageInfo.formats]),qualities:i.qualities.concat([void 0===e.imageInfo.qualities?[]:e.imageInfo.qualities]),resolutions:e.imageInfo.scale_factors,tileSize:void 0!==e.imageInfo.tile_width?void 0!==e.imageInfo.tile_height?[e.imageInfo.tile_width,e.imageInfo.tile_height]:[e.imageInfo.tile_width,e.imageInfo.tile_width]:null!=e.imageInfo.tile_height?[e.imageInfo.tile_height,e.imageInfo.tile_height]:void 0}}function Ds(e){var i=e.getComplianceLevelSupportedFeatures(),o=Array.isArray(e.imageInfo.profile)&&e.imageInfo.profile.length>1,t=o&&e.imageInfo.profile[1].supports?e.imageInfo.profile[1].supports:[],r=o&&e.imageInfo.profile[1].formats?e.imageInfo.profile[1].formats:[],s=o&&e.imageInfo.profile[1].qualities?e.imageInfo.profile[1].qualities:[];return{url:e.imageInfo["@id"].replace(/\/?(info.json)?$/g,""),sizes:void 0===e.imageInfo.sizes?void 0:e.imageInfo.sizes.map(function(e){return[e.width,e.height]}),tileSize:void 0===e.imageInfo.tiles?void 0:[e.imageInfo.tiles.map(function(e){return e.width})[0],e.imageInfo.tiles.map(function(e){return void 0===e.height?e.width:e.height})[0]],resolutions:void 0===e.imageInfo.tiles?void 0:e.imageInfo.tiles.map(function(e){return e.scaleFactors})[0],supports:i.supports.concat(t),formats:i.formats.concat(r),qualities:i.qualities.concat(s)}}function Es(e){var i=e.getComplianceLevelSupportedFeatures(),o=void 0===e.imageInfo.extraFormats?i.formats:i.formats.concat(e.imageInfo.extraFormats),t=void 0!==e.imageInfo.preferredFormats&&Array.isArray(e.imageInfo.preferredFormats)&&e.imageInfo.preferredFormats.length>0?e.imageInfo.preferredFormats.filter(function(e){return["jpg","png","gif"].includes(e)}).reduce(function(e,i){return void 0===e&&o.includes(i)?i:e},void 0):void 0;return{url:e.imageInfo.id,sizes:void 0===e.imageInfo.sizes?void 0:e.imageInfo.sizes.map(function(e){return[e.width,e.height]}),tileSize:void 0===e.imageInfo.tiles?void 0:[e.imageInfo.tiles.map(function(e){return e.width})[0],e.imageInfo.tiles.map(function(e){return e.height})[0]],resolutions:void 0===e.imageInfo.tiles?void 0:e.imageInfo.tiles.map(function(e){return e.scaleFactors})[0],supports:void 0===e.imageInfo.extraFeatures?i.supports:i.supports.concat(e.imageInfo.extraFeatures),formats:o,qualities:void 0===e.imageInfo.extraQualities?i.qualities:i.qualities.concat(e.imageInfo.extraQualities),preferredFormat:t}}var Sf={};Sf[Ga.VERSION1]=Cs,Sf[Ga.VERSION2]=Ds,Sf[Ga.VERSION3]=Es;var d=function(){function e(e){this.setImageInfo(e)}return e.prototype.setImageInfo=function(e){this.imageInfo="string"==typeof e?JSON.parse(e):e},e.prototype.getImageApiVersion=function(){if(void 0!==this.imageInfo){var e=this.imageInfo["@context"]||"ol-no-context";"string"==typeof e&&(e=[e]);for(var i=0;i<e.length;i++)switch(e[i]){case"http://library.stanford.edu/iiif/image-api/1.1/context.json":case"http://iiif.io/api/image/1/context.json":return Ga.VERSION1;case"http://iiif.io/api/image/2/context.json":return Ga.VERSION2;case"http://iiif.io/api/image/3/context.json":return Ga.VERSION3;case"ol-no-context":if(this.getComplianceLevelEntryFromProfile(Ga.VERSION1)&&this.imageInfo.identifier)return Ga.VERSION1;}ea(!1,61)}},e.prototype.getComplianceLevelEntryFromProfile=function(e){if(void 0!==this.imageInfo&&void 0!==this.imageInfo.profile)switch(void 0===e&&(e=this.getImageApiVersion()),e){case Ga.VERSION1:if(As.test(this.imageInfo.profile))return this.imageInfo.profile;break;case Ga.VERSION3:if(Bs.test(this.imageInfo.profile))return this.imageInfo.profile;break;case Ga.VERSION2:if("string"==typeof this.imageInfo.profile&&an.test(this.imageInfo.profile))return this.imageInfo.profile;if(Array.isArray(this.imageInfo.profile)&&this.imageInfo.profile.length>0&&"string"==typeof this.imageInfo.profile[0]&&an.test(this.imageInfo.profile[0]))return this.imageInfo.profile[0];}},e.prototype.getComplianceLevelFromProfile=function(e){var i=this.getComplianceLevelEntryFromProfile(e);if(void 0!==i){var o=i.match(/level[0-2](\.json)?$/g);return Array.isArray(o)?o[0].replace(".json",""):void 0}},e.prototype.getComplianceLevelSupportedFeatures=function(){if(void 0!==this.imageInfo){var e=this.getImageApiVersion(),i=this.getComplianceLevelFromProfile(e);return void 0===i?Mc.none.none:Mc[e][i]}},e.prototype.getTileSourceOptions=function(e){var i=e||{},o=this.getImageApiVersion();if(void 0!==o){var t=void 0===o?void 0:Sf[o](this);if(void 0!==t)return{url:t.url,version:o,size:[this.imageInfo.width,this.imageInfo.height],sizes:t.sizes,format:void 0!==i.format&&t.formats.includes(i.format)?i.format:void 0!==t.preferredFormat?t.preferredFormat:"jpg",supports:t.supports,quality:i.quality&&t.qualities.includes(i.quality)?i.quality:t.qualities.includes("native")?"native":"default",resolutions:Array.isArray(t.resolutions)?t.resolutions.sort(function(e,i){return i-e}):void 0,tileSize:t.tileSize}}},e}();var Fs=bj&&bj.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function i(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();function Yd(e){return e.toLocaleString("en",{maximumFractionDigits:10})}var Gs=function(e){function r(r){var t=this,i=r||{},o=i.url||"";o+=o.lastIndexOf("/")===o.length-1||""===o?"":"/";var n=i.version||Ga.VERSION2,s=i.sizes||[],a=i.size;ea(null!=a&&Array.isArray(a)&&2==a.length&&!isNaN(a[0])&&a[0]>0&&!isNaN(a[1])&&a[1]>0,60);var l,$,u,c=a[0],p=a[1],f=i.tileSize,h=i.tilePixelRatio||1,g=i.format||"jpg",m=i.quality||(i.version==Ga.VERSION1?"native":"default"),F=i.resolutions||[],d=i.supports||[],v=i.extent||[0,-p,c,0],y=null!=s&&Array.isArray(s)&&s.length>0,x=void 0!==f&&("number"==typeof f&&Number.isInteger(f)&&f>0||Array.isArray(f)&&f.length>0),I=null!=d&&Array.isArray(d)&&(d.includes("regionByPx")||d.includes("regionByPct"))&&(d.includes("sizeByWh")||d.includes("sizeByH")||d.includes("sizeByW")||d.includes("sizeByPct"));if(F.sort(function(e,r){return r-e}),x||I){if(null!=f&&("number"==typeof f&&Number.isInteger(f)&&f>0?(l=f,$=f):Array.isArray(f)&&f.length>0&&((1==f.length||null==f[1]&&Number.isInteger(f[0]))&&(l=f[0],$=f[0]),2==f.length&&(Number.isInteger(f[0])&&Number.isInteger(f[1])?(l=f[0],$=f[1]):null==f[0]&&Number.isInteger(f[1])&&(l=f[1],$=f[1])))),void 0!==l&&void 0!==$||(l=Bc,$=Bc),0==F.length)for(var z=u=Math.max(Math.ceil(Math.log(c/l)/Math.LN2),Math.ceil(Math.log(p/$)/Math.LN2));z>=0;z--)F.push(Math.pow(2,z));else{var N=Math.max.apply(Math,F);u=Math.round(Math.log(N)/Math.LN2)}}else if(l=c,$=p,F=[],y){s.sort(function(e,r){return e[0]-r[0]}),u=-1;var _=[];for(z=0;z<s.length;z++){var b=c/s[z][0];F.length>0&&F[F.length-1]==b?_.push(z):(F.push(b),u++)}if(_.length>0)for(z=0;z<_.length;z++)s.splice(_[z]-z,1)}else F.push(1),s.push([c,p]),u=0;var M=new Xd({tileSize:[l,$],extent:v,origin:fb(v),resolutions:F}),P=dj.bind(null,Oa(f||256).map(function(e){return e*h}));return(t=e.call(this,{attributions:i.attributions,attributionsCollapsible:i.attributionsCollapsible,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,state:i.state,tileClass:P,tileGrid:M,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:function(e,r,t){var i,a,f=e[0];if(!(f>u)){var h=e[1],v=e[2],z=F[f];if(!(void 0===h||void 0===v||void 0===z||h<0||Math.ceil(c/z/l)<=h||v<0||Math.ceil(p/z/$)<=v)){if(I||x){var N=h*l*z,_=v*$*z,b=l*z,M=$*z,P=l,j=$;N+b>c&&(b=c-N),_+M>p&&(M=p-_),N+l*z>c&&(P=Math.floor((c-N+z-1)/z)),_+$*z>p&&(j=Math.floor((p-_+z-1)/z)),0==N&&b==c&&0==_&&M==p?i="full":!I||d.includes("regionByPx")?i=N+","+_+","+b+","+M:d.includes("regionByPct")&&(i="pct:"+Yd(N/c*100)+","+Yd(_/p*100)+","+Yd(b/c*100)+","+Yd(M/p*100)),n!=Ga.VERSION3||I&&!d.includes("sizeByWh")?!I||d.includes("sizeByW")?a=P+",":d.includes("sizeByH")?a=","+j:d.includes("sizeByWh")?a=P+","+j:d.includes("sizeByPct")&&(a="pct:"+Yd(100/z)):a=P+","+j}else if(i="full",y){var A=s[f][0],B=s[f][1];a=n==Ga.VERSION3?A==c&&B==p?"max":A+","+B:A==c?"full":A+","}else a=n==Ga.VERSION3?"max":"full";return o+i+"/"+a+"/0/"+m+"."+g}}},transition:i.transition})||this).zDirection=i.zDirection,t}return Fs(r,e),r}(Qb);bj.default=Gs;var nd={};var ej={};var Hs=ej&&ej.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),bn=function(t){function e(e,r,o,i,a,n){var c=this,s=e.getExtent(),$=r.getExtent(),u=$?vb(o,$):o,p=Ma(u),g=Kf(e,r,p,i),_=Am,m=new Fm(e,r,u,s,g*_,i),l=n(m.calculateSourceExtent(),g,a),h=l?ia.IDLE:ia.EMPTY,I=l?l.getPixelRatio():1;return(c=t.call(this,o,i,I,h)||this).targetProj_=r,c.maxSourceExtent_=s,c.triangulation_=m,c.targetResolution_=i,c.targetExtent_=o,c.sourceImage_=l,c.sourcePixelRatio_=I,c.canvas_=null,c.sourceListenerKey_=null,c}return Hs(e,t),e.prototype.disposeInternal=function(){this.state==ia.LOADING&&this.unlistenSource_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.getProjection=function(){return this.targetProj_},e.prototype.reproject_=function(){var t=this.sourceImage_.getState();if(t==ia.LOADED){var e=la(this.targetExtent_)/this.targetResolution_,r=va(this.targetExtent_)/this.targetResolution_;this.canvas_=Dm(e,r,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=t,this.changed()},e.prototype.load=function(){if(this.state==ia.IDLE){this.state=ia.LOADING,this.changed();var t=this.sourceImage_.getState();t==ia.LOADED||t==ia.ERROR?this.reproject_():(this.sourceListenerKey_=fa(this.sourceImage_,ca.CHANGE,function(t){var e=this.sourceImage_.getState();e!=ia.LOADED&&e!=ia.ERROR||(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}},e.prototype.unlistenSource_=function(){ra(this.sourceListenerKey_),this.sourceListenerKey_=null},e}(xf);ej.default=bn;var cn=nd&&nd.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Tf={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};nd.ImageSourceEventType=Tf;var Uf=function(e){function t(t,r){var o=e.call(this,t)||this;return o.image=r,o}return cn(t,e),t}(Ka);nd.ImageSourceEvent=Uf;var ic=function(e){function t(t){var r=e.call(this,{attributions:t.attributions,projection:t.projection,state:t.state})||this;return r.resolutions_=void 0!==t.resolutions?t.resolutions:null,r.reprojectedImage_=null,r.reprojectedRevision_=0,r}return cn(t,e),t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.findNearestResolution=function(e){if(this.resolutions_){var t=pd(this.resolutions_,e,0);e=this.resolutions_[t]}return e},t.prototype.getImage=function(e,t,r,o){var n=this.getProjection();if(qb&&n&&o&&!lb(n,o)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&lb(this.reprojectedImage_.getProjection(),o)&&this.reprojectedImage_.getResolution()==t&&eb(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new bn(n,o,e,t,r,function(e,t,r){return this.getImageInternal(e,t,r,n)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return n&&(o=n),this.getImageInternal(e,t,r,o)},t.prototype.getImageInternal=function(e,t,r,o){return ma()},t.prototype.handleImageChange=function(e){var t=e.target;switch(t.getState()){case ia.LOADING:this.loading=!0,this.dispatchEvent(new Uf(Tf.IMAGELOADSTART,t));break;case ia.LOADED:this.loading=!1,this.dispatchEvent(new Uf(Tf.IMAGELOADEND,t));break;case ia.ERROR:this.loading=!1,this.dispatchEvent(new Uf(Tf.IMAGELOADERROR,t));}},t}(jd);function Zd(e,t){e.getImage().src=t}nd.defaultImageLoadFunction=Zd,nd.default=ic;var fj={};function Rb(n,e){var a=[];Object.keys(e).forEach(function(n){null!==e[n]&&void 0!==e[n]&&a.push(n+"="+encodeURIComponent(e[n]))});var r=a.join("&");return(n=-1===(n=n.replace(/[?&]$/,"")).indexOf("?")?n+"?":n+"&")+r}var Is=fj&&fj.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Js=function(t){function e(e){var i=this,r=e||{};return(i=t.call(this,{attributions:r.attributions,projection:r.projection,resolutions:r.resolutions})||this).crossOrigin_=void 0!==r.crossOrigin?r.crossOrigin:null,i.hidpi_=void 0===r.hidpi||r.hidpi,i.url_=r.url,i.imageLoadFunction_=void 0!==r.imageLoadFunction?r.imageLoadFunction:Zd,i.params_=r.params||{},i.image_=null,i.imageSize_=[0,0],i.renderedRevision_=0,i.ratio_=void 0!==r.ratio?r.ratio:1.5,i}return Is(e,t),e.prototype.getParams=function(){return this.params_},e.prototype.getImageInternal=function(t,e,i,r){if(void 0===this.url_)return null;e=this.findNearestResolution(e),i=this.hidpi_?i:1;var o=this.image_;if(o&&this.renderedRevision_==this.getRevision()&&o.getResolution()==e&&o.getPixelRatio()==i&&La(o.getExtent(),t))return o;var n={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};ha(n,this.params_);var a=((t=t.slice())[0]+t[2])/2,s=(t[1]+t[3])/2;if(1!=this.ratio_){var p=this.ratio_*la(t)/2,$=this.ratio_*va(t)/2;t[0]=a-p,t[1]=s-$,t[2]=a+p,t[3]=s+$}var u=e/i,g=Math.ceil(la(t)/u),h=Math.ceil(va(t)/u);t[0]=a-u*g/2,t[2]=a+u*g/2,t[1]=s-u*h/2,t[3]=s+u*h/2,this.imageSize_[0]=g,this.imageSize_[1]=h;var c=this.getRequestUrl_(t,this.imageSize_,i,r,n);return this.image_=new Sd(t,e,i,c,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(ca.CHANGE,this.handleImageChange.bind(this)),this.image_},e.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},e.prototype.getRequestUrl_=function(t,e,i,r,o){var n=r.getCode().split(":").pop();o.SIZE=e[0]+","+e[1],o.BBOX=t.join(","),o.BBOXSR=n,o.IMAGESR=n,o.DPI=Math.round(90*i);var a=this.url_,s=a.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return s==a&&ea(!1,50),Rb(s,o)},e.prototype.getUrl=function(){return this.url_},e.prototype.setImageLoadFunction=function(t){this.image_=null,this.imageLoadFunction_=t,this.changed()},e.prototype.setUrl=function(t){t!=this.url_&&(this.url_=t,this.image_=null,this.changed())},e.prototype.updateParams=function(t){ha(this.params_,t),this.image_=null,this.changed()},e}(ic);fj.default=Js;var gj={};var Ks=gj&&gj.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ls=function(t){function e(e){var r=this,n=e||{};return(r=t.call(this,{attributions:n.attributions,projection:n.projection,resolutions:n.resolutions,state:n.state})||this).canvasFunction_=n.canvasFunction,r.canvas_=null,r.renderedRevision_=0,r.ratio_=void 0!==n.ratio?n.ratio:1.5,r}return Ks(e,t),e.prototype.getImageInternal=function(t,e,r,n){e=this.findNearestResolution(e);var o=this.canvas_;if(o&&this.renderedRevision_==this.getRevision()&&o.getResolution()==e&&o.getPixelRatio()==r&&La(o.getExtent(),t))return o;t=t.slice(),td(t,this.ratio_);var i=[la(t)/e*r,va(t)/e*r],a=this.canvasFunction_.call(this,t,e,r,i,n);return a&&(o=new Of(t,e,r,a)),this.canvas_=o,this.renderedRevision_=this.getRevision(),o},e}(ic);gj.default=Ls;var hj={};var Ms=hj&&hj.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ns=function(t){function e(e){var i=t.call(this,{projection:e.projection,resolutions:e.resolutions})||this;return i.crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null,i.displayDpi_=void 0!==e.displayDpi?e.displayDpi:96,i.params_=e.params||{},i.url_=e.url,i.imageLoadFunction_=void 0!==e.imageLoadFunction?e.imageLoadFunction:Zd,i.hidpi_=void 0===e.hidpi||e.hidpi,i.metersPerUnit_=void 0!==e.metersPerUnit?e.metersPerUnit:1,i.ratio_=void 0!==e.ratio?e.ratio:1,i.useOverlay_=void 0!==e.useOverlay&&e.useOverlay,i.image_=null,i.renderedRevision_=0,i}return Ms(e,t),e.prototype.getParams=function(){return this.params_},e.prototype.getImageInternal=function(t,e,i,r){e=this.findNearestResolution(e),i=this.hidpi_?i:1;var o=this.image_;if(o&&this.renderedRevision_==this.getRevision()&&o.getResolution()==e&&o.getPixelRatio()==i&&La(o.getExtent(),t))return o;1!=this.ratio_&&(t=t.slice(),td(t,this.ratio_));var n=[la(t)/e*i,va(t)/e*i];if(void 0!==this.url_){var a=this.getUrl(this.url_,this.params_,t,n,r);(o=new Sd(t,e,i,a,this.crossOrigin_,this.imageLoadFunction_)).addEventListener(ca.CHANGE,this.handleImageChange.bind(this))}else o=null;return this.image_=o,this.renderedRevision_=this.getRevision(),o},e.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},e.prototype.updateParams=function(t){ha(this.params_,t),this.changed()},e.prototype.getUrl=function(t,e,i,r,o){var n=Os(i,r,this.metersPerUnit_,this.displayDpi_),a=Ma(i),s={OPERATION:this.useOverlay_?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.displayDpi_,SETDISPLAYWIDTH:Math.round(r[0]),SETDISPLAYHEIGHT:Math.round(r[1]),SETVIEWSCALE:n,SETVIEWCENTERX:a[0],SETVIEWCENTERY:a[1]};return ha(s,e),Rb(t,s)},e.prototype.setImageLoadFunction=function(t){this.image_=null,this.imageLoadFunction_=t,this.changed()},e}(ic);function Os(t,e,i,r){var o=la(t),n=va(t),a=e[0],s=e[1],$=.0254/r;return s*o>a*n?o*i/(a*$):n*i/(s*$)}hj.default=Ns;var ij={};var Ps=ij&&ij.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Qs=function(e){function t(t){var i=this,r=void 0!==t.crossOrigin?t.crossOrigin:null,a=void 0!==t.imageLoadFunction?t.imageLoadFunction:Zd;return(i=e.call(this,{attributions:t.attributions,projection:pa(t.projection)})||this).url_=t.url,i.imageExtent_=t.imageExtent,i.image_=new Sd(i.imageExtent_,void 0,1,i.url_,r,a),i.imageSize_=t.imageSize?t.imageSize:null,i.image_.addEventListener(ca.CHANGE,i.handleImageChange.bind(i)),i}return Ps(t,e),t.prototype.getImageExtent=function(){return this.imageExtent_},t.prototype.getImageInternal=function(e,t,i,r){return ya(e,this.image_.getExtent())?this.image_:null},t.prototype.getUrl=function(){return this.url_},t.prototype.handleImageChange=function(t){if(this.image_.getState()==ia.LOADED){var i=this.image_.getExtent(),r=this.image_.getImage(),a=void 0,n=void 0;this.imageSize_?(a=this.imageSize_[0],n=this.imageSize_[1]):(a=r.width,n=r.height);var o=va(i)/n,$=Math.ceil(la(i)/o);if($!=a){var g=Ea($,n),p=g.canvas;g.drawImage(r,0,0,a,n,0,0,p.width,p.height),this.image_.setImage(p)}}e.prototype.handleImageChange.call(this,t)},t}(ic);ij.default=Qs;var jj={};var jc="1.3.0";var kc={CARMENTA_SERVER:"carmentaserver",GEOSERVER:"geoserver",MAPSERVER:"mapserver",QGIS:"qgis"};var Rs=jj&&jj.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),dn=[101,101],Ss=function(e){function t(t){var r=this,i=t||{};return(r=e.call(this,{attributions:i.attributions,projection:i.projection,resolutions:i.resolutions})||this).crossOrigin_=void 0!==i.crossOrigin?i.crossOrigin:null,r.url_=i.url,r.imageLoadFunction_=void 0!==i.imageLoadFunction?i.imageLoadFunction:Zd,r.params_=i.params||{},r.v13_=!0,r.updateV13_(),r.serverType_=i.serverType,r.hidpi_=void 0===i.hidpi||i.hidpi,r.image_=null,r.imageSize_=[0,0],r.renderedRevision_=0,r.ratio_=void 0!==i.ratio?i.ratio:1.5,r}return Rs(t,e),t.prototype.getFeatureInfoUrl=function(e,t,r,i){if(void 0!==this.url_){var o=pa(r),a=this.getProjection();a&&a!==o&&(t=Kf(a,o,e,t),e=Tc(e,o,a));var n=Wc(e,t,0,dn),s={SERVICE:"WMS",VERSION:jc,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};ha(s,this.params_,i);var $=Math.floor((e[0]-n[0])/t),p=Math.floor((n[3]-e[1])/t);return s[this.v13_?"I":"X"]=$,s[this.v13_?"J":"Y"]=p,this.getRequestUrl_(n,dn,1,a||o,s)}},t.prototype.getLegendUrl=function(e,t){if(void 0!==this.url_){var r={SERVICE:"WMS",VERSION:jc,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===t||void 0===t.LAYER){var i=this.params_.LAYERS;if(!(!Array.isArray(i)||1===i.length))return;r.LAYER=i}if(void 0!==e){var o=this.getProjection()?this.getProjection().getMetersPerUnit():1;r.SCALE=e*o*39.37*(25.4/.28)}return ha(r,t),Rb(this.url_,r)}},t.prototype.getParams=function(){return this.params_},t.prototype.getImageInternal=function(e,t,r,i){if(void 0===this.url_)return null;t=this.findNearestResolution(t),1==r||this.hidpi_&&void 0!==this.serverType_||(r=1);var o=t/r,a=Ma(e),n=Math.ceil(la(e)/o),s=Math.ceil(va(e)/o),$=Wc(a,o,0,[n,s]),p=Math.ceil(this.ratio_*la(e)/o),u=Math.ceil(this.ratio_*va(e)/o),_=Wc(a,o,0,[p,u]),h=this.image_;if(h&&this.renderedRevision_==this.getRevision()&&h.getResolution()==t&&h.getPixelRatio()==r&&La(h.getExtent(),$))return h;var g={SERVICE:"WMS",VERSION:jc,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};ha(g,this.params_),this.imageSize_[0]=Math.round(la(_)/o),this.imageSize_[1]=Math.round(va(_)/o);var m=this.getRequestUrl_(_,this.imageSize_,r,i,g);return this.image_=new Sd(_,t,r,m,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(ca.CHANGE,this.handleImageChange.bind(this)),this.image_},t.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},t.prototype.getRequestUrl_=function(e,t,r,i,o){if(ea(void 0!==this.url_,9),o[this.v13_?"CRS":"SRS"]=i.getCode(),"STYLES"in this.params_||(o.STYLES=""),1!=r)switch(this.serverType_){case kc.GEOSERVER:var a=90*r+.5|0;"FORMAT_OPTIONS"in o?o.FORMAT_OPTIONS+=";dpi:"+a:o.FORMAT_OPTIONS="dpi:"+a;break;case kc.MAPSERVER:o.MAP_RESOLUTION=90*r;break;case kc.CARMENTA_SERVER:case kc.QGIS:o.DPI=90*r;break;default:ea(!1,8);}o.WIDTH=t[0],o.HEIGHT=t[1];var n,s=i.getAxisOrientation();return n=this.v13_&&"ne"==s.substr(0,2)?[e[1],e[0],e[3],e[2]]:e,o.BBOX=n.join(","),Rb(this.url_,o)},t.prototype.getUrl=function(){return this.url_},t.prototype.setImageLoadFunction=function(e){this.image_=null,this.imageLoadFunction_=e,this.changed()},t.prototype.setUrl=function(e){e!=this.url_&&(this.url_=e,this.image_=null,this.changed())},t.prototype.updateParams=function(e){ha(this.params_,e),this.updateV13_(),this.image_=null,this.changed()},t.prototype.updateV13_=function(){var e=this.params_.VERSION||jc;this.v13_=xk(e,"1.3")>=0},t}(ic);jj.default=Ss;var Vf={};var Ts=Vf&&Vf.__extends||function(){var o=function(t,r){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var r in t)t.hasOwnProperty(r)&&(o[r]=t[r])})(t,r)};return function(t,r){function e(){this.constructor=t}o(t,r),t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}(),kj="&#169; <a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">OpenStreetMap</a> contributors.";Vf.ATTRIBUTION=kj;var Us=function(o){function t(t){var r,e=t||{};r=void 0!==e.attributions?e.attributions:[kj];var n=void 0!==e.crossOrigin?e.crossOrigin:"anonymous",i=void 0!==e.url?e.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";return o.call(this,{attributions:r,cacheSize:e.cacheSize,crossOrigin:n,opaque:void 0===e.opaque||e.opaque,maxZoom:void 0!==e.maxZoom?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,url:i,wrapX:e.wrapX,attributionsCollapsible:!1})||this}return Ts(t,o),t}(rb);Vf.default=Us;var Wf={};var Vs=!0;try{new ImageData(10,10)}catch(_){Vs=!1}var Ws=document.createElement("canvas").getContext("2d");function Xs(a,t,e){if(Vs)return new ImageData(a,t,e);var $=Ws.createImageData(t,e);return $.data.set(a),$}var Ys=Xs;var Zs={},$s=Ys;function en(e){var t=!0;try{new ImageData(10,10)}catch(a){t=!1}function r(e,r,a){return t?new ImageData(e,r,a):{data:e,width:r,height:a}}return function(t){var a,n,i=t.buffers,s=t.meta,o=t.imageOps,u=t.width,h=t.height,l=i.length,f=i[0].byteLength;if(o){var p=new Array(l);for(n=0;n<l;++n)p[n]=r(new Uint8ClampedArray(i[n]),u,h);a=e(p,s).data}else{a=new Uint8ClampedArray(f);var $=new Array(l),c=new Array(l);for(n=0;n<l;++n)$[n]=new Uint8ClampedArray(i[n]),c[n]=[0,0,0,0];for(var _=0;_<f;_+=4){for(var v=0;v<l;++v){var g=$[v];c[v][0]=g[_],c[v][1]=g[_+1],c[v][2]=g[_+2],c[v][3]=g[_+3]}var d=e(c,s);a[_]=d[0],a[_+1]=d[1],a[_+2]=d[2],a[_+3]=d[3]}}return a.buffer}}function _s(e,t){var r=Object.keys(e.lib||{}).map(function(t){return"var "+t+" = "+e.lib[t].toString()+";"}).concat(["var __minion__ = ("+en.toString()+")(",e.operation.toString(),");","self.addEventListener(\"message\", function(event) {","  var buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),a=new Blob(r,{type:"text/javascript"}),n=URL.createObjectURL(a),i=new Worker(n);return i.addEventListener("message",t),i}function jt(e,t){var r=en(e.operation);return{postMessage:function(e){setTimeout(function(){t({data:{buffer:r(e),meta:e.meta}})},0)}}}function Nc(e){var t;this._imageOps=!!e.imageOps;var r=[];if(t=0===e.threads?0:this._imageOps?1:e.threads||1)for(var a=0;a<t;++a)r[a]=_s(e,this._onWorkerMessage.bind(this,a));else r[0]=jt(e,this._onWorkerMessage.bind(this,0));this._workers=r,this._queue=[],this._maxQueueLength=e.queue||1/0,this._running=0,this._dataLookup={},this._job=null}Nc.prototype.process=function(e,t,r){this._enqueue({inputs:e,meta:t,callback:r}),this._dispatch()},Nc.prototype.destroy=function(){for(var e in this)this[e]=null;this._destroyed=!0},Nc.prototype._enqueue=function(e){for(this._queue.push(e);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)},Nc.prototype._dispatch=function(){if(0===this._running&&this._queue.length>0){var e=this._job=this._queue.shift(),t=e.inputs[0].width,r=e.inputs[0].height,a=e.inputs.map(function(e){return e.data.buffer}),n=this._workers.length;if(this._running=n,1===n)this._workers[0].postMessage({buffers:a,meta:e.meta,imageOps:this._imageOps,width:t,height:r},a);else for(var i=e.inputs[0].data.length,s=4*Math.ceil(i/4/n),o=0;o<n;++o){for(var u=o*s,h=[],l=0,f=a.length;l<f;++l)h.push(a[o].slice(u,u+s));this._workers[o].postMessage({buffers:h,meta:e.meta,imageOps:this._imageOps,width:t,height:r},h)}}},Nc.prototype._onWorkerMessage=function(e,t){this._destroyed||(this._dataLookup[e]=t.data,--this._running,0===this._running&&this._resolveJob())},Nc.prototype._resolveJob=function(){var e,t,r=this._job,a=this._workers.length;if(1===a)e=new Uint8ClampedArray(this._dataLookup[0].buffer),t=this._dataLookup[0].meta;else{var n=r.inputs[0].data.length;e=new Uint8ClampedArray(n),t=new Array(n);for(var i=4*Math.ceil(n/4/a),s=0;s<a;++s){var o=this._dataLookup[s].buffer,u=s*i;e.set(new Uint8ClampedArray(o),u),t[s]=this._dataLookup[s].meta}}this._job=null,this._dataLookup={},r.callback(null,$s(e,r.inputs[0].width,r.inputs[0].height),t),this._dispatch()},Zs=Nc;var lj={};var mj={};var qt=mj&&mj.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),fn=function(t){function r(r){var e=r||{};return t.call(this,e)||this}return qt(r,t),r}(ge);mj.default=fn;var nj={};var wt=nj&&nj.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var e in t)t.hasOwnProperty(e)&&(r[e]=t[e])})(t,e)};return function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),oj=function(r){function t(t){var e=r.call(this,t)||this;return e.image_=null,e}return wt(t,r),t.prototype.getImage=function(){return this.image_?this.image_.getImage():null},t.prototype.prepareFrame=function(r){var t=r.layerStatesArray[r.layerIndex],e=r.pixelRatio,i=r.viewState,o=i.resolution,n=this.getLayer().getSource(),a=r.viewHints,s=r.extent;if(void 0!==t.extent&&(s=vb(s,Ua(t.extent,i.projection))),!a[qa.ANIMATING]&&!a[qa.INTERACTING]&&!wc(s))if(n){var $=i.projection;if(!qb){var p=n.getProjection();p&&($=p)}var c=n.getImage(s,o,e,$);c&&this.loadImage(c)&&(this.image_=c)}else this.image_=null;return!!this.image_},t.prototype.renderFrame=function(r,t){var e=this.image_,i=e.getExtent(),o=e.getResolution(),n=e.getPixelRatio(),a=r.layerStatesArray[r.layerIndex],s=r.pixelRatio,$=r.viewState,p=$.center,c=$.resolution,h=r.size,l=s*o/(c*n),m=Math.round(h[0]*s),u=Math.round(h[1]*s),f=$.rotation;if(f){var x=Math.round(Math.sqrt(m*m+u*u));m=x,u=x}Ya(this.pixelTransform,r.size[0]/2,r.size[1]/2,1/s,1/s,f,-m/2,-u/2),yd(this.inversePixelTransform,this.pixelTransform);var N=hk(this.pixelTransform);this.useContainer(t,N,a.opacity);var z=this.context,d=z.canvas;d.width!=m||d.height!=u?(d.width=m,d.height=u):this.containerReused||z.clearRect(0,0,m,u);var g=!1;if(a.extent){var v=Ua(a.extent,$.projection);(g=!La(v,r.extent)&&ya(v,r.extent))&&this.clipUnrotated(z,r,v)}var _=e.getImage(),y=Ya(this.tempTransform_,m/2,u/2,l,l,0,n*(i[0]-p[0])/o,n*(p[1]-i[3])/o);this.renderedResolution=o*s/n;var j=y[4],I=y[5],R=_.width*y[0],w=_.height*y[3];if(this.preRender(z,r),R>=.5&&w>=.5){var T=a.opacity,A=void 0;1!==T&&(A=this.context.globalAlpha,this.context.globalAlpha=T),this.context.drawImage(_,0,0,+_.width,+_.height,Math.round(j),Math.round(I),Math.round(R),Math.round(w)),1!==T&&(this.context.globalAlpha=A)}return this.postRender(z,r),g&&z.restore(),N!==d.style.transform&&(d.style.transform=N),this.container},t}(Ge);nj.default=oj;var zt=lj&&lj.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),gn=function(e){function r(r){return e.call(this,r)||this}return zt(r,e),r.prototype.createRenderer=function(){return new oj(this)},r}(fn);lj.default=gn;var pj={};var At=pj&&pj.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),hn=function(e){function r(r){return e.call(this,r)||this}return At(r,e),r.prototype.createRenderer=function(){return new Dd(this)},r}(rg);pj.default=hn;var jn=Wf&&Wf.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function a(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}(),kn={BEFOREOPERATIONS:"beforeoperations",AFTEROPERATIONS:"afteroperations"},ln={PIXEL:"pixel",IMAGE:"image"},qj=function(e){function t(t,r,a){var n=e.call(this,t)||this;return n.extent=r.extent,n.resolution=r.viewState.resolution/r.pixelRatio,n.data=a,n}return jn(t,e),t}(Ka);Wf.RasterSourceEvent=qj;var Bt=function(e){function t(t){var r=e.call(this,{projection:null})||this;r.worker_=null,r.operationType_=void 0!==t.operationType?t.operationType:ln.PIXEL,r.threads_=void 0!==t.threads?t.threads:1,r.layers_=Gt(t.sources);for(var a=r.changed.bind(r),n=0,i=r.layers_.length;n<i;++n)r.layers_[n].addEventListener(ca.CHANGE,a);return r.tileQueue_=new Zg(function(){return 1},r.changed.bind(r)),r.requestedFrameState_,r.renderedImageCanvas_=null,r.renderedRevision_,r.frameState_={animate:!1,coordinateToPixelTransform:Fa(),extent:null,index:0,layerIndex:0,layerStatesArray:Ft(r.layers_),pixelRatio:1,pixelToCoordinateTransform:Fa(),postRenderFunctions:[],size:[0,0],tileQueue:r.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{},declutterItems:[]},r.setAttributions(function(e){for(var r=[],a=0,n=t.sources.length;a<n;++a){var i=t.sources[a],o=(i instanceof jd?i:i.getSource()).getAttributions();if("function"==typeof o){var $=o(e);r.push.apply(r,$)}}return 0!==r.length?r:null}),void 0!==t.operation&&r.setOperation(t.operation,t.lib),r}return jn(t,e),t.prototype.setOperation=function(e,t){this.worker_=new Zs({operation:e,imageOps:this.operationType_===ln.IMAGE,queue:1,lib:t,threads:this.threads_}),this.changed()},t.prototype.updateFrameState_=function(e,t,r){var a=ha({},this.frameState_);a.viewState=ha({},a.viewState);var n=Ma(e);a.extent=e.slice(),a.size[0]=Math.round(la(e)/t),a.size[1]=Math.round(va(e)/t),a.time=1/0;var i=a.viewState;return i.center=n,i.projection=r,i.resolution=t,a},t.prototype.allSourcesReady_=function(){for(var e=!0,t=0,r=this.layers_.length;t<r;++t)if(this.layers_[t].getSource().getState()!==Aa.READY){e=!1;break}return e},t.prototype.getImage=function(e,t,r,a){if(!this.allSourcesReady_())return null;var n=this.updateFrameState_(e,t,a);if(this.requestedFrameState_=n,this.renderedImageCanvas_){var i=this.renderedImageCanvas_.getResolution(),o=this.renderedImageCanvas_.getExtent();t===i&&eb(e,o)||(this.renderedImageCanvas_=null)}return this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_(),n.tileQueue.loadMoreTiles(16,16),n.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_},t.prototype.processSources_=function(){for(var e=this.requestedFrameState_,t=this.layers_.length,r=new Array(t),a=0;a<t;++a){e.layerIndex=a;var n=Dt(this.layers_[a],e);if(!n)return;r[a]=n}var i={};this.dispatchEvent(new qj(kn.BEFOREOPERATIONS,e,i)),this.worker_.process(r,i,this.onWorkerComplete_.bind(this,e))},t.prototype.onWorkerComplete_=function(e,t,r,a){if(!t&&r){var n=e.extent,i=e.viewState.resolution;if(i===this.requestedFrameState_.viewState.resolution&&eb(n,this.requestedFrameState_.extent)){var o;if(this.renderedImageCanvas_)o=this.renderedImageCanvas_.getImage().getContext("2d");else{var $=Math.round(la(n)/i),s=Math.round(va(n)/i);o=Ea($,s),this.renderedImageCanvas_=new Of(n,i,1,o.canvas)}o.putImageData(r,0,0),this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new qj(kn.AFTEROPERATIONS,e,a))}}},t.prototype.getImageInternal=function(){return null},t}(ic),$d=null;function Dt(e,t){var r=e.getRenderer();if(!r)throw new Error("Unsupported layer type: "+e);if(!r.prepareFrame(t))return null;var a,n=t.size[0],i=t.size[1],o=r.renderFrame(t,null);if(o&&(a=o.firstElementChild),!(a instanceof HTMLCanvasElement))throw new Error("Unsupported rendered element: "+a);if(a.width===n&&a.height===i)return a.getContext("2d").getImageData(0,0,n,i);if($d){var $=$d.canvas;$.width!==n||$.height!==i?$d=Ea(n,i):$d.clearRect(0,0,n,i)}else $d=Ea(n,i);return $d.drawImage(a,0,0,n,i),$d.getImageData(0,0,n,i)}function Ft(e){return e.map(function(e){return e.getLayerState()})}function Gt(e){for(var t=e.length,r=new Array(t),a=0;a<t;++a)r[a]=Ht(e[a]);return r}function Ht(e){var t;return e instanceof jd?e instanceof Mf?t=new hn({source:e}):e instanceof ic&&(t=new gn({source:e})):t=e,t}Wf.default=Bt;var rj={};var Jt=rj&&rj.__extends||function(){var e=function(o,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var n in o)o.hasOwnProperty(n)&&(e[n]=o[n])})(o,n)};return function(o,n){function r(){this.constructor=o}e(o,n),o.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mt=["Map tiles by <a href=\"https://stamen.com/\" target=\"_blank\">Stamen Design</a>, under <a href=\"https://creativecommons.org/licenses/by/3.0/\" target=\"_blank\">CC BY 3.0</a>.",kj],Nt={terrain:{extension:"jpg",opaque:!0},"terrain-background":{extension:"jpg",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},Pt={terrain:{minZoom:0,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:0,maxZoom:18}},Qt=function(e){function o(o){var n=o.layer.indexOf("-"),r=-1==n?o.layer:o.layer.slice(0,n),t=Pt[r],a=Nt[o.layer],i=void 0!==o.url?o.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+o.layer+"/{z}/{x}/{y}."+a.extension;return e.call(this,{attributions:Mt,cacheSize:o.cacheSize,crossOrigin:"anonymous",maxZoom:null!=o.maxZoom?o.maxZoom:t.maxZoom,minZoom:null!=o.minZoom?o.minZoom:t.minZoom,opaque:a.opaque,reprojectionErrorThreshold:o.reprojectionErrorThreshold,tileLoadFunction:o.tileLoadFunction,transition:o.transition,url:i,wrapX:o.wrapX})||this}return Jt(o,e),o}(rb);rj.default=Qt;var sj={};var Ut=sj&&sj.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var e in t)t.hasOwnProperty(e)&&(r[e]=t[e])})(t,e)};return function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),Vt=function(r){function t(t){var e=this,o=t||{};return(e=r.call(this,{attributions:o.attributions,cacheSize:o.cacheSize,crossOrigin:o.crossOrigin,projection:o.projection,reprojectionErrorThreshold:o.reprojectionErrorThreshold,tileGrid:o.tileGrid,tileLoadFunction:o.tileLoadFunction,tileUrlFunction:Wt,url:o.url,urls:o.urls,wrapX:void 0===o.wrapX||o.wrapX,transition:o.transition})||this).params_=o.params||{},e.hidpi_=void 0===o.hidpi||o.hidpi,e.tmpExtent_=Ha(),e.setKey(e.getKeyForParams_()),e}return Ut(t,r),t.prototype.getKeyForParams_=function(){var r=0,t=[];for(var e in this.params_)t[r++]=e+"-"+this.params_[e];return t.join("/")},t.prototype.getParams=function(){return this.params_},t.prototype.getRequestUrl_=function(r,t,e,o,i,s){var a=this.urls;if(a){var n,p=i.getCode().split(":").pop();if(s.SIZE=t[0]+","+t[1],s.BBOX=e.join(","),s.BBOXSR=p,s.IMAGESR=p,s.DPI=Math.round(s.DPI?s.DPI*o:90*o),1==a.length)n=a[0];else n=a[cb(Ki(r),a.length)];var $=n.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return Rb($,s)}},t.prototype.getTilePixelRatio=function(r){return this.hidpi_?r:1},t.prototype.updateParams=function(r){ha(this.params_,r),this.setKey(this.getKeyForParams_())},t}(Qb);function Wt(r,t,e){var o=this.getTileGrid();if(o||(o=this.getTileGridForProjection(e)),!(o.getResolutions().length<=r[0])){1==t||this.hidpi_||(t=1);var i=o.getTileCoordExtent(r,this.tmpExtent_),s=Oa(o.getTileSize(r[0]),this.tmpSize);1!=t&&(s=th(s,t,this.tmpSize));var a={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return ha(a,this.params_),this.getRequestUrl_(r,s,i,t,e,a)}}sj.default=Vt;var tj={};var mn=tj&&tj.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Xt=function(e){function t(t,r,i){var o=e.call(this,t,ba.LOADED)||this;return o.tileSize_=r,o.text_=i,o.canvas_=null,o}return mn(t,e),t.prototype.getImage=function(){if(this.canvas_)return this.canvas_;var e=this.tileSize_,t=Ea(e[0],e[1]);return t.strokeStyle="grey",t.strokeRect(.5,.5,e[0]+.5,e[1]+.5),t.fillStyle="grey",t.strokeStyle="white",t.textAlign="center",t.textBaseline="middle",t.font="24px sans-serif",t.lineWidth=4,t.strokeText(this.text_,e[0]/2,e[1]/2,e[0]),t.fillText(this.text_,e[0]/2,e[1]/2,e[0]),this.canvas_=t.canvas,t.canvas},t.prototype.load=function(){},t}(Jc),Yt=function(e){function t(t){var r=t||{};return e.call(this,{opaque:!1,projection:r.projection,tileGrid:r.tileGrid,wrapX:void 0===r.wrapX||r.wrapX,zDirection:r.zDirection})||this}return mn(t,e),t.prototype.getTile=function(e,t,r){var i=hc(e,t,r);if(this.tileCache.containsKey(i))return this.tileCache.get(i);var o=Oa(this.tileGrid.getTileSize(e)),n=[e,t,r],a=this.getTileCoordForTileUrlFunction(n),$=void 0;$=a?"z:"+a[0]+" x:"+a[1]+" y:"+a[2]:"none";var s=new Xt(n,o,$);return this.tileCache.set(i,s),s},t}(rb);tj.default=Yt;var uj={};var au=uj&&uj.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),bu=function(t){function e(e){var r=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,projection:pa("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:Aa.LOADING,tileLoadFunction:e.tileLoadFunction,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition})||this;if(r.tileJSON_=null,r.tileSize_=e.tileSize,e.url){if(e.jsonp)Qf(e.url,r.handleTileJSONResponse.bind(r),r.handleTileJSONError.bind(r));else{var o=new XMLHttpRequest;o.addEventListener("load",r.onXHRLoad_.bind(r)),o.addEventListener("error",r.onXHRError_.bind(r)),o.open("GET",e.url),o.send()}}else e.tileJSON?r.handleTileJSONResponse(e.tileJSON):ea(!1,51);return r}return au(e,t),e.prototype.onXHRLoad_=function(t){var e=t.target;if(!e.status||e.status>=200&&e.status<300){var r=void 0;try{r=JSON.parse(e.responseText)}catch(o){return void this.handleTileJSONError()}this.handleTileJSONResponse(r)}else this.handleTileJSONError()},e.prototype.onXHRError_=function(t){this.handleTileJSONError()},e.prototype.getTileJSON=function(){return this.tileJSON_},e.prototype.handleTileJSONResponse=function(t){var e,r=pa("EPSG:4326"),o=this.getProjection();if(void 0!==t.bounds){var i=mb(r,o);e=Xc(t.bounds,i)}var n=t.minzoom||0,s=t.maxzoom||22,a=Wd({extent:Kc(o),maxZoom:s,minZoom:n,tileSize:this.tileSize_});if(this.tileGrid=a,this.tileUrlFunction=Oi(t.tiles,a),void 0!==t.attribution&&!this.getAttributions()){var $=void 0!==e?e:r.getExtent();this.setAttributions(function(e){return ya($,e.extent)?[t.attribution]:null})}this.tileJSON_=t,this.setState(Aa.READY)},e.prototype.handleTileJSONError=function(){this.setState(Aa.ERROR)},e}(Qb);uj.default=bu;var vj={};var cu=vj&&vj.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function i(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),du=function(t){function r(r){var e=this,i=r||{},o=i.params||{},s=!("TRANSPARENT"in o)||o.TRANSPARENT;return(e=t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,opaque:!s,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileClass:i.tileClass,tileGrid:i.tileGrid,tileLoadFunction:i.tileLoadFunction,tileUrlFunction:eu,url:i.url,urls:i.urls,wrapX:void 0===i.wrapX||i.wrapX,transition:i.transition})||this).gutter_=void 0!==i.gutter?i.gutter:0,e.params_=o,e.v13_=!0,e.serverType_=i.serverType,e.hidpi_=void 0===i.hidpi||i.hidpi,e.tmpExtent_=Ha(),e.updateV13_(),e.setKey(e.getKeyForParams_()),e}return cu(r,t),r.prototype.getFeatureInfoUrl=function(t,r,e,i){var o=pa(e),s=this.getProjection(),$=this.getTileGrid();$||($=this.getTileGridForProjection(o));var a=$.getZForResolution(r,this.zDirection),p=$.getTileCoordForCoordAndZ(t,a);if(!($.getResolutions().length<=p[0])){var n=$.getResolution(p[0]),c=$.getTileCoordExtent(p,this.tmpExtent_),u=Oa($.getTileSize(p[0]),this.tmpSize),O=this.gutter_;0!==O&&(u=Wk(u,O,this.tmpSize),c=db(c,n*O,c)),s&&s!==o&&(n=Kf(s,o,t,n),c=wg(c,o,s),t=Tc(t,o,s));var l={SERVICE:"WMS",VERSION:jc,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};ha(l,this.params_,i);var I=Math.floor((t[0]-c[0])/n),h=Math.floor((c[3]-t[1])/n);return l[this.v13_?"I":"X"]=I,l[this.v13_?"J":"Y"]=h,this.getRequestUrl_(p,u,c,1,s||o,l)}},r.prototype.getLegendUrl=function(t,r){if(void 0!==this.urls[0]){var e={SERVICE:"WMS",VERSION:jc,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===r||void 0===r.LAYER){var i=this.params_.LAYERS;if(!(!Array.isArray(i)||1===i.length))return;e.LAYER=i}if(void 0!==t){var o=this.getProjection()?this.getProjection().getMetersPerUnit():1;e.SCALE=t*o*39.37*(25.4/.28)}return ha(e,r),Rb(this.urls[0],e)}},r.prototype.getGutter=function(){return this.gutter_},r.prototype.getParams=function(){return this.params_},r.prototype.getRequestUrl_=function(t,r,e,i,o,s){var $=this.urls;if($){if(s.WIDTH=r[0],s.HEIGHT=r[1],s[this.v13_?"CRS":"SRS"]=o.getCode(),"STYLES"in this.params_||(s.STYLES=""),1!=i)switch(this.serverType_){case kc.GEOSERVER:var a=90*i+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+a:s.FORMAT_OPTIONS="dpi:"+a;break;case kc.MAPSERVER:s.MAP_RESOLUTION=90*i;break;case kc.CARMENTA_SERVER:case kc.QGIS:s.DPI=90*i;break;default:ea(!1,52);}var p,n=o.getAxisOrientation(),c=e;if(this.v13_&&"ne"==n.substr(0,2)){var u=void 0;u=e[0],c[0]=e[1],c[1]=u,u=e[2],c[2]=e[3],c[3]=u}if(s.BBOX=c.join(","),1==$.length)p=$[0];else p=$[cb(Ki(t),$.length)];return Rb(p,s)}},r.prototype.getTilePixelRatio=function(t){return this.hidpi_&&void 0!==this.serverType_?t:1},r.prototype.getKeyForParams_=function(){var t=0,r=[];for(var e in this.params_)r[t++]=e+"-"+this.params_[e];return r.join("/")},r.prototype.updateParams=function(t){ha(this.params_,t),this.updateV13_(),this.setKey(this.getKeyForParams_())},r.prototype.updateV13_=function(){var t=this.params_.VERSION||jc;this.v13_=xk(t,"1.3")>=0},r}(Qb);function eu(t,r,e){var i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(e)),!(i.getResolutions().length<=t[0])){1==r||this.hidpi_&&void 0!==this.serverType_||(r=1);var o=i.getResolution(t[0]),s=i.getTileCoordExtent(t,this.tmpExtent_),$=Oa(i.getTileSize(t[0]),this.tmpSize),a=this.gutter_;0!==a&&($=Wk($,a,this.tmpSize),s=db(s,o*a,s)),1!=r&&($=th($,r,this.tmpSize));var p={SERVICE:"WMS",VERSION:jc,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return ha(p,this.params_),this.getRequestUrl_(t,$,s,r,e,p)}}vj.default=du;var Xf={};var nn=Xf&&Xf.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),on=function(t){function e(e,o,r,i,n,s){var a=t.call(this,e,o)||this;return a.src_=r,a.extent_=i,a.preemptive_=n,a.grid_=null,a.keys_=null,a.data_=null,a.jsonp_=s,a}return nn(e,t),e.prototype.getImage=function(){return null},e.prototype.getData=function(t){if(!this.grid_||!this.keys_)return null;var e=(t[0]-this.extent_[0])/(this.extent_[2]-this.extent_[0]),o=(t[1]-this.extent_[1])/(this.extent_[3]-this.extent_[1]),r=this.grid_[Math.floor((1-o)*this.grid_.length)];if("string"!=typeof r)return null;var i=r.charCodeAt(Math.floor(e*r.length));i>=93&&i--,i>=35&&i--;var n=null;if((i-=32)in this.keys_){var s=this.keys_[i];n=this.data_&&s in this.data_?this.data_[s]:s}return n},e.prototype.forDataAtCoordinate=function(t,e,o){this.state==ba.EMPTY&&!0===o?(this.state=ba.IDLE,Qc(this,ca.CHANGE,function(o){e(this.getData(t))},this),this.loadInternal_()):!0===o?setTimeout(function(){e(this.getData(t))}.bind(this),0):e(this.getData(t))},e.prototype.getKey=function(){return this.src_},e.prototype.handleError_=function(){this.state=ba.ERROR,this.changed()},e.prototype.handleLoad_=function(t){this.grid_=t.grid,this.keys_=t.keys,this.data_=t.data,this.state=ba.LOADED,this.changed()},e.prototype.loadInternal_=function(){if(this.state==ba.IDLE)if(this.state=ba.LOADING,this.jsonp_)Qf(this.src_,this.handleLoad_.bind(this),this.handleError_.bind(this));else{var t=new XMLHttpRequest;t.addEventListener("load",this.onXHRLoad_.bind(this)),t.addEventListener("error",this.onXHRError_.bind(this)),t.open("GET",this.src_),t.send()}},e.prototype.onXHRLoad_=function(t){var e=t.target;if(!e.status||e.status>=200&&e.status<300){var o=void 0;try{o=JSON.parse(e.responseText)}catch(r){return void this.handleError_()}this.handleLoad_(o)}else this.handleError_()},e.prototype.onXHRError_=function(t){this.handleError_()},e.prototype.load=function(){this.preemptive_?this.loadInternal_():this.setState(ba.EMPTY)},e}(Jc);Xf.CustomTile=on;var fu=function(t){function e(e){var o=t.call(this,{projection:pa("EPSG:3857"),state:Aa.LOADING})||this;if(o.preemptive_=void 0===e.preemptive||e.preemptive,o.tileUrlFunction_=Pi,o.template_=void 0,o.jsonp_=e.jsonp||!1,e.url){if(o.jsonp_)Qf(e.url,o.handleTileJSONResponse.bind(o),o.handleTileJSONError.bind(o));else{var r=new XMLHttpRequest;r.addEventListener("load",o.onXHRLoad_.bind(o)),r.addEventListener("error",o.onXHRError_.bind(o)),r.open("GET",e.url),r.send()}}else e.tileJSON?o.handleTileJSONResponse(e.tileJSON):ea(!1,51);return o}return nn(e,t),e.prototype.onXHRLoad_=function(t){var e=t.target;if(!e.status||e.status>=200&&e.status<300){var o=void 0;try{o=JSON.parse(e.responseText)}catch(r){return void this.handleTileJSONError()}this.handleTileJSONResponse(o)}else this.handleTileJSONError()},e.prototype.onXHRError_=function(t){this.handleTileJSONError()},e.prototype.getTemplate=function(){return this.template_},e.prototype.forDataAtCoordinateAndResolution=function(t,e,o,r){if(this.tileGrid){var i=this.tileGrid.getZForResolution(e,this.zDirection),n=this.tileGrid.getTileCoordForCoordAndZ(t,i);this.getTile(n[0],n[1],n[2],1,this.getProjection()).forDataAtCoordinate(t,o,r)}else!0===r?setTimeout(function(){o(null)},0):o(null)},e.prototype.handleTileJSONError=function(){this.setState(Aa.ERROR)},e.prototype.handleTileJSONResponse=function(t){var e,o=pa("EPSG:4326"),r=this.getProjection();if(void 0!==t.bounds){var i=mb(o,r);e=Xc(t.bounds,i)}var n=t.minzoom||0,s=t.maxzoom||22,a=Wd({extent:Kc(r),maxZoom:s,minZoom:n});this.tileGrid=a,this.template_=t.template;var l=t.grids;if(l){if(this.tileUrlFunction_=Oi(l,a),void 0!==t.attribution){var $=void 0!==e?e:o.getExtent();this.setAttributions(function(e){return ya($,e.extent)?[t.attribution]:null})}this.setState(Aa.READY)}else this.setState(Aa.ERROR)},e.prototype.getTile=function(t,e,o,r,i){var n=hc(t,e,o);if(this.tileCache.containsKey(n))return this.tileCache.get(n);var s=[t,e,o],a=this.getTileCoordForTileUrlFunction(s,i),l=this.tileUrlFunction_(a,r,i),$=new on(s,void 0!==l?ba.IDLE:ba.EMPTY,void 0!==l?l:"",this.tileGrid.getTileCoordExtent(s),this.preemptive_,this.jsonp_);return this.tileCache.set(n,$),$},e.prototype.useTile=function(t,e,o){var r=hc(t,e,o);this.tileCache.containsKey(r)&&this.tileCache.get(r)},e}(Mf);Xf.default=fu;var Yf={};var gu=Yf&&Yf.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),hu=function(e){function t(t){var o=this,i=t.projection||"EPSG:3857",r=t.extent||Kc(i),n=t.tileGrid||Wd({extent:r,maxResolution:t.maxResolution,maxZoom:void 0!==t.maxZoom?t.maxZoom:22,minZoom:t.minZoom,tileSize:t.tileSize||512});return(o=e.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,opaque:!1,projection:i,state:t.state,tileGrid:n,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:pn,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:void 0===t.zDirection?1:t.zDirection})||this).format_=t.format?t.format:null,o.loadingTiles_={},o.sourceTileCache=new Jf(o.tileCache.highWaterMark),o.overlaps_=null==t.overlaps||t.overlaps,o.tileClass=t.tileClass?t.tileClass:Xm,o.tileGrids_={},o}return gu(t,e),t.prototype.getFeaturesInExtent=function(e){var t=[],o=this.tileCache;if(0===o.getCount())return t;var i=Cm(o.peekFirstKey())[0],r=this.tileGrid;return o.forEach(function(o){if(o.tileCoord[0]===i&&o.getState()===ba.LOADED)for(var n=o.getSourceTiles(),l=0,u=n.length;l<u;++l){var a=n[l],$=a.tileCoord;if(ya(e,r.getTileCoordExtent($))){var s=a.getFeatures();if(s)for(var c=0,p=s.length;c<p;++c){var h=s[c],d=h.getGeometry();ya(e,d.getExtent())&&t.push(h)}}}}),t},t.prototype.getOverlaps=function(){return this.overlaps_},t.prototype.clear=function(){this.tileCache.clear(),this.sourceTileCache.clear()},t.prototype.expireCache=function(t,o){e.prototype.expireCache.call(this,t,o),this.sourceTileCache.expireCache({})},t.prototype.getSourceTiles=function(e,t,o){var i=o.wrappedTileCoord,r=this.getTileGridForProjection(t),n=r.getTileCoordExtent(i),l=i[0],u=r.getResolution(l);db(n,-u,n);var a=this.tileGrid,$=a.getExtent();$&&vb(n,$,n);var s,c,p,h=a.getZForResolution(u,1),d=a.getMinZoom(),A=o.sourceTiles;if(A&&A.length>0&&A[0].tileCoord[0]===h)s=A,c=!0,p=h;else{s=[],p=h+1;do{--p,c=!0,a.forEachTileCoord(n,p,function(i){var r,n=this.tileUrlFunction(i,e,t);if(void 0!==n)if(this.sourceTileCache.containsKey(n)){var l=(r=this.sourceTileCache.get(n)).getState();if(l===ba.LOADED||l===ba.ERROR||l===ba.EMPTY)return void s.push(r)}else p===h&&((r=new this.tileClass(i,ba.IDLE,n,this.format_,this.tileLoadFunction)).extent=a.getTileCoordExtent(i),r.projection=t,r.resolution=a.getResolution(i[0]),this.sourceTileCache.set(n,r),r.addEventListener(ca.CHANGE,this.handleTileChange.bind(this)),r.load());c=c&&r&&r.getState()===ba.LOADED,r&&r.getState()!==ba.EMPTY&&o.getState()===ba.IDLE&&(o.loadingSourceTiles++,r.addEventListener(ca.CHANGE,function e(){var t=r.getState(),i=r.getKey();if(t===ba.LOADED||t===ba.ERROR){t===ba.LOADED?(r.removeEventListener(ca.CHANGE,e),o.loadingSourceTiles--,delete o.errorSourceTileKeys[i]):t===ba.ERROR&&(o.errorSourceTileKeys[i]=!0);var n=Object.keys(o.errorSourceTileKeys).length;o.loadingSourceTiles-n==0&&(o.hifi=0===n,o.sourceZ=h,o.setState(ba.LOADED))}}))}.bind(this)),c||(s.length=0)}while(!c&&p>d)}return o.getState()===ba.IDLE&&o.setState(ba.LOADING),c&&(o.hifi=h===p,o.sourceZ=p,o.getState()<ba.LOADED?o.setState(ba.LOADED):A&&Vb(s,A)||(o.sourceTiles=s)),s},t.prototype.getTile=function(e,t,o,i,r){var n,l=hc(e,t,o),u=this.getKey();if(this.tileCache.containsKey(l)&&(n=this.tileCache.get(l)).key===u)return n;var a=[e,t,o],$=this.getTileCoordForTileUrlFunction(a,r),s=this.getTileGrid().getExtent(),c=this.getTileGridForProjection(r);if($&&s){var p=c.getTileCoordExtent($);db(p,-c.getResolution(e),p),ya(s,p)||($=null)}var h=!0;if(null!==$){var d=this.tileGrid,A=c.getResolution(e),T=d.getZForResolution(A,1),m=c.getTileCoordExtent($);db(m,-A,m),d.forEachTileCoord(m,T,function(e){h=h&&!this.tileUrlFunction(e,i,r)}.bind(this))}var f=new Wm(a,h?ba.EMPTY:ba.IDLE,$,this.getSourceTiles.bind(this,i,r));return f.key=u,n?(f.interimTile=n,f.refreshInterimChain(),this.tileCache.replace(l,f)):this.tileCache.set(l,f),f},t.prototype.getTileGridForProjection=function(e){var t=e.getCode(),o=this.tileGrids_[t];if(!o){var i=this.tileGrid;o=Jm(e,void 0,i?i.getTileSize(i.getMinZoom()):void 0),this.tileGrids_[t]=o}return o},t.prototype.getTilePixelRatio=function(e){return e},t.prototype.getTilePixelSize=function(e,t,o){var i=this.getTileGridForProjection(o),r=Oa(i.getTileSize(e),this.tmpSize);return[Math.round(r[0]*t),Math.round(r[1]*t)]},t}(Si);function pn(e,t){var o=jm(t,e.getFormat(),e.onLoad.bind(e),e.onError.bind(e));e.setLoader(o)}Yf.default=hu,Yf.defaultLoadFunction=pn;var Zf={};var lc={KVP:"KVP",REST:"REST"};var $f={};var iu=$f&&$f.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),qn=function(t){function e(e){var r=t.call(this,{extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes})||this;return r.matrixIds_=e.matrixIds,r}return iu(e,t),e.prototype.getMatrixId=function(t){return this.matrixIds_[t]},e.prototype.getMatrixIds=function(){return this.matrixIds_},e}(Xd);function rn(t,e,r){var i=[],o=[],n=[],s=[],a=[],$=void 0!==r?r:[],p=t.SupportedCRS,u=pa(p.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||pa(p),c=u.getMetersPerUnit(),l="ne"==u.getAxisOrientation().substr(0,2);return t.TileMatrix.sort(function(t,e){return e.ScaleDenominator-t.ScaleDenominator}),t.TileMatrix.forEach(function(e){if(!($.length>0)||qd($,function(r){return e.Identifier==r.TileMatrix||-1===e.Identifier.indexOf(":")&&t.Identifier+":"+e.Identifier===r.TileMatrix})){o.push(e.Identifier);var r=28e-5*e.ScaleDenominator/c,p=e.TileWidth,u=e.TileHeight;l?n.push([e.TopLeftCorner[1],e.TopLeftCorner[0]]):n.push(e.TopLeftCorner),i.push(r),s.push(p==u?p:[p,u]),a.push([e.MatrixWidth,e.MatrixHeight])}}),new qn({extent:e,origins:n,resolutions:i,matrixIds:o,tileSizes:s,sizes:a})}$f.default=qn,$f.createFromCapabilitiesMatrixSet=rn;var ju=Zf&&Zf.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ku=function(t){function e(e){var i=this,r=void 0!==e.requestEncoding?e.requestEncoding:lc.KVP,n=e.tileGrid,o=e.urls;return void 0===o&&void 0!==e.url&&(o=Qi(e.url)),(i=t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:n,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:Pi,urls:o,wrapX:void 0!==e.wrapX&&e.wrapX,transition:e.transition})||this).version_=void 0!==e.version?e.version:"1.0.0",i.format_=void 0!==e.format?e.format:"image/jpeg",i.dimensions_=void 0!==e.dimensions?e.dimensions:{},i.layer_=e.layer,i.matrixSet_=e.matrixSet,i.style_=e.style,i.requestEncoding_=r,i.setKey(i.getKeyForDimensions_()),o&&o.length>0&&(i.tileUrlFunction=Vd(o.map(sn.bind(i)))),i}return ju(e,t),e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.setTileUrlFunction(Vd(t.map(sn.bind(this))),e)},e.prototype.getDimensions=function(){return this.dimensions_},e.prototype.getFormat=function(){return this.format_},e.prototype.getLayer=function(){return this.layer_},e.prototype.getMatrixSet=function(){return this.matrixSet_},e.prototype.getRequestEncoding=function(){return this.requestEncoding_},e.prototype.getStyle=function(){return this.style_},e.prototype.getVersion=function(){return this.version_},e.prototype.getKeyForDimensions_=function(){var t=0,e=[];for(var i in this.dimensions_)e[t++]=i+"-"+this.dimensions_[i];return e.join("/")},e.prototype.updateDimensions=function(t){ha(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())},e}(Qb);function lu(t,e){var i=t.Contents.Layer,r=qd(i,function(t,i,r){return t.Identifier==e.layer});if(null===r)return null;var n,o=t.Contents.TileMatrixSet;(n=r.TileMatrixSetLink.length>1?"projection"in e?jg(r.TileMatrixSetLink,function(t,i,r){var n=qd(o,function(e){return e.Identifier==t.TileMatrixSet}).SupportedCRS,s=pa(n.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||pa(n),a=pa(e.projection);return s&&a?lb(s,a):n==e.projection}):jg(r.TileMatrixSetLink,function(t,i,r){return t.TileMatrixSet==e.matrixSet}):0)<0&&(n=0);var s=r.TileMatrixSetLink[n].TileMatrixSet,a=r.TileMatrixSetLink[n].TileMatrixSetLimits,$=r.Format[0];"format"in e&&($=e.format),(n=jg(r.Style,function(t,i,r){return"style"in e?t.Title==e.style:t.isDefault}))<0&&(n=0);var p=r.Style[n].Identifier,l={};"Dimension"in r&&r.Dimension.forEach(function(t,e,i){var r=t.Identifier,n=t.Default;void 0===n&&(n=t.Value[0]),l[r]=n});var u,c=t.Contents.TileMatrixSet,m=qd(c,function(t,e,i){return t.Identifier==s}),d=m.SupportedCRS;if(d&&(u=pa(d.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"))||pa(d)),"projection"in e){var f=pa(e.projection);f&&(u&&!lb(f,u)||(u=f))}var R=m.TileMatrix[0],L=28e-5*R.ScaleDenominator,I=u===pa("EPSG:4326")?[R.TopLeftCorner[1],R.TopLeftCorner[0]]:R.TopLeftCorner,g=R.TileWidth*L,T=R.TileHeight*L,h=[I[0],I[1]-T*R.MatrixHeight,I[0]+g*R.MatrixWidth,I[1]];null===u.getExtent()&&u.setExtent(h);var v=rn(m,h,a),S=[],x=e.requestEncoding;if(x=void 0!==x?x:"","OperationsMetadata"in t&&"GetTile"in t.OperationsMetadata)for(var y=t.OperationsMetadata.GetTile.DCP.HTTP.Get,_=0,M=y.length;_<M;++_)if(y[_].Constraint){var j=qd(y[_].Constraint,function(t){return"GetEncoding"==t.name}).AllowedValues.Value;if(""===x&&(x=j[0]),x!==lc.KVP)break;pc(j,lc.KVP)&&S.push(y[_].href)}else y[_].href&&(x=lc.KVP,S.push(y[_].href));return 0===S.length&&(x=lc.REST,r.ResourceURL.forEach(function(t){"tile"===t.resourceType&&($=t.format,S.push(t.template))})),{urls:S,layer:e.layer,matrixSet:s,format:$,projection:u,requestEncoding:x,tileGrid:v,style:p,dimensions:l,wrapX:!1,crossOrigin:e.crossOrigin}}function sn(t){var e=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};e==lc.KVP&&ha(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),t=e==lc.KVP?Rb(t,i):t.replace(/\{(\w+?)\}/g,function(t,e){return e.toLowerCase()in i?i[e.toLowerCase()]:t});var r=this.tileGrid,n=this.dimensions_;return function(i,o,s){if(i){var a={TileMatrix:r.getMatrixId(i[0]),TileCol:i[1],TileRow:i[2]};ha(a,n);var $=t;return $=e==lc.KVP?Rb($,a):$.replace(/\{(\w+?)\}/g,function(t,e){return a[e]})}}}Zf.default=ku,Zf.optionsFromCapabilities=lu;var wj={};var xj={};var _f=34962;var yj=34963;var mu=35040;var nu=35044;var ag=35048;var ou=5121;var pu=5123;var qu=5125;var tn=5126;var un,vn=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function wn($,t){for(var e=vn.length,r=0;r<e;++r)try{var S=$.getContext(vn[r],t);if(S)return S}catch(v){}return null}function ru(){if(!un){var $=wn(document.createElement("canvas"));$&&(un=$.getSupportedExtensions())}return un}var su={STATIC_DRAW:nu,STREAM_DRAW:mu,DYNAMIC_DRAW:ag};var zj=function(){function r(r,t){this.array=null,this.type=r,ea(r===_f||r===yj,62),this.usage=void 0!==t?t:su.STATIC_DRAW}return r.prototype.ofSize=function(r){this.array=new(Aj(this.type))(r)},r.prototype.fromArray=function(r){this.array=Aj(this.type).from(r)},r.prototype.fromArrayBuffer=function(r){this.array=new(Aj(this.type))(r)},r.prototype.getType=function(){return this.type},r.prototype.getArray=function(){return this.array},r.prototype.getUsage=function(){return this.usage},r.prototype.getSize=function(){return this.array?this.array.length:0},r}();function Aj(r){switch(r){case _f:return Float32Array;case yj:return Uint32Array;default:return Float32Array;}}var Oc={};var bg={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};function tu(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Bj(r,$){return r[0]=$[0],r[1]=$[1],r[4]=$[2],r[5]=$[3],r[12]=$[4],r[13]=$[5],r}var uu="\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n",vu="\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord);\n  }\n",xn=function(){function e(e){this.gl_=e.webGlContext;var r=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=r.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=r.createFramebuffer();var t=r.createShader(r.VERTEX_SHADER);r.shaderSource(t,e.vertexShader||uu),r.compileShader(t);var i=r.createShader(r.FRAGMENT_SHADER);r.shaderSource(i,e.fragmentShader||vu),r.compileShader(i),this.renderTargetProgram_=r.createProgram(),r.attachShader(this.renderTargetProgram_,t),r.attachShader(this.renderTargetProgram_,i),r.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),r.bufferData(r.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),r.STATIC_DRAW),this.renderTargetAttribLocation_=r.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=r.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetTextureLocation_=r.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(function(t){this.uniforms_.push({value:e.uniforms[t],location:r.getUniformLocation(this.renderTargetProgram_,t)})}.bind(this))}return e.prototype.getGL=function(){return this.gl_},e.prototype.init=function(e){var r=this.getGL(),t=[r.drawingBufferWidth*this.scaleRatio_,r.drawingBufferHeight*this.scaleRatio_];if(r.bindFramebuffer(r.FRAMEBUFFER,this.getFrameBuffer()),r.viewport(0,0,t[0],t[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==t[0]||this.renderTargetTextureSize_[1]!==t[1]){this.renderTargetTextureSize_=t;var i=r.RGBA,a=r.RGBA,n=r.UNSIGNED_BYTE;r.bindTexture(r.TEXTURE_2D,this.renderTargetTexture_),r.texImage2D(r.TEXTURE_2D,0,i,t[0],t[1],0,a,n,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,this.renderTargetTexture_,0)}},e.prototype.apply=function(e,r){var t=this.getGL(),i=e.size;t.bindFramebuffer(t.FRAMEBUFFER,r?r.getFrameBuffer():null),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.useProgram(this.renderTargetProgram_),t.enableVertexAttribArray(this.renderTargetAttribLocation_),t.vertexAttribPointer(this.renderTargetAttribLocation_,2,t.FLOAT,!1,0,0),t.uniform2f(this.renderTargetUniformLocation_,i[0],i[1]),t.uniform1i(this.renderTargetTextureLocation_,0),this.applyUniforms(e),t.drawArrays(t.TRIANGLES,0,6)},e.prototype.getFrameBuffer=function(){return this.frameBuffer_},e.prototype.applyUniforms=function(e){var r,t=this.getGL(),i=1;this.uniforms_.forEach(function(a){if((r="function"==typeof a.value?a.value(e):a.value)instanceof HTMLCanvasElement||r instanceof ImageData)a.texture||(a.texture=t.createTexture()),t.activeTexture(t["TEXTURE"+i]),t.bindTexture(t.TEXTURE_2D,a.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,r.width,r.height,0,t.UNSIGNED_BYTE,new Uint8Array(r.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.uniform1i(a.location,i++);else if(Array.isArray(r))switch(r.length){case 2:return void t.uniform2f(a.location,r[0],r[1]);case 3:return void t.uniform3f(a.location,r[0],r[1],r[2]);case 4:return void t.uniform4f(a.location,r[0],r[1],r[2],r[3]);default:return;}else"number"==typeof r&&t.uniform1f(a.location,r)})},e}();var wu=Oc&&Oc.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),xu={FRAGMENT_SHADER:35632,VERTEX_SHADER:35633};Oc.ShaderType=xu;var Pc={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution"};Oc.DefaultUniform=Pc;var jb={UNSIGNED_BYTE:ou,UNSIGNED_SHORT:pu,UNSIGNED_INT:qu,FLOAT:tn};Oc.AttributeType=jb;var yn=function(t){function e(e){var r=t.call(this)||this,o=e||{};r.boundHandleWebGLContextLost_=r.handleWebGLContextLost.bind(r),r.boundHandleWebGLContextRestored_=r.handleWebGLContextRestored.bind(r),r.canvas_=document.createElement("canvas"),r.canvas_.style.position="absolute",r.canvas_.style.left="0",r.gl_=wn(r.canvas_);var i=r.getGL();if(r.bufferCache_={},r.currentProgram_=null,ea(pc(ru(),"OES_element_index_uint"),63),i.getExtension("OES_element_index_uint"),r.canvas_.addEventListener(bg.LOST,r.boundHandleWebGLContextLost_),r.canvas_.addEventListener(bg.RESTORED,r.boundHandleWebGLContextRestored_),r.offsetRotateMatrix_=Fa(),r.offsetScaleMatrix_=Fa(),r.tmpMat4_=tu(),r.uniformLocations_={},r.attribLocations_={},r.uniforms_=[],o.uniforms)for(var a in o.uniforms)r.uniforms_.push({name:a,value:o.uniforms[a]});return r.postProcessPasses_=o.postProcesses?o.postProcesses.map(function(t){return new xn({webGlContext:i,scaleRatio:t.scaleRatio,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms})}):[new xn({webGlContext:i})],r.shaderCompileErrors_=null,r.startTime_=Date.now(),r}return wu(e,t),e.prototype.bindBuffer=function(t){var e=this.getGL(),r=da(t),o=this.bufferCache_[r];o||(o={buffer:t,webGlBuffer:e.createBuffer()},this.bufferCache_[r]=o);e.bindBuffer(t.getType(),o.webGlBuffer)},e.prototype.flushBufferData=function(t){var e=this.getGL();this.bindBuffer(t),e.bufferData(t.getType(),t.getArray(),t.getUsage())},e.prototype.deleteBuffer=function(t){var e=this.getGL(),r=da(t),o=this.bufferCache_[r];e.isContextLost()||e.deleteBuffer(o.buffer),delete this.bufferCache_[r]},e.prototype.disposeInternal=function(){this.canvas_.removeEventListener(bg.LOST,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(bg.RESTORED,this.boundHandleWebGLContextRestored_)},e.prototype.prepareDraw=function(t){var e=this.getGL(),r=this.getCanvas(),o=t.size,i=t.pixelRatio;r.width=o[0]*i,r.height=o[1]*i,r.style.width=o[0]+"px",r.style.height=o[1]+"px",e.useProgram(this.currentProgram_);for(var a=this.postProcessPasses_.length-1;a>=0;a--)this.postProcessPasses_[a].init(t);e.bindTexture(e.TEXTURE_2D,null),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),e.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.prepareDrawToRenderTarget=function(t,e,r){var o=this.getGL(),i=e.getSize();o.bindFramebuffer(o.FRAMEBUFFER,e.getFramebuffer()),o.viewport(0,0,i[0],i[1]),o.bindTexture(o.TEXTURE_2D,e.getTexture()),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT),o.enable(o.BLEND),o.blendFunc(o.ONE,r?o.ZERO:o.ONE_MINUS_SRC_ALPHA),o.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.drawElements=function(t,e){var r=this.getGL(),o=r.UNSIGNED_INT,i=e-t,a=4*t;r.drawElements(r.TRIANGLES,i,o,a)},e.prototype.finalizeDraw=function(t){for(var e=0;e<this.postProcessPasses_.length;e++)this.postProcessPasses_[e].apply(t,this.postProcessPasses_[e+1]||null)},e.prototype.getCanvas=function(){return this.canvas_},e.prototype.getGL=function(){return this.gl_},e.prototype.applyFrameState=function(t){var e=t.size,r=t.viewState.rotation,o=wd(this.offsetScaleMatrix_);Ae(o,2/e[0],2/e[1]);var i=wd(this.offsetRotateMatrix_);0!==r&&Ao(i,-r),this.setUniformMatrixValue(Pc.OFFSET_SCALE_MATRIX,Bj(this.tmpMat4_,o)),this.setUniformMatrixValue(Pc.OFFSET_ROTATION_MATRIX,Bj(this.tmpMat4_,i)),this.setUniformFloatValue(Pc.TIME,.001*(Date.now()-this.startTime_)),this.setUniformFloatValue(Pc.ZOOM,t.viewState.zoom),this.setUniformFloatValue(Pc.RESOLUTION,t.viewState.resolution)},e.prototype.applyUniforms=function(t){var e,r=this.getGL(),o=0;this.uniforms_.forEach(function(i){if((e="function"==typeof i.value?i.value(t):i.value)instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof ImageData)i.texture||(i.prevValue=void 0,i.texture=r.createTexture()),r.activeTexture(r["TEXTURE"+o]),r.bindTexture(r.TEXTURE_2D,i.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),(!(e instanceof HTMLImageElement)||e.complete)&&i.prevValue!==e&&(i.prevValue=e,r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e)),r.uniform1i(this.getUniformLocation(i.name),o++);else if(Array.isArray(e)&&6===e.length)this.setUniformMatrixValue(i.name,Bj(this.tmpMat4_,e));else if(Array.isArray(e)&&e.length<=4)switch(e.length){case 2:return void r.uniform2f(this.getUniformLocation(i.name),e[0],e[1]);case 3:return void r.uniform3f(this.getUniformLocation(i.name),e[0],e[1],e[2]);case 4:return void r.uniform4f(this.getUniformLocation(i.name),e[0],e[1],e[2],e[3]);default:return;}else"number"==typeof e&&r.uniform1f(this.getUniformLocation(i.name),e)}.bind(this))},e.prototype.useProgram=function(t){return t!=this.currentProgram_&&(this.getGL().useProgram(t),this.currentProgram_=t,this.uniformLocations_={},this.attribLocations_={},!0)},e.prototype.compileShader=function(t,e){var r=this.getGL(),o=r.createShader(e);return r.shaderSource(o,t),r.compileShader(o),o},e.prototype.getProgram=function(t,e){var r=this.getGL(),o=this.compileShader(t,r.FRAGMENT_SHADER),i=this.compileShader(e,r.VERTEX_SHADER);this.shaderCompileErrors_=null,r.getShaderInfoLog(o)&&(this.shaderCompileErrors_="Fragment shader compilation failed:\n"+r.getShaderInfoLog(o)),r.getShaderInfoLog(i)&&(this.shaderCompileErrors_=(this.shaderCompileErrors_||"")+"Vertex shader compilation failed:\n"+r.getShaderInfoLog(i));var a=r.createProgram();return r.attachShader(a,o),r.attachShader(a,i),r.linkProgram(a),a},e.prototype.getShaderCompileErrors=function(){return this.shaderCompileErrors_},e.prototype.getUniformLocation=function(t){return void 0===this.uniformLocations_[t]&&(this.uniformLocations_[t]=this.getGL().getUniformLocation(this.currentProgram_,t)),this.uniformLocations_[t]},e.prototype.getAttributeLocation=function(t){return void 0===this.attribLocations_[t]&&(this.attribLocations_[t]=this.getGL().getAttribLocation(this.currentProgram_,t)),this.attribLocations_[t]},e.prototype.makeProjectionTransform=function(t,e){var r=t.size,o=t.viewState.rotation,i=t.viewState.resolution,a=t.viewState.center;return wd(e),Ya(e,0,0,2/(i*r[0]),2/(i*r[1]),-o,-a[0],-a[1]),e},e.prototype.setUniformFloatValue=function(t,e){this.getGL().uniform1f(this.getUniformLocation(t),e)},e.prototype.setUniformMatrixValue=function(t,e){this.getGL().uniformMatrix4fv(this.getUniformLocation(t),!1,e)},e.prototype.enableAttributeArray_=function(t,e,r,o,i){var a=this.getAttributeLocation(t);a<0||(this.getGL().enableVertexAttribArray(a),this.getGL().vertexAttribPointer(a,e,r,!1,o,i))},e.prototype.enableAttributes=function(t){for(var e=zn(t),r=0,o=0;o<t.length;o++){var i=t[o];this.enableAttributeArray_(i.name,i.size,i.type||tn,e,r),r+=i.size*An(i.type)}},e.prototype.handleWebGLContextLost=function(){Sb(this.bufferCache_),this.currentProgram_=null},e.prototype.handleWebGLContextRestored=function(){},e.prototype.createTexture=function(t,e,r){var o=this.getGL(),i=r||o.createTexture(),a=o.RGBA,n=o.RGBA,s=o.UNSIGNED_BYTE;return o.bindTexture(o.TEXTURE_2D,i),e?o.texImage2D(o.TEXTURE_2D,0,a,n,s,e):o.texImage2D(o.TEXTURE_2D,0,a,t[0],t[1],0,n,s,null),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),i},e}(fe);function zn(t){for(var e=0,r=0;r<t.length;r++){var o=t[r];e+=o.size*An(o.type)}return e}function An(t){switch(t){case jb.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case jb.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case jb.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case jb.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT;}}Oc.computeAttributesStride=zn,Oc.default=yn;var mc={};var yu=mc&&mc.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function o(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),cg={GENERATE_BUFFERS:"GENERATE_BUFFERS"};mc.WebGLWorkerMessageType=cg;var Bn=function(e){function r(r,t){var o=e.call(this,r)||this,n=t||{};return o.helper=new yn({postProcesses:n.postProcesses,uniforms:n.uniforms}),o}return yu(r,e),r.prototype.disposeInternal=function(){this.helper.dispose(),e.prototype.disposeInternal.call(this)},r.prototype.getShaderCompileErrors=function(){return this.helper.getShaderCompileErrors()},r}(Pg),zu=[],Cj={vertexPosition:0,indexPosition:0};function dg(e,r,t,o,n){e[r+0]=t,e[r+1]=o,e[r+2]=n}function Au(e,r,t,o,n,$){var a=3+n,x=e[r+0],i=e[r+1],s=zu;s.length=n;for(var p=0;p<s.length;p++)s[p]=e[r+2+p];var u=$?$.vertexPosition:0,c=$?$.indexPosition:0,f=u/a;return dg(t,u,x,i,0),s.length&&t.set(s,u+3),dg(t,u+=a,x,i,1),s.length&&t.set(s,u+3),dg(t,u+=a,x,i,2),s.length&&t.set(s,u+3),dg(t,u+=a,x,i,3),s.length&&t.set(s,u+3),u+=a,o[c++]=f,o[c++]=f+1,o[c++]=f+3,o[c++]=f+1,o[c++]=f+2,o[c++]=f+3,Cj.vertexPosition=u,Cj.indexPosition=c,Cj}function Bu(){var e=document.createElement("canvas").getContext("2d").createImageData(1,1);return e.data[0]=255,e.data[1]=255,e.data[2]=255,e.data[3]=255,e}function Cn(e,r){var t=r||[];return t[0]=Math.floor(e/256/256/256)/255,t[1]=Math.floor(e/256/256)%256/255,t[2]=Math.floor(e/256)%256/255,t[3]=e%256/255,t}function Dn(e){var r=0;return r+=Math.round(256*e[0]*256*256*255),r+=Math.round(256*e[1]*256*255),r+=Math.round(256*e[2]*255),r+=Math.round(255*e[3])}mc.writePointFeatureToBuffers=Au,mc.getBlankImageData=Bu,mc.colorEncodeId=Cn,mc.colorDecodeId=Dn,mc.default=Bn;var Cu="var e=\"function\"==typeof Object.assign?Object.assign:function(e,n){if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");for(var t=Object(e),r=1,o=arguments.length;r<o;++r){var i=arguments[r];if(null!=i)for(var f in i)i.hasOwnProperty(f)&&(t[f]=i[f])}return t},n=\"GENERATE_BUFFERS\",t=[],r={vertexPosition:0,indexPosition:0};function o(e,n,t,r,o){e[n+0]=t,e[n+1]=r,e[n+2]=o}function i(e,n,i,f,s,u){var a=3+s,l=e[n+0],v=e[n+1],c=t;c.length=s;for(var g=0;g<c.length;g++)c[g]=e[n+2+g];var b=u?u.vertexPosition:0,h=u?u.indexPosition:0,d=b/a;return o(i,b,l,v,0),c.length&&i.set(c,b+3),o(i,b+=a,l,v,1),c.length&&i.set(c,b+3),o(i,b+=a,l,v,2),c.length&&i.set(c,b+3),o(i,b+=a,l,v,3),c.length&&i.set(c,b+3),b+=a,f[h++]=d,f[h++]=d+1,f[h++]=d+3,f[h++]=d+1,f[h++]=d+2,f[h++]=d+3,r.vertexPosition=b,r.indexPosition=h,r}var f=self;f.onmessage=function(t){var r=t.data;if(r.type===n){for(var o=r.customAttributesCount,s=2+o,u=new Float32Array(r.renderInstructions),a=u.length/s,l=4*a*(o+3),v=new Uint32Array(6*a),c=new Float32Array(l),g=null,b=0;b<u.length;b+=s)g=i(u,b,c,v,o,g);var h=e({vertexBuffer:c.buffer,indexBuffer:v.buffer,renderInstructions:u.buffer},r);f.postMessage(h,[c.buffer,v.buffer,u.buffer])}};",Du=new Blob([Cu],{type:"application/javascript"}),Eu=URL.createObjectURL(Du);function Fu(){return new Worker(Eu)}var Bb=new Uint8Array(4),Gu=function(){function t(t,r){this.helper_=t;var e=t.getGL();this.texture_=e.createTexture(),this.framebuffer_=e.createFramebuffer(),this.size_=r||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}return t.prototype.setSize=function(t){Vb(t,this.size_)||(this.size_[0]=t[0],this.size_[1]=t[1],this.updateSize_())},t.prototype.getSize=function(){return this.size_},t.prototype.clearCachedData=function(){this.dataCacheDirty_=!0},t.prototype.readAll=function(){if(this.dataCacheDirty_){var t=this.size_,r=this.helper_.getGL();r.bindFramebuffer(r.FRAMEBUFFER,this.framebuffer_),r.readPixels(0,0,t[0],t[1],r.RGBA,r.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_},t.prototype.readPixel=function(t,r){if(t<0||r<0||t>this.size_[0]||r>=this.size_[1])return Bb[0]=0,Bb[1]=0,Bb[2]=0,Bb[3]=0,Bb;this.readAll();var e=Math.floor(t)+(this.size_[1]-Math.floor(r)-1)*this.size_[0];return Bb[0]=this.data_[4*e],Bb[1]=this.data_[4*e+1],Bb[2]=this.data_[4*e+2],Bb[3]=this.data_[4*e+3],Bb},t.prototype.getTexture=function(){return this.texture_},t.prototype.getFramebuffer=function(){return this.framebuffer_},t.prototype.updateSize_=function(){var t=this.size_,r=this.helper_.getGL();this.texture_=this.helper_.createTexture(t,null,this.texture_),r.bindFramebuffer(r.FRAMEBUFFER,this.framebuffer_),r.viewport(0,0,t[0],t[1]),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,this.texture_,0),this.data_=new Uint8Array(t[0]*t[1]*4)},t}();var Hu=xj&&xj.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),En=function(e){function t(t,r){var i=this,s=r.uniforms||{},n=Fa();s[Pc.PROJECTION_MATRIX]=n,(i=e.call(this,t,{uniforms:s,postProcesses:r.postProcesses})||this).sourceRevision_=-1,i.verticesBuffer_=new zj(_f,ag),i.hitVerticesBuffer_=new zj(_f,ag),i.indicesBuffer_=new zj(yj,ag),i.program_=i.helper.getProgram(r.fragmentShader,r.vertexShader),i.hitDetectionEnabled_=!(!r.hitFragmentShader||!r.hitVertexShader),i.hitProgram_=i.hitDetectionEnabled_&&i.helper.getProgram(r.hitFragmentShader,r.hitVertexShader);var o=r.attributes?r.attributes.map(function(e){return{name:"a_"+e.name,size:1,type:jb.FLOAT}}):[];i.attributes=[{name:"a_position",size:2,type:jb.FLOAT},{name:"a_index",size:1,type:jb.FLOAT}].concat(o),i.hitDetectionAttributes=[{name:"a_position",size:2,type:jb.FLOAT},{name:"a_index",size:1,type:jb.FLOAT},{name:"a_hitColor",size:4,type:jb.FLOAT},{name:"a_featureUid",size:1,type:jb.FLOAT}].concat(o),i.customAttributes=r.attributes?r.attributes:[],i.previousExtent_=Ha(),i.currentTransform_=n,i.renderTransform_=Fa(),i.invertRenderTransform_=Fa(),i.renderInstructions_=new Float32Array(0),i.hitRenderInstructions_=new Float32Array(0),i.hitRenderTarget_=i.hitDetectionEnabled_&&new Gu(i.helper),i.worker_=Fu(),i.worker_.addEventListener("message",function(e){var t=e.data;if(t.type===cg.GENERATE_BUFFERS){var r=t.projectionTransform;t.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(t.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=r,yd(this.invertRenderTransform_,this.renderTransform_),t.hitDetection?this.hitRenderInstructions_=new Float32Array(e.data.renderInstructions):this.renderInstructions_=new Float32Array(e.data.renderInstructions),this.getLayer().changed()}}.bind(i)),i.featureCache_={},i.featureCount_=0;var a=i.getLayer().getSource();return i.sourceListenKeys_=[fa(a,Sa.ADDFEATURE,i.handleSourceFeatureAdded_,i),fa(a,Sa.CHANGEFEATURE,i.handleSourceFeatureChanged_,i),fa(a,Sa.REMOVEFEATURE,i.handleSourceFeatureDelete_,i),fa(a,Sa.CLEAR,i.handleSourceFeatureClear_,i)],a.forEachFeature(function(e){this.featureCache_[da(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++}.bind(i)),i}return Hu(t,e),t.prototype.handleSourceFeatureAdded_=function(e){var t=e.feature;this.featureCache_[da(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()},this.featureCount_++},t.prototype.handleSourceFeatureChanged_=function(e){var t=e.feature;this.featureCache_[da(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()}},t.prototype.handleSourceFeatureDelete_=function(e){var t=e.feature;delete this.featureCache_[da(t)],this.featureCount_--},t.prototype.handleSourceFeatureClear_=function(){this.featureCache_={},this.featureCount_=0},t.prototype.renderFrame=function(e){var t=this.indicesBuffer_.getSize();this.helper.drawElements(0,t),this.helper.finalizeDraw(e);var r=this.helper.getCanvas(),i=e.layerStatesArray[e.layerIndex].opacity;return i!==parseFloat(r.style.opacity)&&(r.style.opacity=i),this.hitDetectionEnabled_&&(this.renderHitDetection(e),this.hitRenderTarget_.clearCachedData()),r},t.prototype.prepareFrame=function(e){var t=this.getLayer(),r=t.getSource(),i=e.viewState,s=!e.viewHints[qa.ANIMATING]&&!e.viewHints[qa.INTERACTING],n=!eb(this.previousExtent_,e.extent),o=this.sourceRevision_<r.getRevision();if(o&&(this.sourceRevision_=r.getRevision()),s&&(n||o)){var a=i.projection,c=i.resolution,u=t instanceof Qd?t.getRenderBuffer():0,h=db(e.extent,u*c);r.loadFeatures(h,c,a),this.rebuildBuffers_(e),this.previousExtent_=e.extent.slice()}return this.helper.makeProjectionTransform(e,this.currentTransform_),bd(this.currentTransform_,this.invertRenderTransform_),this.helper.useProgram(this.program_),this.helper.prepareDraw(e),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0},t.prototype.rebuildBuffers_=function(e){var t=Fa();this.helper.makeProjectionTransform(e,t);var r,i,s=(2+this.customAttributes.length)*this.featureCount_;if(this.renderInstructions_&&this.renderInstructions_.length===s||(this.renderInstructions_=new Float32Array(s)),this.hitDetectionEnabled_){var n=(7+this.customAttributes.length)*this.featureCount_;this.hitRenderInstructions_&&this.hitRenderInstructions_.length===n||(this.hitRenderInstructions_=new Float32Array(n))}var o,a=[],c=[],u=0,h=0;for(var m in this.featureCache_)if((i=(r=this.featureCache_[m]).geometry)&&i.getType()===aa.POINT){a[0]=i.getFlatCoordinates()[0],a[1]=i.getFlatCoordinates()[1],ta(t,a),o=Cn(h+6,c),this.renderInstructions_[u++]=a[0],this.renderInstructions_[u++]=a[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[h++]=a[0],this.hitRenderInstructions_[h++]=a[1],this.hitRenderInstructions_[h++]=o[0],this.hitRenderInstructions_[h++]=o[1],this.hitRenderInstructions_[h++]=o[2],this.hitRenderInstructions_[h++]=o[3],this.hitRenderInstructions_[h++]=Number(m));for(var $=void 0,p=0;p<this.customAttributes.length;p++)$=this.customAttributes[p].callback(r.feature,r.properties),this.renderInstructions_[u++]=$,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[h++]=$)}var f={type:cg.GENERATE_BUFFERS,renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};if(f.projectionTransform=t,this.worker_.postMessage(f,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_){var _={type:cg.GENERATE_BUFFERS,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length};_.projectionTransform=t,_.hitDetection=!0,this.worker_.postMessage(_,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null}},t.prototype.forEachFeatureAtCoordinate=function(e,t,r,i,s){if(ea(this.hitDetectionEnabled_,66),this.hitRenderInstructions_){var n=ta(t.coordinateToPixelTransform,e.slice()),o=this.hitRenderTarget_.readPixel(n[0]/2,n[1]/2),a=[o[0]/255,o[1]/255,o[2]/255,o[3]/255],c=Dn(a),u=this.hitRenderInstructions_[c],h=Math.floor(u).toString(),m=this.getLayer().getSource().getFeatureByUid(h);return m?i(m,this.getLayer()):void 0}},t.prototype.renderHitDetection=function(e){if(this.hitVerticesBuffer_.getSize()){this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.useProgram(this.hitProgram_),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes);var t=this.indicesBuffer_.getSize();this.helper.drawElements(0,t)}},t.prototype.disposeInternal=function(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach(function(e){ra(e)}),this.sourceListenKeys_=null,e.prototype.disposeInternal.call(this)},t}(Bn);xj.default=En;var Iu=wj&&wj.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),sb={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},Ju=["#00f","#0ff","#0f0","#ff0","#f00"],Ku=function(t){function e(e){var r=this,n=e||{},o=ha({},n);delete o.gradient,delete o.radius,delete o.blur,delete o.weight,(r=t.call(this,o)||this).gradient_=null,r.addEventListener(xa(sb.GRADIENT),r.handleGradientChanged_),r.setGradient(n.gradient?n.gradient:Ju),r.setBlur(void 0!==n.blur?n.blur:15),r.setRadius(void 0!==n.radius?n.radius:8);var i=n.weight?n.weight:"weight";return r.weightFunction_="string"==typeof i?function(t){return t.get(i)}:i,r.setRenderOrder(null),r}return Iu(e,t),e.prototype.getBlur=function(){return this.get(sb.BLUR)},e.prototype.getGradient=function(){return this.get(sb.GRADIENT)},e.prototype.getRadius=function(){return this.get(sb.RADIUS)},e.prototype.handleGradientChanged_=function(){this.gradient_=Lu(this.getGradient())},e.prototype.setBlur=function(t){this.set(sb.BLUR,t)},e.prototype.setGradient=function(t){this.set(sb.GRADIENT,t)},e.prototype.setRadius=function(t){this.set(sb.RADIUS,t)},e.prototype.createRenderer=function(){return new En(this,{attributes:[{name:"weight",callback:function(t){var e=this.weightFunction_(t);return void 0!==e?ja(e,0,1):1}.bind(this)}],vertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_weight = a_weight;\n        }",fragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          gl_FragColor = vec4(alpha, alpha, alpha, alpha);\n        }",hitVertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n        attribute vec4 a_hitColor;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_hitColor = a_hitColor;\n          v_weight = a_weight;\n        }",hitFragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          if (alpha < 0.05) {\n            discard;\n          }\n\n          gl_FragColor = v_hitColor;\n        }",uniforms:{u_size:function(){return 2*(this.get(sb.RADIUS)+this.get(sb.BLUR))}.bind(this),u_blurSlope:function(){return this.get(sb.RADIUS)/Math.max(1,this.get(sb.BLUR))}.bind(this)},postProcesses:[{fragmentShader:"\n            precision mediump float;\n\n            uniform sampler2D u_image;\n            uniform sampler2D u_gradientTexture;\n\n            varying vec2 v_texCoord;\n\n            void main() {\n              vec4 color = texture2D(u_image, v_texCoord);\n              gl_FragColor.a = color.a;\n              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;\n              gl_FragColor.rgb *= gl_FragColor.a;\n            }",uniforms:{u_gradientTexture:function(){return this.gradient_}.bind(this)}}]})},e}(fc);function Lu(t){for(var e=Ea(1,256),r=e.createLinearGradient(0,0,1,256),n=1/(t.length-1),o=0,i=t.length;o<i;++o)r.addColorStop(o*n,t[o]);return e.fillStyle=r,e.fillRect(0,0,1,256),e.canvas}wj.default=Ku;var Dj={};var Ej={};var Mu=Ej&&Ej.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function o(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),Fn=function(e){function r(r){var t=e.call(this,r)||this;return t.vectorRenderer_=new wi(r),t.layerImageRatio_=r.getImageRatio(),t.coordinateToVectorPixelTransform_=Fa(),t.renderedPixelToCoordinateTransform_=null,t}return Mu(r,e),r.prototype.disposeInternal=function(){this.vectorRenderer_.dispose(),e.prototype.disposeInternal.call(this)},r.prototype.getFeatures=function(e){if(this.vectorRenderer_){var r=ta(this.coordinateToVectorPixelTransform_,ta(this.renderedPixelToCoordinateTransform_,e.slice()));return this.vectorRenderer_.getFeatures(r)}return new Promise(function(e,r){e([])})},r.prototype.handleFontsChanged=function(){this.vectorRenderer_.handleFontsChanged()},r.prototype.prepareFrame=function(e){var r=e.pixelRatio,t=e.viewState,o=t.resolution,n=e.viewHints,i=this.vectorRenderer_,a=e.extent;1!==this.layerImageRatio_&&(a=a.slice(0),td(a,this.layerImageRatio_));var $=la(a)/o,s=va(a)/o;if(!n[qa.ANIMATING]&&!n[qa.INTERACTING]&&!wc(a)){i.useContainer(null,null,1);var p=i.context,c=ha({},e,{declutterItems:[],extent:a,size:[$,s],viewState:ha({},e.viewState,{rotation:0})}),l=new Of(a,o,r,p.canvas,function(e){i.prepareFrame(c)&&i.replayGroupChanged&&(i.renderFrame(c,null),ml(c,null),e())});l.addEventListener(ca.CHANGE,function(){l.getState()===ia.LOADED&&(this.image_=l)}.bind(this)),l.load()}if(this.image_){var u=this.image_,T=u.getResolution()*r/u.getPixelRatio();this.renderedResolution=T,this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice(),this.coordinateToVectorPixelTransform_=Ya(this.coordinateToVectorPixelTransform_,$/2,s/2,1/T,-1/T,0,-t.center[0],-t.center[1])}return!!this.image_},r.prototype.preRender=function(){},r.prototype.postRender=function(){},r.prototype.forEachFeatureAtCoordinate=function(r,t,o,n,i){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(r,t,o,n,i):e.prototype.forEachFeatureAtCoordinate.call(this,r,t,o,n,i)},r}(oj);Ej.default=Fn;var Nu=Dj&&Dj.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Ou=function(e){function t(t){var r=this,o=t||{},a=ha({},o);return delete a.imageRatio,(r=e.call(this,a)||this).imageRatio_=void 0!==o.imageRatio?o.imageRatio:1,r}return Nu(t,e),t.prototype.getImageRatio=function(){return this.imageRatio_},t.prototype.createRenderer=function(){return new Fn(this)},t}(Qd);Dj.default=Ou;var Fj={};var nc={IMAGE:"image",HYBRID:"hybrid",VECTOR:"vector"};var Gj={};var Pu=Gj&&Gj.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Qu={image:[ka.POLYGON,ka.CIRCLE,ka.LINE_STRING,ka.IMAGE,ka.TEXT],hybrid:[ka.POLYGON,ka.LINE_STRING],vector:[]},Ru={image:[ka.DEFAULT],hybrid:[ka.IMAGE,ka.TEXT,ka.DEFAULT],vector:[ka.POLYGON,ka.CIRCLE,ka.LINE_STRING,ka.IMAGE,ka.TEXT,ka.DEFAULT]},Gn=function(e){function t(t){var r=e.call(this,t)||this;return r.boundHandleStyleImageChange_=r.handleStyleImageChange_.bind(r),r.dirty_=!1,r.renderedLayerRevision_,r.renderedPixelToCoordinateTransform_=null,r.renderedRotation_,r.renderTileImageQueue_={},r.tileListenerKeys_={},r.tmpTransform_=Fa(),r}return Pu(t,e),t.prototype.prepareTile=function(e,t,r,i){var o,n=da(e),a=e.getState();return(a===ba.LOADED&&e.hifi||a===ba.ERROR)&&n in this.tileListenerKeys_&&(ra(this.tileListenerKeys_[n]),delete this.tileListenerKeys_[n]),a!==ba.LOADED&&a!==ba.ERROR||(this.updateExecutorGroup_(e,t,r),this.tileImageNeedsRender_(e,t,r)&&(o=!0,i&&(this.renderTileImageQueue_[n]=e))),o},t.prototype.getTile=function(t,r,i,o){var n=o.pixelRatio,a=o.viewState,$=a.resolution,l=a.projection,T=this.getLayer(),p=T.getSource().getTile(t,r,i,n,l);if(p.getState()<ba.LOADED){p.wantedResolution=$;var s=da(p);if(!(s in this.tileListenerKeys_)){var d=fa(p,ca.CHANGE,this.prepareTile.bind(this,p,n,l,!0));this.tileListenerKeys_[s]=d}}else{var u=o.viewHints;!!(u[qa.ANIMATING]||u[qa.INTERACTING])&&p.wantedResolution||(p.wantedResolution=$),this.prepareTile(p,n,l,!1)&&T.getRenderMode()!==nc.VECTOR&&this.renderTileImage_(p,o)}return e.prototype.getTile.call(this,t,r,i,o)},t.prototype.isDrawableTile=function(t){var r=this.getLayer();return e.prototype.isDrawableTile.call(this,t)&&r.getRenderMode()===nc.VECTOR||t.hasContext(r)},t.prototype.getTileImage=function(e){return e.getImage(this.getLayer())},t.prototype.prepareFrame=function(t){var r=this.getLayer().getRevision();return this.renderedLayerRevision_!=r&&(this.renderedTiles.length=0),this.renderedLayerRevision_=r,e.prototype.prepareFrame.call(this,t)},t.prototype.updateExecutorGroup_=function(e,t,r){var i=this.getLayer(),o=i.getRevision(),n=i.getRenderOrder()||null,a=e.wantedResolution,$=e.getReplayState(i);if($.dirty||$.renderedResolution!==a||$.renderedRevision!=o||$.renderedRenderOrder!=n||$.renderedZ!==e.sourceZ){var l=i.getSource(),T=l.getTileGrid(),p=l.getTileGridForProjection(r).getTileCoordExtent(e.wrappedTileCoord),s=l.getSourceTiles(t,r,e),d=da(i);delete e.hitDetectionImageData[d],e.executorGroups[d]=[];for(var u=function(r,o){var u=s[r];if(u.getState()!=ba.LOADED)return"continue";var c=u.tileCoord,g=T.getTileCoordExtent(c),m=vb(p,g),y=eb(g,m)?null:db(m,i.getRenderBuffer()*a,S.tmpExtent);$.dirty=!1;var h=new bm(0,m,a,t,i.getDeclutter()),U=Dh(a,t),v=function(e){var t,r=e.getStyleFunction()||i.getStyleFunction();if(r&&(t=r(e,a)),t){var o=this.renderFeature(e,U,t,h);this.dirty_=this.dirty_||o,$.dirty=$.dirty||o}},R=u.getFeatures();n&&n!==$.renderedRenderOrder&&R.sort(n);for(var f=0,_=R.length;f<_;++f){var E=R[f];y&&!ya(y,E.getGeometry().getExtent())||v.call(S,E)}var C=h.finish(),I=i.getRenderMode()!==nc.VECTOR&&i.getDeclutter()&&1===s.length?null:m,x=new cm(I,a,t,l.getOverlaps(),C,i.getRenderBuffer());e.executorGroups[d].push(x)},S=this,c=0,g=s.length;c<g;++c)u(c);$.renderedRevision=o,$.renderedZ=e.sourceZ,$.renderedRenderOrder=n,$.renderedResolution=a}},t.prototype.forEachFeatureAtCoordinate=function(e,t,r,i,o){var n=t.viewState.resolution,a=t.viewState.rotation;r=null==r?0:r;var $,l,T,p=this.getLayer(),s=p.getDeclutter(),d=p.getSource().getTileGridForProjection(t.viewState.projection),u={},S=this.renderedTiles,c=function(){var t=S[l],T=d.getTileCoordExtent(t.wrappedTileCoord),c=tc(T,e);if(!s&&!c)return"continue";for(var g=t.executorGroups[da(p)],m=0,y=g.length;m<y;++m){var h=g[m];$=$||h.forEachFeatureAtCoordinate(e,n,a,r,function(e){if(c||o&&-1!==o.indexOf(e)){var t=e.getId();if(void 0===t&&(t=da(e)),!(t in u))return u[t]=!0,i(e,p)}},p.getDeclutter()?o:null)}};for(l=0,T=S.length;l<T;++l)c();return $},t.prototype.getFeatures=function(e){return new Promise(function(t,r){for(var i,o=this.getLayer(),n=da(o),a=o.getSource(),$=this.renderedProjection,l=$.getExtent(),T=this.renderedResolution,p=a.getTileGridForProjection($),s=ta(this.renderedPixelToCoordinateTransform_,e.slice()),d=p.getTileCoordForCoordAndResolution(s,T),u=0,S=this.renderedTiles.length;u<S;++u)if(d.toString()===this.renderedTiles[u].tileCoord.toString()){if((i=this.renderedTiles[u]).getState()===ba.LOADED&&i.hifi){var c=p.getTileCoordExtent(i.tileCoord);a.getWrapX()&&$.canWrapX()&&!La(l,c)&&bh(s,$);break}i=void 0}if(!i||i.loadingSourceTiles>0)t([]);else{var g=p.getTileCoordExtent(i.wrappedTileCoord),m=fb(g),y=[(s[0]-m[0])/T,(m[1]-s[1])/T],h=i.getSourceTiles().reduce(function(e,t){return e.concat(t.getFeatures())},[]),U=i.hitDetectionImageData[n];if(!U&&!this.animatingOrInteracting_){var v=Oa(p.getTileSize(p.getZForResolution(T))),R=[v[0]/2,v[1]/2],f=this.renderedRotation_,_=[this.getRenderTransform(p.getTileCoordCenter(i.wrappedTileCoord),T,0,.5,R[0],R[1],0)];U=em(v,_,h,o.getStyleFunction(),p.getTileCoordExtent(i.wrappedTileCoord),i.getReplayState(o).renderedResolution,f),i.hitDetectionImageData[n]=U}t(fm(y,h,U))}}.bind(this))},t.prototype.handleFontsChanged=function(){Sb(this.renderTileImageQueue_);var e=this.getLayer();e.getVisible()&&void 0!==this.renderedLayerRevision_&&e.changed()},t.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},t.prototype.renderFrame=function(t,r){var i=t.viewHints,o=!(i[qa.ANIMATING]||i[qa.INTERACTING]);this.renderQueuedTileImages_(o,t),e.prototype.renderFrame.call(this,t,r),this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation;var n=this.getLayer(),a=n.getRenderMode();if(a===nc.IMAGE)return this.container;var $=n.getSource(),l=t.usedTiles[da($)];for(var T in this.renderTileImageQueue_)l&&T in l||delete this.renderTileImageQueue_[T];for(var p=this.context,s=n.getDeclutter()?{}:null,d=Ru[a],u=t.pixelRatio,S=t.viewState,c=S.center,g=S.resolution,m=S.rotation,y=t.size,h=Math.round(y[0]*u),U=Math.round(y[1]*u),v=this.renderedTiles,R=$.getTileGridForProjection(t.viewState.projection),f=[],_=[],E=v.length-1;E>=0;--E)for(var C=v[E],I=C.tileCoord,x=R.getTileCoordExtent(C.wrappedTileCoord),L=R.getTileCoordExtent(I,this.tmpExtent)[0]-x[0],w=bd(Ae(this.inversePixelTransform.slice(),1/u,1/u),this.getRenderTransform(c,g,m,u,h,U,L)),G=C.executorGroups[da(n)],A=!1,D=0,j=G.length;D<j;++D){var O=G[D];if(O.hasExecutors(d)){var F=C.tileCoord[0],P=void 0;if(!s&&!A){P=O.getClipCoords(w),p.save();for(var N=0,b=f.length;N<b;++N){var q=f[N];F<_[N]&&(p.beginPath(),p.moveTo(P[0],P[1]),p.lineTo(P[2],P[3]),p.lineTo(P[4],P[5]),p.lineTo(P[6],P[7]),p.moveTo(q[6],q[7]),p.lineTo(q[4],q[5]),p.lineTo(q[2],q[3]),p.lineTo(q[0],q[1]),p.clip())}}O.execute(p,w,m,o,d,s),s||A||(p.restore(),f.push(P),_.push(F),A=!0)}}if(s){var V=t.layerStatesArray[t.layerIndex];dm(s,p,m,V.opacity,o,t.declutterItems)}return this.container},t.prototype.renderQueuedTileImages_=function(e,t){for(var r in this.renderTileImageQueue_){if(!e&&Date.now()-t.time>8){t.animate=!0;break}var i=this.renderTileImageQueue_[r];delete this.renderTileImageQueue_[r],this.renderTileImage_(i,t)}},t.prototype.renderFeature=function(e,t,r,i){if(!r)return!1;var o=!1;if(Array.isArray(r))for(var n=0,a=r.length;n<a;++n)o=df(i,e,r[n],t,this.boundHandleStyleImageChange_)||o;else o=df(i,e,r,t,this.boundHandleStyleImageChange_);return o},t.prototype.tileImageNeedsRender_=function(e,t,r){var i=this.getLayer(),o=e.getReplayState(i),n=i.getRevision(),a=e.sourceZ,$=e.wantedResolution;return o.renderedTileResolution!==$||o.renderedTileRevision!==n||o.renderedTileZ!==a},t.prototype.renderTileImage_=function(e,t){var r=this.getLayer(),i=e.getReplayState(r),o=r.getRevision(),n=e.executorGroups[da(r)];i.renderedTileRevision=o,i.renderedTileZ=e.sourceZ;var a=e.wrappedTileCoord,$=a[0],l=r.getSource(),T=t.pixelRatio,p=t.viewState.projection,s=l.getTileGridForProjection(p),d=s.getResolution(e.tileCoord[0]),u=t.pixelRatio/e.wantedResolution*d,S=s.getResolution($),c=e.getContext(r);T=Math.max(T,u/T);var g=l.getTilePixelSize($,T,p);c.canvas.width=g[0],c.canvas.height=g[1];var m=T/u;if(1!==m){var y=wd(this.tmpTransform_);Ae(y,m,m),c.setTransform.apply(c,y)}var h=s.getTileCoordExtent(a,this.tmpExtent),U=u/S,v=wd(this.tmpTransform_);Ae(v,U,-U),Co(v,-h[0],-h[3]);for(var R=0,f=n.length;R<f;++R){n[R].execute(c,v,0,!0,Qu[r.getRenderMode()])}i.renderedTileResolution=e.wantedResolution},t}(Dd);Gj.default=Gn;var Su=Fj&&Fj.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function o(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),Tu=function(e){function r(r){var t=this,o=r||{},n=ha({},o);delete n.preload,delete n.useInterimTilesOnError,t=e.call(this,n)||this;var i=o.renderMode||nc.HYBRID;return ea(null==i||i==nc.IMAGE||i==nc.HYBRID||i==nc.VECTOR,28),t.renderMode_=i,t.setPreload(o.preload?o.preload:0),t.setUseInterimTilesOnError(void 0===o.useInterimTilesOnError||o.useInterimTilesOnError),t}return Su(r,e),r.prototype.createRenderer=function(){return new Gn(this)},r.prototype.getFeatures=function(r){return e.prototype.getFeatures.call(this,r)},r.prototype.getRenderMode=function(){return this.renderMode_},r.prototype.getPreload=function(){return this.get(Xb.PRELOAD)},r.prototype.getUseInterimTilesOnError=function(){return this.get(Xb.USE_INTERIM_TILES_ON_ERROR)},r.prototype.setPreload=function(e){this.set(Xb.PRELOAD,e)},r.prototype.setUseInterimTilesOnError=function(e){this.set(Xb.USE_INTERIM_TILES_ON_ERROR,e)},r}(Qd);Fj.default=Tu;var Uu=function(){function t(){}return t.getDrop=function(t){var e={width:t&&t.width||25,height:t&&t.height||35,smallCircleFill:t&&t.smallCircleFill||"green",colorBackground:t&&t.colorBackground||"green",colorStrokeWhite:t&&t.colorStrokeWhite||"white",bigCircleFill:t&&t.bigCircleFill||"white",colorBlack:t&&t.colorBlack||"black",text:t&&t.text||void 0,textColor:t&&t.textColor||"white"},i=e.width/2,r=Math.round(.4*e.width),l=Math.round(.33*e.width),h=Math.round(.8*e.width),o=Math.round(.4*e.width),c="<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\""+e.width+"px\" height=\""+e.height+"px\" viewBox=\"0 0 "+e.width+" "+e.height+"\" enable-background=\"0 0 "+e.width+" "+e.height+"\" xml:space=\"preserve\">";if(c+="<path  stroke=\""+e.colorStrokeWhite+"\" stroke-width=\"1\" fill=\""+e.colorBackground+"\" d=\"M0 "+i+" A "+i+" "+i+" 0 0 1 "+i+" 0 A "+i+" "+i+" 0 0 1 "+e.width+" "+i+" C "+e.width+" "+h+", "+(e.width-o)+" "+e.height+", "+i+" "+e.height+" C "+o+" "+e.height+", 0 "+h+", 0 "+i+"\" />",c+="<circle cx=\""+i+"\" cy=\""+i+"\" r=\""+r+"\"  fill=\""+e.bigCircleFill+"\" />",c+="<circle cx=\""+i+"\" cy=\""+i+"\" r=\""+l+"\"  fill=\""+e.smallCircleFill+"\" />",e.text&&"string"==typeof e.text&&e.text.length>0){var g=2*l*.7/e.text.length,w=1.549186676994578*g,n=(e.text.length,e.width/2+w/1.688404879490102/2);c+="<style>  ",c+=".captionStyle { font: "+w+"px Courier New; font-weight:bold }  ",c+="</style>  ",c+="<text class=\"captionStyle\"  x=\""+(e.width/2-g*e.text.length/2)+"\" y=\""+n+"\" fill=\""+e.textColor+"\">"+e.text+"</text>"}c+="</svg>";var d=new Image;return d.src="data:image/svg+xml,"+escape(c),{image:d,width:e.width,height:e.height}},t.getCircleDrop=function(t){var e={width:t&&t.width||25,height:t&&t.height||25,colorCircle:t&&t.colorCircle||"green",colorBackground:t&&t.colorBackground||"white"},i=e.width/2,r=Math.round(.45*e.width),l=Math.round(.3*e.width),h="<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\""+e.width+"px\" height=\""+e.height+"px\" viewBox=\"0 0 "+e.width+" "+e.height+"\" enable-background=\"0 0 "+e.width+" "+e.height+"\" xml:space=\"preserve\">";h+="<circle cx=\""+i+"\" cy=\""+i+"\" r=\""+r+"\"    fill=\""+e.colorBackground+"\" stroke=\""+e.colorCircle+"\" stroke-width=\"1.5\"/>",h+="<circle cx=\""+i+"\" cy=\""+i+"\" r=\""+l+"\"  fill=\""+e.colorCircle+"\" />",h+="</svg>";var o=new Image;return o.src="data:image/svg+xml,"+escape(h),{image:o,width:e.width,height:e.height}},t}();var Vu=function(){function e(){var e=this;this.LOCAL_STORAGE_GREY_MAP_KEY="LOCAL_STORAGE_GREY_MAP_KEY_",this.greyMapStetNumber=0,this.activeTiles=0,this.layerTile=new ik,this.mapBoxTileSource=new rb({url:"https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1Ijoia29sZXNvMyIsImEiOiJjazJ4dXg5YjQwMWJ3M2pqdmJxM2Mxd2NxIn0.l-fJ_VfcvdAFWgZDBIIpSA"}),this.osmTileSource=new Nm,this.mapyCzSource=new rb({url:"https://mapserver.mapy.cz/base-m/{z}-{x}-{y}"}),this.mapyCzAreal1Source=new rb({url:"https://mapserver.mapy.cz/bing/{z}-{x}-{y}"}),this.mapyCzAreal2Source=new rb({url:"https://mapserver.mapy.cz/ophoto1415-m/{z}-{x}-{y}"}),this.mapyCzAreal3Source=new rb({url:"https://mapserver.mapy.cz/ophoto1012-m/{z}-{x}-{y}"}),this.tileSources=[this.mapyCzAreal1Source,this.mapyCzAreal2Source,this.mapyCzAreal3Source,this.osmTileSource,this.mapBoxTileSource],this.createFitMarkersControlElement=function(){var t=document.createElement("button");t.innerHTML="\u2699";var r=document.createElement("div");return r.className=" ol-unselectable ol-control ",r.style.cssText="    top: 4em; left: .5em;",r.appendChild(t),t.addEventListener("click",function(){e.zoomToAllMarkers()},!1),r},this.createGreySwitchControlElement=function(){var t=document.createElement("button");t.innerHTML="\u2601";var r=document.createElement("div");return r.className=" ol-unselectable ol-control ",r.style.cssText="    top: 6em; left: .5em;",r.appendChild(t),t.addEventListener("click",function(){e.greyMapStetNumber=e.greyMapStetNumber+1,e.greyMapStetNumber>2&&(e.greyMapStetNumber=0),e.setGreyMap(e.greyMapStetNumber),e.olmap.render()},!1),r},this.createChangeTilesControlElement=function(){var t=document.createElement("button");t.innerHTML="T";var r=document.createElement("div");return r.className=" ol-unselectable ol-control ",r.style.cssText="    top: 6em; left: .5em;",r.appendChild(t),t.addEventListener("click",function(){e.activeTiles++,e.activeTiles>=e.tileSources.length&&(e.activeTiles=0),e.layerTile.setSource(e.tileSources[e.activeTiles]),e.olmap.render()},!1),r},this.addTooltipOverFeature=function(){var t=document.createElement("div");t.style.cssText="background:white; padding:5px",t.id="tooltipDiv";var r=new Fh({element:t,offset:[10,0],positioning:"bottom-left"});e.olmap.addOverlay(r);return e.olmap.on("pointermove",function(o){var i=o.pixel,a=e.olmap.forEachFeatureAtPixel(i,function(e){return e}),l=a&&a.get("tooltip");t.style.display=a&&l?"":"none",a&&l&&(r.setPosition(o.coordinate),t.innerHTML=l)}),e.olmap},this.postcomposeHandlerToMakeMapGrey=function(t){t.context.globalCompositeOperation="color",1==e.greyMapStetNumber&&(t.context.fillStyle="#00000099"),2==e.greyMapStetNumber&&(t.context.fillStyle="#888"),t.context.fillRect(0,0,t.context.canvas.width,t.context.canvas.height),t.context.globalCompositeOperation="source-over"},this.existFeatureInMap=function(t){return e.markersSourceVector.getFeatures().some(function(e){return e==t})},this.removeFeatureIfExists=function(t){t&&e.existFeatureInMap(t)&&e.markersSourceVector.removeFeature(t)}}return e.prototype.init=function(e){this.options={defaultLon:e.defaultLon||0,defaultLat:e.defaultLat||0,defaultZoom:e.defaultZoom||10,localStorageKey:e.localStorageKey},this.LOCAL_STORAGE_GREY_MAP_KEY=this.options.localStorageKey&&this.LOCAL_STORAGE_GREY_MAP_KEY+this.options.localStorageKey||null;var t=je([this.options.defaultLon||0,this.options.defaultLat||0]);if(this.olmap=new zm({target:null,view:new Om({center:t,zoom:this.options.defaultZoom||10})}),this.layerTile.setSource(this.tileSources[0]),this.olmap.addLayer(this.layerTile),this.olmap.addControl(new _a({element:this.createFitMarkersControlElement()})),this.olmap.addControl(new _a({element:this.createGreySwitchControlElement()})),this.olmap.addControl(new _a({element:this.createChangeTilesControlElement()})),this.olmap.addControl(new dl),this.initMarkersLayer(),this.options.localStorageKey){var r=JSON.parse(localStorage.getItem(this.LOCAL_STORAGE_GREY_MAP_KEY));r&&this.setGreyMap(+r)}return this},e.prototype.initMarkersLayer=function(){this.markersSourceVector=new gc({features:[]});var e=new fc({source:this.markersSourceVector});this.olmap.addLayer(e)},e.prototype.createMarkerFeature=function(t,r,o){e.id++;var i=new Wa({id:e.id,geometry:new ab.Point(je([t,r])),tooltip:o}),a=Uu.getDrop();return i.setStyle(new pb({image:new vi({img:a.image,imgSize:[a.width,a.height],anchor:[.5,1]})})),this.markersSourceVector.addFeature(i),i},e.prototype.createAndAddPolygon=function(t,r){e.id++;var o={tooltip:r.tooltip,stroke:r.stroke||"red",fill:r.fill||"rgba(0, 0, 255, 0.1)"},i=t.map(function(e){return je([e.lon,e.lat])}),a=new Wa({id:e.id,geometry:new ab.Polygon([i]),tooltip:o.tooltip});return a.setStyle(new pb({stroke:new Nb({color:o.stroke,width:3}),fill:new bc({color:o.fill})})),this.markersSourceVector.addFeature(a),a},e.prototype.createAndAddPolyline=function(t,r){e.id++;var o={tooltip:r.tooltip,stroke:r.stroke||"red",fill:r.fill||"rgba(0, 0, 255, 0.1)"},i=t.map(function(e){return je([e.lon,e.lat])}),a=new Wa({id:e.id,geometry:new ab.LineString(i),tooltip:o.tooltip});return a.setStyle(new pb({stroke:new Nb({color:o.stroke,width:1}),fill:new bc({color:o.fill})})),this.markersSourceVector.addFeature(a),a},e.prototype.setGreyMap=function(e){var t=this.olmap.getLayers().getArray().find(function(e){return"TileLayer"==e.constructor.name});if(t){var r=0==e,o=e>0;this.greyMapStetNumber=e,o&&!this.isGreyMapTurnedOn&&(t.on("postrender",this.postcomposeHandlerToMakeMapGrey),this.isGreyMapTurnedOn=!0,this.olmap.render()),r&&this.isGreyMapTurnedOn&&(t.un("postrender",this.postcomposeHandlerToMakeMapGrey),this.isGreyMapTurnedOn=!1,this.olmap.render()),this.options.localStorageKey&&localStorage.setItem(this.LOCAL_STORAGE_GREY_MAP_KEY,JSON.stringify(e))}},e.prototype.zoomToAllMarkers=function(){if(this.markersSourceVector.getFeatures().length>1&&this.olmap.getView().fit(this.markersSourceVector.getExtent(),{padding:[100,100,100,100]}),1==this.markersSourceVector.getFeatures().length){var e=this.markersSourceVector.getFeatures()[0].getGeometry().getCoordinates(),t=this.olmap.getView().getZoom();this.olmap.getView().setCenter(e),this.olmap.getView().setZoom(t)}},e.id=0,e}();var kb=new Vu;kb.init({defaultLat:48.23108264,defaultLon:19.17351113,defaultZoom:14,localStorageKey:"__LOCATIONS_MAP__"}).addTooltipOverFeature(),kb.olmap.setTarget("map");var Wu=function(){return[{lat:48.23108264,lon:19.17351113},{lat:48.23005343,lon:19.17278184},{lat:48.22982678,lon:19.17325726},{lat:48.22950054,lon:19.17345336},{lat:48.22997346,lon:19.17510116},{lat:48.23030072,lon:19.17497487},{lat:48.23062223,lon:19.17474326},{lat:48.23076795,lon:19.17446767},{lat:48.23108264,lon:19.17351113}]},Xu=function(){return[{lat:48.2312647,lon:19.1727615},{lat:48.23118699,lon:19.17156835},{lat:48.23121364,lon:19.1711375},{lat:48.23156718,lon:19.17098639},{lat:48.23183857,lon:19.17178511},{lat:48.2317699,lon:19.17246766},{lat:48.23131206,lon:19.17245928},{lat:48.2312647,lon:19.1727615}]},Yu=function(){return[{lat:48.22829448,lon:19.1766001},{lat:48.22845321,lon:19.17656726},{lat:48.22889103,lon:19.17593202},{lat:48.22917894,lon:19.17544228},{lat:48.22956241,lon:19.17529114},{lat:48.22992859,lon:19.17511842},{lat:48.22997346,lon:19.17510116},{lat:48.23030072,lon:19.17497487},{lat:48.23062223,lon:19.17474326},{lat:48.23076795,lon:19.17446767},{lat:48.23108264,lon:19.17351113},{lat:48.23110238,lon:19.17337963}]},Zu=function(){return[{lat:48.2312647,lon:19.1727615},{lat:48.23114395,lon:19.17353268},{lat:48.23113023,lon:19.17357443},{lat:48.23082101,lon:19.17451929},{lat:48.23066258,lon:19.17481869},{lat:48.23032243,lon:19.17506371},{lat:48.22994428,lon:19.17520955},{lat:48.22957971,lon:19.17538182},{lat:48.22921357,lon:19.17552618},{lat:48.22893662,lon:19.17599689},{lat:48.22848233,lon:19.17665636},{lat:48.22831413,lon:19.17669105}]},$u=function(){return[{lat:48.22829448,lon:19.1766001},{lat:48.22783725,lon:19.17448858},{lat:48.22826596,lon:19.17424361},{lat:48.22850289,lon:19.1743059},{lat:48.22886673,lon:19.17383446},{lat:48.22950054,lon:19.17345336},{lat:48.22997346,lon:19.17510116},{lat:48.22956241,lon:19.17529114},{lat:48.22917894,lon:19.17544228},{lat:48.22889103,lon:19.17593202},{lat:48.22845321,lon:19.17656726},{lat:48.22829448,lon:19.1766001}]},_u=function(){return[{lat:48.2290897416667,lon:19.1787564194444},{lat:48.2294474027778,lon:19.1784405166667},{lat:48.2296424333333,lon:19.1783193055556},{lat:48.2297602166667,lon:19.1783120694444},{lat:48.2317271805556,lon:19.1784732888889},{lat:48.2319448027778,lon:19.1785536694444},{lat:48.2325092916667,lon:19.1769505555556},{lat:48.2327520027778,lon:19.1762615555556},{lat:48.2328805,lon:19.1758964861111},{lat:48.2333572944444,lon:19.1752232527778},{lat:48.2326783194444,lon:19.1753314194444},{lat:48.2320636055556,lon:19.1749664944444},{lat:48.2319159777778,lon:19.1744396694444},{lat:48.2319843694444,lon:19.1740701916667},{lat:48.2321352444444,lon:19.1737893055556},{lat:48.2324102333333,lon:19.1733922027778},{lat:48.2324082027778,lon:19.1729701888889},{lat:48.2318727194444,lon:19.1718354583333},{lat:48.2317698972222,lon:19.1724676555556},{lat:48.2313120638889,lon:19.1724592833333},{lat:48.2312647,lon:19.1727615},{lat:48.2311439472222,lon:19.1735326833333},{lat:48.2311302305556,lon:19.1735744305556},{lat:48.2308210111111,lon:19.1745192944444},{lat:48.230662575,lon:19.1748186944444},{lat:48.2303224305556,lon:19.1750637138889},{lat:48.2299442833333,lon:19.1752095472222},{lat:48.2295797055556,lon:19.1753818166667},{lat:48.2292135694444,lon:19.1755261777778},{lat:48.2289366222222,lon:19.1759968888889},{lat:48.228482325,lon:19.1766563611111},{lat:48.2283141333333,lon:19.1766910527778},{lat:48.2287660222222,lon:19.1790492583333}]},av=function(){return[{lat:48.2157097583333,lon:19.1712339222222},{lat:48.2149499305556,lon:19.1714904666667},{lat:48.2143424388889,lon:19.1717527861111},{lat:48.2138598611111,lon:19.1719478194444},{lat:48.2135068138889,lon:19.1720777611111},{lat:48.213242475,lon:19.1721723638889},{lat:48.2130023722222,lon:19.1722574},{lat:48.2131521444444,lon:19.1725283527778},{lat:48.2132322805556,lon:19.1726587277778},{lat:48.2134776333333,lon:19.17305875},{lat:48.2135795111111,lon:19.1732293583333},{lat:48.2136458611111,lon:19.1734402},{lat:48.2140502444444,lon:19.1732960805556},{lat:48.214086275,lon:19.1732842611111},{lat:48.2144257194444,lon:19.1731691944444},{lat:48.2146425527778,lon:19.173075},{lat:48.2147793583333,lon:19.1730220583333},{lat:48.2150782305556,lon:19.1729090555556},{lat:48.2152674305556,lon:19.1728687916667},{lat:48.2155704166667,lon:19.17276235},{lat:48.2158015472222,lon:19.1726837027778},{lat:48.2159243944444,lon:19.1726475527778},{lat:48.2157239861111,lon:19.1713154722222},{lat:48.2157097583333,lon:19.1712339222222}]},bv=function(){return[{lat:48.2136458611111,lon:19.1734402},{lat:48.2135795111111,lon:19.1732293583333},{lat:48.2134776333333,lon:19.17305875},{lat:48.2135036388889,lon:19.1730302305556},{lat:48.2136390638889,lon:19.1728801527778},{lat:48.2138571305556,lon:19.1726450805556},{lat:48.214086275,lon:19.1732842611111},{lat:48.2140502444444,lon:19.1732960805556},{lat:48.2137130333333,lon:19.1734071194444},{lat:48.2136458611111,lon:19.1734402}]},cv=function(){return[{lat:48.1913333138889,lon:19.1864381694444},{lat:48.1909721805556,lon:19.1870782666667},{lat:48.1908752888889,lon:19.1874720194444},{lat:48.1905874722222,lon:19.1877724833333},{lat:48.1903124666667,lon:19.1883233388889},{lat:48.1921355944444,lon:19.1851329166667},{lat:48.1923383444444,lon:19.1846714777778},{lat:48.1925448472222,lon:19.1842896027778},{lat:48.1927625861111,lon:19.1839891638889},{lat:48.19291005,lon:19.1837759361111},{lat:48.1929611416667,lon:19.1837020388889},{lat:48.1931902861111,lon:19.1840740694444},{lat:48.1930448194444,lon:19.1838824305556},{lat:48.1922759777778,lon:19.1853038055556},{lat:48.1918167166667,lon:19.1855822333333},{lat:48.1909167,lon:19.1876403527778},{lat:48.190683625,lon:19.1879061777778},{lat:48.1906617416667,lon:19.1888107722222},{lat:48.1907726361111,lon:19.1886640555556},{lat:48.1909327361111,lon:19.1884873555556},{lat:48.1910000305556,lon:19.1883543527778},{lat:48.1910493944444,lon:19.1881395722222},{lat:48.1911869333333,lon:19.1880027222222},{lat:48.1913747944444,lon:19.1876906388889},{lat:48.1915421472222,lon:19.1873796027778},{lat:48.1919846277778,lon:19.1859927277778}]};kb.createAndAddPolygon(Wu(),{tooltip:"Remanencia les"}),kb.createAndAddPolygon(Xu(),{tooltip:"Remanencia"}),kb.createAndAddPolyline(Yu(),{tooltip:"Remanencia cesta"}),kb.createAndAddPolyline(Zu(),{tooltip:"Remanencia cesta2"}),kb.createAndAddPolygon($u(),{tooltip:"Remanencia les babka"}),kb.createAndAddPolygon(_u(),{tooltip:"Remanencia cela"}),kb.createAndAddPolygon(av(),{tooltip:"Pri dome"}),kb.createAndAddPolygon(bv(),{tooltip:"Dom"}),cv().forEach(function(l){kb.createMarkerFeature(l.lon,l.lat,"dedina body")}),kb.zoomToAllMarkers();})();